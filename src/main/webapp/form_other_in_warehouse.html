<!DOCTYPE html>
<html>

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="renderer" content="webkit">

  <title>其他入库表单</title>
  <meta name="keywords" content="">
  <meta name="description" content="">

  <link href="css/bootstrap.min.css?v=3.4.0" rel="stylesheet">
  <link href="font-awesome/css/font-awesome.css?v=4.3.0" rel="stylesheet">
  <link href="css/plugins/iCheck/custom.css" rel="stylesheet">
  <link href="css/animate.css" rel="stylesheet">
  <link href="css/style.css?v=2.2.0" rel="stylesheet">

</head>

<body>
<div id="wrapper">
  <!-- 侧边栏 -->
  <div id="left_sidebar"></div>
  <div id="page-wrapper" class="gray-bg dashbard-1">

    <!--头部-->
    <div id="header"></div>
    <!--标题-->
    <div class="row wrapper border-bottom white-bg page-heading">
      <div class="col-lg-10">
        <h2>其他入库</h2>

      </div>
      <div class="col-lg-2">

      </div>
    </div>
    <div class="wrapper wrapper-content animated fadeInRight">
      <!--                所有表单元素  -->
      <div class="row">
        <div class="col-lg-12">
          <div class="ibox float-e-margins">
            <div class="ibox-title">
              <h5>入库单</h5>
              <div class="ibox-tools">
                <a class="collapse-link">
                  <i class="fa fa-chevron-up"></i>
                </a>
              </div>
            </div>
            <div class="ibox-content">
              <form method="get" class="form-horizontal">
                <div class="form-group">
                  <label class="col-sm-2 control-label">选择仓库</label>

                  <div class="col-sm-10">
                    <select class="form-control m-b" name="account">
                      <option>仓库 1</option>
                      <option>仓库 2</option>
                      <option>仓库 3</option>
                      <option>仓库 4</option>
                    </select>
                  </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group">
                  <label class="col-sm-2 control-label">备注</label>
                  <div class="col-sm-10">
                    <textarea class="form-control input-lg m-b" name="saysths" rows="5" cols="30" wrap="soft" style="resize:none;">备注</textarea>
                  </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group">
                  <label class="col-lg-2 control-label">时间</label>
                  <div class="col-lg-10">
                    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
                    <div class="form-control-static" id="dateTime"></div>
                  </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="row">
                  <div class="col-lg-12">
                    <div class="ibox float-e-margins">
                      <div class="ibox-title">
                        <h5>其他入库</h5>
                        <div class="ibox-tools">
                          <a class="collapse-link">
                            <i class="fa fa-chevron-up"></i>
                          </a>
                        </div>
                      </div>
                      <div class="ibox-content">
                        <div class="">
                          <a onclick="fnClickAddRow();" href="javascript:void(0);" class="btn btn-primary ">添加物品</a>
                        </div>


                        <table id="editable" class="datatable table table-striped table-bordered table-hover">

                        </table>
                          <button class="btn btn-primary"  onclick="other_submit()" style="float:right">确认</button>
                      </div>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Mainly scripts -->
<script src="js/jquery-2.1.1.min.js"></script>
<script src="js/bootstrap.min.js?v=3.4.0"></script>
<script src="js/plugins/metisMenu/jquery.metisMenu.js"></script>
<script src="js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

<!-- Custom and plugin javascript -->
<script src="js/hplus.js?v=2.2.0"></script>
<script src="js/plugins/pace/pace.min.js"></script>

<!-- iCheck -->
<script src="js/plugins/iCheck/icheck.min.js"></script>

<!--&lt;!&ndash;引入JavaScript&ndash;&gt;-->
<script type="text/javascript" language="javascript" src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>


<!-- Data Tables -->
<script src="js/plugins/dataTables/jquery.dataTables.js"></script>
<script src="js/plugins/dataTables/dataTables.bootstrap.js"></script>

<!-- Page-Level Scripts -->

<!-- 导入left_sidebar -->
<script>
  $(function () {
    $.get("left_sidebar.html",function (data) {
      $("#left_sidebar").html(data);
    });
  });
</script>

<script>
  const dataSets = [
    ['aaa', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
    ['aaa1', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
    ['aaa2', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
    ['aaa3', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
    ['aaa4', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
    ['aaa5', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
    ['aaa6', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
    ['aaa7', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
    ['aaa8', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
    ['aaa9', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
    ['aaa10', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
    ['aaa11', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
    ['aaa12', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
    ['aaa13', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
    ['aaa14', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
    ['aaa15', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
  ];
  $(document).ready(function (){

    var table = $('#editable').DataTable({
      retrieve: true,
      data:dataSets,
      columns:[
        {
          'field': "name",
          'title': '物品名称',
          'defaultContent' : "",
          'sClass': 'text-center'
        }, {
          'field': "specification",
          'title': '规格',
          'defaultContent' : "",
          'sClass': 'text-center'
        }, {
          'field': "quantity",
          'title': '数量',
          'defaultContent' : "",
          'sClass': 'text-center'
        }, {
          'field': "unit",
          'title': '包装单位',
          'defaultContent' : "",
          'sClass': 'text-center'
        }, {
          'field': "classification",
          'title': '分类',
          'defaultContent' : "",
          'sClass': 'text-center'
        }, {
          'field': "price",
          'title': '单价',
          'defaultContent' : "",
          'sClass': 'text-center'
        }, {
          'field': "expiration_time",
          'title': '过期时间',
          'defaultContent' : "",
          'sClass': 'text-center'
        }, {
          'field': "upper_limit",
          'title': '警戒上限',
          width:90,
          'defaultContent' : "",
          'sClass': 'text-center'
        }, {
          'field': "lower_limit",
          'title': '警戒下限',
          width:90,
          'defaultContent' : "",
          'sClass': 'text-center'
        }, {
          'field': "warehouse_id",
          'title': '仓库',
          'defaultContent' : "",
          'sClass': 'text-center'
        }, {
          'field': "notes",
          'title': '备注',
          'defaultContent' : "",
          'sClass': 'text-center'
        }, {
          field: "operate",
          sTitle: '操作',
          sDefaultContent : "<button class='edit-btn btn btn-primary btn-xs' type='button'>修改</button>" +
                  "<button class='delete btn btn-default btn-xs' style='margin-left: 10px'>删除</button>",
          sClass: 'text-center',
          width:100,
          "data" : null,
          // "render" : function(data, type,row) {
          //   var html = "<a href='javascript:void(0);'  class='edit-btn btn btn-primary btn-xs' type='button'>修改</a>"
          //   // TODO: 按钮的修改功能
          //   html += "<a href='javascript:void(0);'  class='delete btn btn-default btn-xs'>删除</a>"
          //   return html;
          //   // formatter: actionFormatter
          // }
        }],
      "language": {
        "sProcessing": "处理中...",
        "sLengthMenu": "显示 _MENU_ 项结果",
        "sZeroRecords": "没有匹配结果",
        "sInfo": "显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",
        "sInfoEmpty": "显示第 0 至 0 项结果，共 0 项",
        "sInfoFiltered": "(由 _MAX_ 项结果过滤)",
        "sInfoPostFix": "",
        "sSearch": "搜索:",
        "sUrl": "",
        "sEmptyTable": "表中数据为空",
        "sLoadingRecords": "载入中...",
        "sInfoThousands": ",",
        "oPaginate": {
          "sFirst": "首页",
          "sPrevious": "上页",
          "sNext": "下页",
          "sLast": "末页"
        },
        "oAria": {
          "sSortAscending": ": 以升序排列此列",
          "sSortDescending": ": 以降序排列此列"
        }
      }
    });
    $(document).on("click",".edit-btn",function(){
      console.log("修改ing");
      var tds=$(this).parents("tr").children();
      $.each(tds, function(i,val){
        var jqob=$(val);
        if(jqob.has('button').length ){return true;}//跳过第1项 序号,按钮
        var txt=jqob.text();
        var put=$("<input type='text' class='changeText' style='width: 80px'>");
        console.log(put[0].type);
        put.val(txt);
        jqob.html(put);
      });
      $(this).html("保存");
      $(this).toggleClass("edit-btn");
      $(this).toggleClass("save-btn");
    });

    $(document).on("click",".save-btn",function(){
      var row=table.row($(this).parents("tr"));
      var tds=$(this).parents("tr").children();
      $.each(tds, function(i,val){
        var jqob=$(val);
        //把input变为字符串
        if(!jqob.has('button').length){
          var txt=jqob.children("input").val();
          var txt2=jqob.find(".changeText").val();
          console.log(jqob.children("input"));
          jqob.html(txt);
          table.cell(jqob).data(txt);//修改DataTables对象的数据
        }
      });
      var data=row.data();
      //这里写传数据的
      $(this).html("修改");
      $(this).toggleClass("edit-btn");
      $(this).toggleClass("save-btn");
    });

    // 点击删除按钮，触发删除行脚本
    $(document).on("click",'.delete',function(){
      $('.datatable').dataTable().fnDeleteRow($(this).closest('tr')[0]);
    });

  });

//点击入库按钮
  function other_submit(){
    if(confirm('确认入库？')){
      //点击确认

    }else{
      //点击取消

    }
  }


</script>

<script>
  // $(document).ready(function () {
  //   $('.dataTables-example').dataTable();
  //
  //   /* Init DataTables */
  //   var oTable = $('#editable').dataTable();
  //
  //   /* Apply the jEditable handlers to the table */
  //   oTable.$('td').editable('../example_ajax.php', {
  //     "callback": function (sValue, y) {
  //       var aPos = oTable.fnGetPosition(this);
  //       oTable.fnUpdate(sValue, aPos[0], aPos[1]);
  //     },
  //     "submitdata": function (value, settings) {
  //       return {
  //         "row_id": this.parentNode.getAttribute('id'),
  //         "column": oTable.fnGetPosition(this)[2]
  //       };
  //     },
  //
  //     "width": "90%",
  //     "height": "100%"
  //   });
  //
  //
  // });

  function fnClickAddRow() {
    $('#editable').dataTable().fnAddData([
      "", "", "", "",
      "", "", "", "", "",
      "", ""]);

  }
</script>


<script>
  Date.prototype.format = function (fmt) {
    var o = {
      "y+": this.getFullYear, //年
      "M+": this.getMonth() + 1, //月份
      "d+": this.getDate(), //日
      "h+": this.getHours(), //小时
      "m+": this.getMinutes(), //分
      "s+": this.getSeconds() //秒
    };
    if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
    for (var k in o)
      if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
    return fmt;
  }
  setInterval("document.getElementById('dateTime').innerHTML = (new Date()).format('yyyy-MM-dd hh:mm:ss');", 1000);
</script>


</body>

</html>
