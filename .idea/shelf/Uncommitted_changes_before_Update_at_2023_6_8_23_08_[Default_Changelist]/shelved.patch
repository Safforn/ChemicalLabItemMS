Index: src/main/webapp/form_use_or_borrow.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n\r\n    <meta charset=\"utf-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><meta name=\"renderer\" content=\"webkit\">\r\n\r\n    <title>领用/借用申请表</title>\r\n    <meta name=\"keywords\" >\r\n    <meta name=\"description\">\r\n\r\n    <link href=\"css/bootstrap.min.css?v=3.4.0\" rel=\"stylesheet\">\r\n    <link href=\"font-awesome/css/font-awesome.css?v=4.3.0\" rel=\"stylesheet\">\r\n    <link href=\"css/plugins/iCheck/custom.css\" rel=\"stylesheet\">\r\n    <link href=\"css/animate.css\" rel=\"stylesheet\">\r\n    <link href=\"css/style.css?v=2.2.0\" rel=\"stylesheet\">\r\n</head>\r\n<body>\r\n<div id=\"wrapper\">\r\n    <!-- 侧边栏 -->\r\n    <div id=\"left_sidebar\"></div>\r\n\r\n    <div id=\"page-wrapper\" class=\"gray-bg dashbard-1\">\r\n        <!--头部-->\r\n        <div id=\"header\"></div>\r\n        <!--标题-->\r\n        <div class=\"row wrapper border-bottom white-bg page-heading\">\r\n            <div class=\"col-lg-10\">\r\n                <h2>领用/借用申请</h2>\r\n\r\n            </div>\r\n            <div class=\"col-lg-2\">\r\n\r\n            </div>\r\n        </div>\r\n        <!--表单本体-->\r\n        <div class=\"wrapper wrapper-content animated fadeInRight\">\r\n            <div class=\"row\">\r\n                <div class=\"col-lg-12\">\r\n                    <div class=\"ibox float-e-margins\">\r\n                        <div class=\"ibox-title\">\r\n                            <h5>领用/借用申请表</h5>\r\n                            <div class=\"ibox-tools\">\r\n                                <a class=\"collapse-link\">\r\n                                    <i class=\"fa fa-chevron-up\"></i>\r\n                                </a>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"ibox-content\">\r\n                            <form method=\"get\" class=\"form-horizontal\">\r\n\r\n                                <div class=\"row\">\r\n                                    <div class=\"col-lg-12\">\r\n                                        <div class=\"ibox float-e-margins\">\r\n\r\n                                            <div class=\"ibox-content\">\r\n                                                <div class=\"\">\r\n                                                    <a onclick=\"fnClickAddRow();\" href=\"javascript:void(0);\" class=\"btn btn-primary \">新建采购申请</a>\r\n                                                    <button type=\"button\" id=\"batch-edit-btn\" class=\"btn btn-primary \">批量编辑</button>\r\n                                                    <button type=\"button\" id=\"batch-save-btn\" class=\"btn btn-primary \">批量保存</button>\r\n                                                </div>\r\n\r\n\r\n                                                <table id=\"table\" class=\"datatable table table-striped table-bordered table-hover\">\r\n\r\n                                                </table>\r\n\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </form>\r\n                        </div>\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- 数据表单弹窗 -->\r\n        <form method=\"post\" class=\"form-horizontal\" role=\"form\" id=\"updateGoodsForm\">\r\n            <div class=\"modal fade\" id=\"updateModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"updateModalLabel\" aria-hidden=\"true\">\r\n                <div class=\"modal-dialog\" style=\"width: 1400px\">\r\n                    <div class=\"modal-content\">\r\n                        <div class=\"modal-header\">\r\n                            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">\r\n                                ×\r\n                            </button>\r\n                            <h4 class=\"modal-title\" id=\"updateModalLabel\">\r\n                                物品清单\r\n                            </h4>\r\n                        </div>\r\n\r\n                        <div class=\"form-group\">\r\n                            <div class=\"row\">\r\n                                <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox float-e-margins\">\r\n                                        <div class=\"ibox-content\">\r\n\r\n                                            <div class=\"\">\r\n                                                <button onclick=\"listfnClickAddRow();\" href=\"javascript:void(0);\" class=\"list-top-btn btn btn-primary \">添加物品</button>\r\n                                                <button type=\"button\" id=\"list-batch-edit-btn\" class=\"list-top-btn btn btn-primary \">批量编辑</button>\r\n                                                <button type=\"button\" id=\"list-batch-save-btn\" class=\"list-top-btn btn btn-primary \">批量保存</button>\r\n                                            </div>\r\n\r\n                                            <table id=listTable width=\"100%\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n                                            </table>\r\n\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <!--   end modal-body  -->\r\n                </div><!-- /.modal-content -->\r\n            </div><!-- /.modal -->\r\n\r\n        </form>\r\n\r\n\r\n\r\n    </div>\r\n</div>\r\n\r\n<!-- Mainly scripts -->\r\n<script src=\"js/jquery-2.1.1.min.js\"></script>\r\n<script src=\"js/bootstrap.min.js?v=3.4.0\"></script>\r\n<script src=\"js/plugins/metisMenu/jquery.metisMenu.js\"></script>\r\n<script src=\"js/plugins/slimscroll/jquery.slimscroll.min.js\"></script>\r\n\r\n<!-- Custom and plugin javascript -->\r\n<script src=\"js/hplus.js?v=2.2.0\"></script>\r\n<script src=\"js/plugins/pace/pace.min.js\"></script>\r\n\r\n<!-- iCheck -->\r\n<script src=\"js/plugins/iCheck/icheck.min.js\"></script>\r\n\r\n<!--&lt;!&ndash;引入JavaScript&ndash;&gt;-->\r\n<script type=\"text/javascript\" language=\"javascript\" src=\"https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js\"></script>\r\n\r\n\r\n<!-- Data Tables -->\r\n<script src=\"js/plugins/dataTables/jquery.dataTables.js\"></script>\r\n<script src=\"js/plugins/dataTables/dataTables.bootstrap.js\"></script>\r\n\r\n<!--&lt;!&ndash;引入css&ndash;&gt;-->\r\n<!--<link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.datatables.net/1.10.15/css/jquery.dataTables.min.css\">-->\r\n\r\n<!--&lt;!&ndash;&lt;!&ndash;引入JavaScript&ndash;&gt;&ndash;&gt;-->\r\n<!--<script type=\"text/javascript\" language=\"javascript\" src=\"//code.jquery.com/jquery-1.12.4.js\"></script>-->\r\n<!--<script type=\"text/javascript\" language=\"javascript\" src=\"https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js\"></script>-->\r\n\r\n\r\n\r\n<!--初始化代码-->\r\n<!-- 导入header -->\r\n<script>\r\n    $(function () {\r\n        $.get(\"header.html\",function (data) {\r\n            $(\"#header\").html(data);\r\n        });\r\n    });\r\n</script>\r\n<script>\r\n    $(function () {\r\n        $.get(\"left_sidebar.html\",function (data) {\r\n            $(\"#left_sidebar\").html(data);\r\n        });\r\n    });\r\n</script>\r\n<script>\r\n    const dataSet = [\r\n        ['id', 'aaa', 'bb', '30', 'xxxx-xx', 'aaa', 'bb',  'xxxx-xx','1'],\r\n        ['id1', 'aaa1', 'cc', '20', 'xxxx-xx', 'aaa', 'bb',  'xxxx-xx','2'],\r\n        ['id2', 'aaa', 'bb', '30', 'xxxx-xx', 'aaa', 'bb',  'xxxx-xx','3'],\r\n        ['id3', 'aaa1', 'cc', '20', 'xxxx-xx', 'aaa', 'bb',  'xxxx-xx','0'],\r\n        ['id4', 'aaa', 'bb', '30', 'xxxx-xx', 'aaa', 'bb',  'xxxx-xx','1'],\r\n        ['id5', 'aaa1', 'cc', '20', 'xxxx-xx', 'aaa', 'bb',  'xxxx-xx','2'],\r\n        ['id6', 'aaa', 'bb', '30', 'xxxx-xx', 'aaa', 'bb',  'xxxx-xx','3'],\r\n        ['id7', 'aaa1', 'cc', '20', 'xxxx-xx','aaa', 'bb',  'xxxx-xx', '0'],\r\n        ['id8', 'aaa', 'bb', '30', 'xxxx-xx', 'aaa', 'bb', 'xxxx-xx','3'],\r\n        ['id9', 'aaa1', 'cc', '20', 'xxxx-xx', 'aaa', 'bb',  'xxxx-xx','2'],\r\n    ];\r\n    const dataSets = [\r\n        ['aaa', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],\r\n        ['aaa1', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],\r\n        ['aaa2', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],\r\n        ['aaa3', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],\r\n        ['aaa4', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],\r\n        ['aaa5', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],\r\n        ['aaa6', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],\r\n        ['aaa7', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],\r\n        ['aaa8', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],\r\n        ['aaa9', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],\r\n        ['aaa10', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],\r\n        ['aaa11', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],\r\n        ['aaa12', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],\r\n        ['aaa13', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],\r\n        ['aaa14', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],\r\n        ['aaa15', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],\r\n    ];\r\n    $(document).ready(function() {\r\n        $(function(){\r\n            var table = $('#table').DataTable({\r\n                retrieve: true,\r\n                data:dataSet,\r\n                columns:[\r\n                    {\r\n                        'field': \"purchase_requisition_id\",\r\n                        'title': '领用/借用申请表编号',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"purchase_order_id\",\r\n                        'title': '领用/借用物品清单编号',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"requisition_user_id\",\r\n                        'title': '申请单类型',\r\n                        'defaultContent' : \"\"\r\n                    },{\r\n                        'field': \"requisition_user_id\",\r\n                        'title': '申请人',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"purpose\",\r\n                        'title': '领用/借用用途',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"requisition_date\",\r\n                        'title': '借用开始日期',\r\n                        'defaultContent' : \"\"\r\n                    },{\r\n                        'field': \"requisition_date\",\r\n                        'title': '借用结束日期',\r\n                        'defaultContent' : \"\"\r\n                    },{\r\n                        'field': \"requisition_date\",\r\n                        'title': '申请提交日期',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"state\",\r\n                        'title': '申请当前状态',\r\n                        'defaultContent' : \"0\"\r\n                    }, {\r\n                        'field': \"approval_user_id\",\r\n                        'title': '审批人',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"approval_opinions\",\r\n                        'title': '审批意见',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"approval_date\",\r\n                        'title': '审批日期',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        field: \"operate\",\r\n                        sTitle: '操作',\r\n                        sDefaultContent : \"<button class='submit-btn btn btn-primary btn-xs' type='button' >提交</button>\"+\r\n                            \"<button class='edit-btn btn btn-primary btn-xs' type='button' style='margin-left: 10px'>编辑</button>\"  +\r\n                            \"<button class='list-btn btn btn-primary btn-xs' type='button' style='margin-left: 10px'>物品清单</button>\"+\r\n                            \"<button class='delete btn btn-default btn-xs' style='margin-left: 10px'>删除</button>\",\r\n                        sClass: 'text-center',\r\n                        \"data\" : null,\r\n                        // \"render\" : function(data, type,row) {\r\n                        //     var id = '\"' + row.id + '\"';\r\n                        //     var html = \"<a href='javascript:void(0);'  class='btn btn-primary btn-xs'  onclick='EditViewById()'></i>物品清单</a>\"\r\n                        //     return html;\r\n                        //     // formatter: actionFormatter\r\n                        // }\r\n                    }],\r\n                \"language\": {\r\n                    \"sProcessing\": \"处理中...\",\r\n                    \"sLengthMenu\": \"显示 _MENU_ 项结果\",\r\n                    \"sZeroRecords\": \"没有匹配结果\",\r\n                    \"sInfo\": \"显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项\",\r\n                    \"sInfoEmpty\": \"显示第 0 至 0 项结果，共 0 项\",\r\n                    \"sInfoFiltered\": \"(由 _MAX_ 项结果过滤)\",\r\n                    \"sInfoPostFix\": \"\",\r\n                    \"sSearch\": \"搜索:\",\r\n                    \"sUrl\": \"\",\r\n                    \"sEmptyTable\": \"表中数据为空\",\r\n                    \"sLoadingRecords\": \"载入中...\",\r\n                    \"sInfoThousands\": \",\",\r\n                    \"oPaginate\": {\r\n                        \"sFirst\": \"首页\",\r\n                        \"sPrevious\": \"上页\",\r\n                        \"sNext\": \"下页\",\r\n                        \"sLast\": \"末页\"\r\n                    },\r\n                    \"oAria\": {\r\n                        \"sSortAscending\": \": 以升序排列此列\",\r\n                        \"sSortDescending\": \": 以降序排列此列\"\r\n                    }\r\n                }\r\n            });\r\n\r\n            var listtable = $('#listTable').DataTable({\r\n                retrieve: true,\r\n                data:dataSets,\r\n                columns:[\r\n                    {\r\n                        'field': \"name\",\r\n                        'title': '物品名称',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"specification\",\r\n                        'title': '规格',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"quantity\",\r\n                        'title': '数量',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"unit\",\r\n                        'title': '包装单位',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"classification\",\r\n                        'title': '分类',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"price\",\r\n                        'title': '单价',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"expiration_time\",\r\n                        'title': '过期时间',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"upper_limit\",\r\n                        'title': '警戒上限',\r\n                        // width:90,\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"lower_limit\",\r\n                        'title': '警戒下限',\r\n                        // width:90,\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"warehouse_id\",\r\n                        'title': '仓库',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"notes\",\r\n                        'title': '备注',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        field: \"operate\",\r\n                        sTitle: '操作',\r\n                        sDefaultContent : \"<button class='list-edit-btn btn btn-primary btn-xs' type='button'>编辑</button>\" +\r\n                            \"<button class='list-delete btn btn-default btn-xs' style='margin-left: 10px'>删除</button>\",\r\n                        sClass: 'text-center',\r\n                        // width:100,\r\n                        \"data\" : null,\r\n                        // \"render\" : function(data, type,row) {\r\n                        //   var html = \"<a href='javascript:void(0);'  class='edit-btn btn btn-primary btn-xs' type='button'>修改</a>\"\r\n                        //   // TODO: 按钮的修改功能\r\n                        //   html += \"<a href='javascript:void(0);'  class='delete btn btn-default btn-xs'>删除</a>\"\r\n                        //   return html;\r\n                        //   // formatter: actionFormatter\r\n                        // }\r\n                    }],\r\n                \"language\": {\r\n                    \"sProcessing\": \"处理中...\",\r\n                    \"sLengthMenu\": \"显示 _MENU_ 项结果\",\r\n                    \"sZeroRecords\": \"没有匹配结果\",\r\n                    \"sInfo\": \"显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项\",\r\n                    \"sInfoEmpty\": \"显示第 0 至 0 项结果，共 0 项\",\r\n                    \"sInfoFiltered\": \"(由 _MAX_ 项结果过滤)\",\r\n                    \"sInfoPostFix\": \"\",\r\n                    \"sSearch\": \"搜索:\",\r\n                    \"sUrl\": \"\",\r\n                    \"sEmptyTable\": \"表中数据为空\",\r\n                    \"sLoadingRecords\": \"载入中...\",\r\n                    \"sInfoThousands\": \",\",\r\n                    \"oPaginate\": {\r\n                        \"sFirst\": \"首页\",\r\n                        \"sPrevious\": \"上页\",\r\n                        \"sNext\": \"下页\",\r\n                        \"sLast\": \"末页\"\r\n                    },\r\n                    \"oAria\": {\r\n                        \"sSortAscending\": \": 以升序排列此列\",\r\n                        \"sSortDescending\": \": 以降序排列此列\"\r\n                    }\r\n                }\r\n            });\r\n\r\n            //点击物品清单\r\n            $(\"table tbody\").on(\"click\",\".list-btn\",function (){\r\n                // $('#listTable').dataTable().api().draw();\r\n                // $('#listTable').dataTable().reload();\r\n                var tds=$(this).parents(\"tr\").children();\r\n                var arr = tds[8].innerText;\r\n                console.log(arr);\r\n                if(arr==='已提交'||arr==='审核通过'){\r\n                    $('.list-edit-btn').attr('disabled',true);\r\n                    $('.list-delete').attr('disabled',true);\r\n                    $('.list-top-btn').attr('disabled',true);\r\n                }\r\n                if(arr==='未提交'||arr==='审核未通过'){\r\n                    $('.list-edit-btn').attr('disabled',false);\r\n                    $('.list-delete').attr('disabled',false);\r\n                    $('.list-top-btn').attr('disabled',false);\r\n                }\r\n\r\n                $('#updateModal').modal('show');\r\n            })\r\n\r\n            //点击提交按钮\r\n            $(\"table tbody\").on(\"click\",\".submit-btn\",function (){\r\n                var tds=$(this).parents(\"tr\").children();\r\n                var arr = tds[8].innerText;\r\n                console.log(arr);\r\n                if(arr==='未提交'||arr==='审核未通过'){\r\n                    //提交的代码\r\n                    if(confirm('确认提交申请？')){\r\n                        //点击确认\r\n                        tds[8].innerText = '已提交';\r\n                        $(this).attr('disabled',true);\r\n                        tds.find('.edit-btn').attr('disabled',true);\r\n                    }else{\r\n                        //点击取消\r\n\r\n                    }\r\n\r\n                }\r\n\r\n            })\r\n\r\n            // 申请表修改\r\n            $(\"#table tbody\").on(\"click\",\".edit-btn\",function(){\r\n                var tds=$(this).parents(\"tr\").children();\r\n                $.each(tds, function(i,val){\r\n                    var jqob=$(val);\r\n                    if(i<=1||i===3||i>6 ){return true;}//跳过第1项 序号,按钮\r\n                    var txt=jqob.text();\r\n                    var put=$(\"<input type='text' style='width: 80px'>\");\r\n                    put.val(txt);\r\n                    jqob.html(put);\r\n                });\r\n                $(this).html(\"保存\");\r\n                $(this).toggleClass(\"edit-btn\");\r\n                $(this).toggleClass(\"save-btn\");\r\n            });\r\n\r\n            //申请表修改保存\r\n            $(\"#table tbody\").on(\"click\",\".save-btn\",function(){\r\n                var row=table.row($(this).parents(\"tr\"));\r\n                var tds=$(this).parents(\"tr\").children();\r\n                $.each(tds, function(i,val){\r\n                    var jqob=$(val);\r\n                    //把input变为字符串\r\n                    console.log(!jqob.has('button').length);\r\n                    if(!jqob.has('button').length){\r\n                        var txt=jqob.children(\"input\").val();\r\n                        console.log(jqob.children(\"input\"));\r\n                        jqob.html(txt);\r\n                        table.cell(jqob).data(txt);//修改DataTables对象的数据\r\n                    }\r\n                });\r\n                $(this).html(\"编辑\");\r\n                $(this).toggleClass(\"edit-btn\");\r\n                $(this).toggleClass(\"save-btn\");\r\n            });\r\n\r\n            // 物品清单修改\r\n            $(\"#listTable tbody\").on(\"click\",\".list-edit-btn\",function(){\r\n                var tds=$(this).parents(\"tr\").children();\r\n                $.each(tds, function(i,val){\r\n                    var jqob=$(val);\r\n                    if(jqob.has('button').length ){return true;}//跳过第1项 序号,按钮\r\n                    var txt=jqob.text();\r\n                    var put=$(\"<input type='text' style='width: 80px'>\");\r\n                    put.val(txt);\r\n                    jqob.html(put);\r\n                });\r\n                $(this).html(\"保存\");\r\n                $(this).toggleClass(\"list-edit-btn\");\r\n                $(this).toggleClass(\"list-save-btn\");\r\n            });\r\n\r\n            //物品清单修改保存\r\n            $(\"#listTable tbody\").on(\"click\",\".list-save-btn\",function(){\r\n                var row=listtable.row($(this).parents(\"tr\"));\r\n                var tds=$(this).parents(\"tr\").children();\r\n                $.each(tds, function(i,val){\r\n                    var jqob=$(val);\r\n                    //把input变为字符串\r\n                    console.log(!jqob.has('button').length);\r\n                    if(!jqob.has('button').length){\r\n                        var txt=jqob.children(\"input\").val();\r\n                        console.log(jqob.children(\"input\"));\r\n                        jqob.html(txt);\r\n                        listtable.cell(jqob).data(txt);//修改DataTables对象的数据\r\n                    }\r\n                });\r\n                $(this).html(\"编辑\");\r\n                $(this).toggleClass(\"list-edit-btn\");\r\n                $(this).toggleClass(\"list-save-btn\");\r\n            });\r\n\r\n            //批量点击编辑按钮\r\n            $(\"#batch-edit-btn\").click(function(){\r\n                $(\".edit-btn\").click();\r\n            });\r\n            $(\"#batch-save-btn\").click(function(){\r\n                $(\".save-btn\").click();\r\n            });\r\n\r\n            //物品清单批量点击编辑按钮\r\n            $(\"#list-batch-edit-btn\").click(function(){\r\n                $(\".list-edit-btn\").click();\r\n            });\r\n            $(\"#list-batch-save-btn\").click(function(){\r\n                $(\".list-save-btn\").click();\r\n            });\r\n\r\n            // 申请单点击删除按钮，触发删除行脚本\r\n            $(document).on(\"click\",'.delete',function(){\r\n                $('#table').dataTable().fnDeleteRow($(this).closest('tr')[0]);\r\n            });\r\n            // 物品清单点击删除按钮，触发删除行脚本\r\n            $(document).on(\"click\",'.list-delete',function(){\r\n                $('#listTable').dataTable().fnDeleteRow($(this).closest('tr')[0]);\r\n            });\r\n\r\n            $(\"#table tbody tr\").each(function () {\r\n                var a = $(this).children();//获取每一行\r\n                var arr =a[8].innerText;//取得第六列的值\r\n                if(arr==='0'){\r\n                    a[8].innerText = '未提交';\r\n                }else if(arr==='1'){\r\n                    a[8].innerText = '已提交';\r\n                    a.find('.submit-btn').attr('disabled',true);\r\n                    a.find('.edit-btn').attr('disabled',true);\r\n                }else if(arr==='2'){\r\n                    a[8].innerText = '审核通过';\r\n                    a.find('.submit-btn').attr('disabled',true);\r\n                    a.find('.edit-btn').attr('disabled',true);\r\n                }else if(arr==='3'){\r\n                    a[8].innerText = '审核未通过';\r\n                }\r\n            })\r\n        });\r\n    });\r\n\r\n\r\n\r\n</script>\r\n\r\n<script>\r\n    function fnClickAddRow() {\r\n        $('#table').dataTable().fnAddData([\r\n            \"\", \"\", \"\", \"\",\r\n            \"\", \"\", \"\", \"\", \"未提交\",\r\n            \"\", \"\"]);}\r\n    function listfnClickAddRow() {\r\n        $('#listTable').dataTable().fnAddData([\r\n            \"\", \"\", \"\", \"\",\r\n            \"\", \"\", \"\", \"\", \"\",\r\n            \"\", \"\"]);}\r\n</script>\r\n\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/form_use_or_borrow.html b/src/main/webapp/form_use_or_borrow.html
--- a/src/main/webapp/form_use_or_borrow.html	(revision 7b26828b867c9f6627cd5d7a1bb0990c16716691)
+++ b/src/main/webapp/form_use_or_borrow.html	(date 1686236332218)
@@ -14,6 +14,11 @@
     <link href="css/plugins/iCheck/custom.css" rel="stylesheet">
     <link href="css/animate.css" rel="stylesheet">
     <link href="css/style.css?v=2.2.0" rel="stylesheet">
+    <!--    TODO: laz -->
+    <style>
+        .table td{ word-break: break-all; }
+        .table th{ word-break: break-all; }
+    </style>
 </head>
 <body>
 <div id="wrapper">
@@ -171,90 +176,133 @@
     });
 </script>
 <script>
-    const dataSet = [
-        ['id', 'aaa', 'bb', '30', 'xxxx-xx', 'aaa', 'bb',  'xxxx-xx','1'],
-        ['id1', 'aaa1', 'cc', '20', 'xxxx-xx', 'aaa', 'bb',  'xxxx-xx','2'],
-        ['id2', 'aaa', 'bb', '30', 'xxxx-xx', 'aaa', 'bb',  'xxxx-xx','3'],
-        ['id3', 'aaa1', 'cc', '20', 'xxxx-xx', 'aaa', 'bb',  'xxxx-xx','0'],
-        ['id4', 'aaa', 'bb', '30', 'xxxx-xx', 'aaa', 'bb',  'xxxx-xx','1'],
-        ['id5', 'aaa1', 'cc', '20', 'xxxx-xx', 'aaa', 'bb',  'xxxx-xx','2'],
-        ['id6', 'aaa', 'bb', '30', 'xxxx-xx', 'aaa', 'bb',  'xxxx-xx','3'],
-        ['id7', 'aaa1', 'cc', '20', 'xxxx-xx','aaa', 'bb',  'xxxx-xx', '0'],
-        ['id8', 'aaa', 'bb', '30', 'xxxx-xx', 'aaa', 'bb', 'xxxx-xx','3'],
-        ['id9', 'aaa1', 'cc', '20', 'xxxx-xx', 'aaa', 'bb',  'xxxx-xx','2'],
-    ];
-    const dataSets = [
-        ['aaa', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
-        ['aaa1', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
-        ['aaa2', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
-        ['aaa3', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
-        ['aaa4', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
-        ['aaa5', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
-        ['aaa6', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
-        ['aaa7', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
-        ['aaa8', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
-        ['aaa9', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
-        ['aaa10', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
-        ['aaa11', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
-        ['aaa12', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
-        ['aaa13', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
-        ['aaa14', '规格', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
-        ['aaa15', '规格1', '20', '单位', 'fenlei', '10.0', 'xxxx-xx', '300', '20', '1hao', 'beizhu'],
-    ];
+    var temp_user_id;
+    var temp_data;
+
+    console.log("--flag-1-");
+
+    $.ajax({
+        async: false,
+        type : "post",
+        url : "user/findOne",
+        success : function(user) {
+            console.log("--flag-findOne-");
+            temp_user_id = user.user_id;
+            console.log("user.user_id"+user.user_id);
+        }
+    });
+
+    // 初始化，获取首页表格数据
+    $.ajax({
+        async: false,
+        data: {user_id: temp_user_id},
+        type : "post",
+        url : "getorborrow/initTable",
+        success : function(data) {
+            console.log("--flag-inittable-");
+            temp_data=data.data;
+        }
+    });
+
+    function json2Array(jsonData, list_or_not) {
+        var jsonsString = jsonData.slice(1, jsonData.length - 1);
+        var jsonStrings = jsonsString.split("},");
+        var length = jsonStrings.length;
+        var jsons = [];
+        for (var i = 0; i !== length-1; ++i) {
+            jsonStrings[i] += '}';
+        }
+        var source = [[]];
+        for (var i = 0; i !== length; ++i) {
+            //console.log("$"+jsonStrings[i]);
+            jsons[i] = eval('(' + jsonStrings[i] + ')');
+            var data = [];
+            for(var key in jsons[i]) {
+                if(i === 0) {
+                    source[0].push(key);
+                }
+                //console.log("i="+i+"|key="+key+"|json[i,key]="+jsons[i][key]);
+                if(!list_or_not || key !== "object_id" ) {
+                    data.push(jsons[i][key]);
+                } else {
+                    console.log("跳过在执行一次")
+                }
+            }
+            source.push(data);
+        }
+        return source.slice(1); //删除第1行
+    }
+    //console.log("temp_data=\n"+temp_data);
+    temp_data = json2Array(temp_data, false)  // 主表格数据
+
+    const dataSets = [];
     $(document).ready(function() {
         $(function(){
             var table = $('#table').DataTable({
                 retrieve: true,
-                data:dataSet,
+                autoWidth:true,
+                data:temp_data,
                 columns:[
                     {
                         'field': "purchase_requisition_id",
                         'title': '领用/借用申请表编号',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     }, {
                         'field': "purchase_order_id",
                         'title': '领用/借用物品清单编号',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     }, {
                         'field': "requisition_user_id",
                         'title': '申请单类型',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     },{
                         'field': "requisition_user_id",
                         'title': '申请人',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     }, {
                         'field': "purpose",
                         'title': '领用/借用用途',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     }, {
                         'field': "requisition_date",
                         'title': '借用开始日期',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     },{
                         'field': "requisition_date",
                         'title': '借用结束日期',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     },{
                         'field': "requisition_date",
                         'title': '申请提交日期',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     }, {
                         'field': "state",
                         'title': '申请当前状态',
-                        'defaultContent' : "0"
+                        'defaultContent' : "0",
+                        sClass: 'text-center'
                     }, {
                         'field': "approval_user_id",
                         'title': '审批人',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     }, {
                         'field': "approval_opinions",
                         'title': '审批意见',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     }, {
                         'field': "approval_date",
                         'title': '审批日期',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     }, {
                         field: "operate",
                         sTitle: '操作',
@@ -297,6 +345,71 @@
                 }
             });
 
+            var temp_list_data;
+            var temp_order_id;  // 本条订单的order——id
+
+            // 点击 物品清单 按钮
+            $("table tbody").on("click",".list-btn",function (){
+                // TODO: 待办 - 进入物品清单弹窗，刷新表单
+                //$('#listTable').dataTable().api().draw();
+
+                var tds=$(this).parents("tr").children();
+                temp_order_id = tds[1].innerText;
+                // 向后端请求物品清单数据
+                $.ajax({
+                    async: false,  // true 同步，false异步
+                    data: {order_id: temp_order_id},
+                    type: "post",
+                    url : "getorborrow/initListTable",
+                    success : function(data) {
+                        //console.log("--flag-initListTable-");
+                        temp_list_data=data.data;
+                        temp_list_data = json2Array(temp_list_data, true)
+                    }
+                });
+
+                // 更改"状态"字段 和 按钮状态
+                var arr = tds[5].innerText;
+                console.log(arr);
+                if(arr==='已提交'||arr==='审核通过'){
+                    $('.list-edit-btn').attr('disabled',true);
+                    $('.list-delete').attr('disabled',true);
+                    $('.list-top-btn').attr('disabled',true);
+                }
+                if(arr==='未提交'||arr==='审核未通过'){
+                    $('.list-edit-btn').attr('disabled',false);
+                    $('.list-delete').attr('disabled',false);
+                    $('.list-top-btn').attr('disabled',false);
+                }
+
+                // 更新表格数据
+                $('#listTable').dataTable().api().clear();
+                $('#listTable').dataTable().api().rows.add(temp_list_data);
+                $('#listTable').dataTable().api().draw();
+
+                $('#updateModal').modal('show');
+
+                $.ajax({
+                    async: false,  // true 同步，false异步
+                    data: {order_id: temp_order_id},
+                    type: "post",
+                    url : "getorborrow/initListTable",
+                    success : function(data) {
+                        //console.log("--flag-initListTable-");
+                        temp_list_data=data.data;
+                        temp_list_data = json2Array(temp_list_data, true)
+                    }
+                })
+                // 更新表格数据
+                $('#listTable').dataTable().api().clear();
+                $('#listTable').dataTable().api().rows.add(temp_list_data);
+                $('#listTable').dataTable().api().draw();
+
+
+
+
+            })
+
             var listtable = $('#listTable').DataTable({
                 retrieve: true,
                 data:dataSets,
@@ -400,47 +513,81 @@
                 }
             });
 
-            //点击物品清单
-            $("table tbody").on("click",".list-btn",function (){
-                // $('#listTable').dataTable().api().draw();
-                // $('#listTable').dataTable().reload();
-                var tds=$(this).parents("tr").children();
-                var arr = tds[8].innerText;
-                console.log(arr);
-                if(arr==='已提交'||arr==='审核通过'){
-                    $('.list-edit-btn').attr('disabled',true);
-                    $('.list-delete').attr('disabled',true);
-                    $('.list-top-btn').attr('disabled',true);
-                }
-                if(arr==='未提交'||arr==='审核未通过'){
-                    $('.list-edit-btn').attr('disabled',false);
-                    $('.list-delete').attr('disabled',false);
-                    $('.list-top-btn').attr('disabled',false);
-                }
-
-                $('#updateModal').modal('show');
-            })
-
-            //点击提交按钮
+            // 点击 提交 按钮
             $("table tbody").on("click",".submit-btn",function (){
                 var tds=$(this).parents("tr").children();
                 var arr = tds[8].innerText;
                 console.log(arr);
                 if(arr==='未提交'||arr==='审核未通过'){
-                    //提交的代码
-                    if(confirm('确认提交申请？')){
-                        //点击确认
-                        tds[8].innerText = '已提交';
-                        $(this).attr('disabled',true);
-                        tds.find('.edit-btn').attr('disabled',true);
-                    }else{
-                        //点击取消
-
-                    }
-
+                    // 提交的代码
+                    if(confirm('确认提交申请？')){  //确认提交
+                        // 拼后端BeanUtils所需的map串
+
+                        // 时间格式纠正
+                        Date.prototype.toLocaleString = function() {
+                            function addZero(num) {
+                                return num < 10 ? "0" + num : num;
+                            }
+                            // 按自定义拼接格式返回
+                            return this.getFullYear() + "/" + addZero(this.getMonth() + 1) + "/" + addZero(this.getDate()) + " " +
+                                addZero((this.getHours()+24-8)%24) + ":" + addZero(this.getMinutes()) + ":" + addZero(this.getSeconds());
+                        };
+                        var requisition_dateTime = "", approval_date = "";
+                        if (tds[7].innerText !== "")
+                            requisition_dateTime = (new Date(eval(tds[7].innerText))).toLocaleString();
+                        if (tds[11].innerText !== "")
+                            approval_date = (new Date(eval(tds[11].innerText))).toLocaleString();
+
+                        // 状态改回数值
+                        var shenqing_state = '';
+                        if(arr==='未提交'){
+                            shenqing_state = '0';
+                        }else if(arr==='已提交'){
+                            shenqing_state = '1';
+                        }else if(arr==='审核通过'){
+                            shenqing_state = '2';
+                        }else if(arr==='审核未通过'){
+                            shenqing_state = '3';
+                        }
+
+                        var front_end_data = "";
+                        if (tds[0].innerText !== "") front_end_data += "get_or_borrow_requisition_id="+tds[0].innerText+"&";
+                        if (tds[1].innerText !== "") front_end_data += "get_or_borrow_order_id="+tds[1].innerText+"&";
+                        if (tds[2].innerText !== "") front_end_data += "type="+tds[2].innerText+"&";
+                        if (tds[3].innerText !== "") front_end_data += "applicant_user_id="+tds[3].innerText+"&";
+                        if (tds[4].innerText !== "") front_end_data += "purpose="+tds[4].innerText+"&";
+                        if (tds[5].innerText !== "") front_end_data += "borrow_date="+tds[5].innerText+"&";
+                        if (tds[6].innerText !== "") front_end_data += "return_date="+tds[6].innerText+"&";
+                        if (tds[7].innerText !== "") front_end_data += "requisition_date="+requisition_dateTime+"&";
+                        if (tds[8].innerText !== "") front_end_data += "state="+tds[8].innerText+"&";
+                        if (tds[9].innerText !== "") front_end_data += "approval_user_id="+tds[9].innerText+"&";
+                        if (tds[10].innerText !== "") front_end_data += "approval_opinions="+tds[10].innerText+"&";
+                        if (tds[11].innerText !== "") front_end_data += "approval_date="+approval_date+"&";
+                        // front_end_data = front_end_data.substring(0, front_end_data.length-1);  //删除最后一个字符
+
+                        $.get("user/findOne", {}, function (data) {
+                            // 获取当前登陆的用户id
+                            front_end_data += "requisition_user_id="+data.user_id;
+                            console.log("front_end_data="+front_end_data);
+                            // 把前端数据传给后端
+                            $.post("getorborrow/createOrUpdateItems", front_end_data, function (data) {
+                                console.log("在接受后端数据之后");
+                                if (data.flag) {
+                                    alert("提交成功");
+                                    tds[8].innerText = '已提交';
+                                    // 禁用按钮：应该放入点击确认
+                                    $(this).attr('disabled',true);
+                                    tds.find('.edit-btn').attr('disabled',true);
+                                } else {
+                                    alert("提交失败");
+                                }
+                            })
+                        });  // end of $.get("user/findOne"...
+                    } // end of confirm(确认提交申请？)
+                    else {} //点击取消，无事发生
                 }
-
             })
+
 
             // 申请表修改
             $("#table tbody").on("click",".edit-btn",function(){
@@ -494,21 +641,79 @@
                 $(this).toggleClass("list-save-btn");
             });
 
-            //物品清单修改保存
+            //  物品清单修改保存
             $("#listTable tbody").on("click",".list-save-btn",function(){
                 var row=listtable.row($(this).parents("tr"));
                 var tds=$(this).parents("tr").children();
                 $.each(tds, function(i,val){
+                    console.log("|"+tds[i].innerText+"|");
                     var jqob=$(val);
                     //把input变为字符串
-                    console.log(!jqob.has('button').length);
                     if(!jqob.has('button').length){
                         var txt=jqob.children("input").val();
-                        console.log(jqob.children("input"));
                         jqob.html(txt);
                         listtable.cell(jqob).data(txt);//修改DataTables对象的数据
                     }
                 });
+
+                var front_end_data = "";
+                if (tds[0].innerText !== "") front_end_data += "get_or_borrow_requisition_id="+tds[0].innerText+"&";
+                if (tds[1].innerText !== "") front_end_data += "get_or_borrow_order_id="+tds[1].innerText+"&";
+                if (tds[2].innerText !== "") front_end_data += "type="+tds[2].innerText+"&";
+                if (tds[3].innerText !== "") front_end_data += "applicant_user_id="+tds[3].innerText+"&";
+                if (tds[4].innerText !== "") front_end_data += "purpose="+tds[4].innerText+"&";
+                if (tds[5].innerText !== "") front_end_data += "borrow_date="+tds[5].innerText+"&";
+                if (tds[6].innerText !== "") front_end_data += "return_date="+tds[6].innerText+"&";
+                if (tds[7].innerText !== "") front_end_data += "requisition_date="+tds[7].innerText+"&";
+                if (tds[8].innerText !== "") front_end_data += "state="+tds[8].innerText+"&";
+                if (tds[9].innerText !== "") front_end_data += "approval_user_id="+tds[9].innerText+"&";
+                if (tds[10].innerText !== "") front_end_data += "approval_opinions="+tds[10].innerText+"&";
+                if (tds[11].innerText !== "") front_end_data += "approval_date="+tds[11].innerText+"&";
+                // front_end_data = front_end_data.substring(0, front_end_data.length-1);  //删除最后一个字符
+
+                console.log("front_end_data"+front_end_data)
+                $.get("user/findOne", {}, function (data) {
+                    // 获取当前登陆的用户id，写入前端待发送的数据
+                    front_end_data += "requisition_user_id="+data.user_id;
+                    console.log("front_end_data="+front_end_data);
+                    // 把前端数据传给后端
+                    $.post("getorborrow/getOrderId", {order_id: temp_order_id}, function () {
+                        $.post("getorborrow/UpdateItemsList", front_end_data, function (data) {
+                            console.log("在接受后端数据之后");
+                            if (data.flag) {
+                                alert("提交成功");
+                                // 禁用按钮：应该放入点击确认
+                                $(this).attr('disabled',true);
+                                tds.find('.edit-btn').attr('disabled',true);
+
+                                // --------更新一次表单窗格-----------
+                                temp_order_id = tds[1].innerText;
+                                $.ajax({
+                                    async: true,  // true 同步，false异步
+                                    data: {order_id: temp_order_id},
+                                    type: "post",
+                                    url : "getorborrow/initListTable",
+                                    success : function(data) {
+                                        console.log("--物品清单行修改保存后，更新一次窗口数据--");
+                                        temp_list_data=data.data;
+                                        temp_list_data = json2Array(temp_list_data, true)
+                                    }
+                                });
+                                $('#updateModal').modal('show');  // 显示弹窗表格
+                                // 更新表格数据
+                                $('#listTable').dataTable().api().clear();
+                                $('#listTable').dataTable().api().rows.add(temp_list_data);
+                                $('#listTable').dataTable().api().draw();
+                                //----------------------------------------
+
+                            } else {
+                                alert("提交失败");
+                            }
+                        });
+                    });
+
+                });  // end of $.get("user/findOne"...
+
                 $(this).html("编辑");
                 $(this).toggleClass("list-edit-btn");
                 $(this).toggleClass("list-save-btn");
Index: src/main/java/service/impl/get_or_borrow_service_impl.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package service.impl;\r\n\r\nimport dao.get_or_borrow_dao;\r\nimport dao.impl.get_or_borrow_dao_impl;\r\nimport dao.impl.object_entry_dao_impl;\r\nimport dao.impl.reminder_dao_impl;\r\nimport dao.object_entry_dao;\r\nimport dao.reminder_dao;\r\nimport domain.Object_Entry;\r\nimport domain.Reminder;\r\nimport domain.get_or_borrow_Requisition;\r\nimport domain.template_order;\r\nimport service.get_or_borrow_service;\r\nimport util.UuidUtil;\r\n\r\nimport java.util.Date;\r\nimport java.util.List;\r\nimport static util.UuidUtil.getCurrentTime;\r\n\r\npublic class get_or_borrow_service_impl implements get_or_borrow_service {\r\n    private get_or_borrow_dao getOrBorrowDao = new get_or_borrow_dao_impl();\r\n    private object_entry_dao objectEntryDao = new object_entry_dao_impl();\r\n    private reminder_dao reminderDao = new reminder_dao_impl();\r\n\r\n    @Override\r\n    public boolean createOrUpdate(template_order tando) {\r\n        get_or_borrow_Requisition table = (get_or_borrow_Requisition) tando.getTable();\r\n        List<Object_Entry> order = tando.getOrder();\r\n        if (table.getGet_or_borrow_requisition_id() == null) {\r\n            return createTable(table, order);\r\n        }\r\n        else {\r\n            return changeTable(table, order);\r\n        }\r\n    }\r\n\r\n    private boolean createTable(get_or_borrow_Requisition table, List<Object_Entry> order) {\r\n        /**\r\n         * 新增物品列表\r\n         * 系统填写：申请单id，物品单id，提交时间\r\n         */\r\n        table.setRequisition_date(getCurrentTime());\r\n        table.setGet_or_borrow_requisition_id(UuidUtil.getUuid());\r\n        String orderId = UuidUtil.getUuid();\r\n        table.setGet_or_borrow_order_id(orderId);\r\n        for (Object_Entry object_entry : order) {\r\n            object_entry.setObject_entry_id(UuidUtil.getUuid());\r\n        }\r\n        return objectEntryDao.addEntry(order, orderId) && getOrBorrowDao.createTable(table);\r\n    }\r\n\r\n    private boolean changeTable(get_or_borrow_Requisition table, List<Object_Entry> order) {\r\n        if (!getOrBorrowDao.updateTable(table)) {\r\n            return false;\r\n        }\r\n        if (!objectEntryDao.deleteEntryByOrder(table.getGet_or_borrow_order_id())) {\r\n            return false;\r\n        }\r\n        for (Object_Entry object_entry : order) {\r\n            object_entry.setObject_entry_id(UuidUtil.getUuid());\r\n        }\r\n        if (objectEntryDao.addEntry(order, table.getGet_or_borrow_order_id())) {\r\n\r\n            if (table.getType() == 1) {\r\n                //填写催还单\r\n                return reminderDao.add(new Reminder(UuidUtil.getUuid(), table.getGet_or_borrow_requisition_id()));\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    @Override\r\n    public boolean approvalTable(get_or_borrow_Requisition table) {\r\n        table.setApproval_date(getCurrentTime());\r\n        return getOrBorrowDao.updateTable(table);\r\n    }\r\n\r\n    @Override\r\n    public boolean deleteTable(String tableId) {\r\n        get_or_borrow_Requisition get_or_borrow_requisition = getOrBorrowDao.searchTableById(tableId);\r\n        return objectEntryDao.deleteEntryByOrder(get_or_borrow_requisition.getGet_or_borrow_order_id()) && getOrBorrowDao.deleteTable(tableId);\r\n    }\r\n\r\n//    @Override\r\n//    public void submitTable(String tableId) {\r\n//\r\n//    }\r\n\r\n    @Override\r\n    public template_order searchTableById(String tableId) {\r\n        get_or_borrow_Requisition table = getOrBorrowDao.searchTableById(tableId);\r\n        List<Object_Entry> order = objectEntryDao.search(table.getGet_or_borrow_order_id());\r\n        return new template_order(table, order);\r\n    }\r\n\r\n    @Override\r\n    public List<get_or_borrow_Requisition> searchTableByUser(String userId) {\r\n        return getOrBorrowDao.searchTableByUser(userId);\r\n    }\r\n\r\n    @Override\r\n    public List<get_or_borrow_Requisition> searchTableByState(int state) {\r\n        return getOrBorrowDao.searchTableByState(state);\r\n    }\r\n\r\n    @Override\r\n    public List<get_or_borrow_Requisition> searchBorrowUnreturn() {\r\n        return getOrBorrowDao.searchBorrowUnreturn();\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/service/impl/get_or_borrow_service_impl.java b/src/main/java/service/impl/get_or_borrow_service_impl.java
--- a/src/main/java/service/impl/get_or_borrow_service_impl.java	(revision 7b26828b867c9f6627cd5d7a1bb0990c16716691)
+++ b/src/main/java/service/impl/get_or_borrow_service_impl.java	(date 1686236765130)
@@ -26,7 +26,8 @@
     public boolean createOrUpdate(template_order tando) {
         get_or_borrow_Requisition table = (get_or_borrow_Requisition) tando.getTable();
         List<Object_Entry> order = tando.getOrder();
-        if (table.getGet_or_borrow_requisition_id() == null) {
+        System.out.println("-- service : " + table.getGet_or_borrow_requisition_id());
+        if (table.getGet_or_borrow_requisition_id() == "") {
             return createTable(table, order);
         }
         else {
Index: src/main/java/web/servlet/PurchaseServlet.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package web.servlet;\r\n\r\nimport com.fasterxml.jackson.core.JsonProcessingException;\r\nimport com.fasterxml.jackson.databind.ObjectMapper;\r\nimport domain.*;\r\nimport org.apache.commons.beanutils.BeanUtils;\r\nimport org.apache.commons.beanutils.ConvertUtils;\r\nimport org.apache.commons.beanutils.Converter;\r\nimport org.apache.commons.beanutils.converters.DateConverter;\r\nimport service.impl.item_service_impl;\r\nimport service.impl.order_service_impl;\r\nimport service.impl.purchase_requisition_service_impl;\r\nimport service.item_service;\r\nimport service.order_service;\r\nimport service.purchase_requisition_service;\r\nimport util.JsonUtil;\r\nimport util.UuidUtil;\r\nimport web.servlet.BaseServlet;\r\n\r\nimport javax.servlet.ServletException;\r\nimport javax.servlet.annotation.WebServlet;\r\nimport javax.servlet.http.HttpServletRequest;\r\nimport javax.servlet.http.HttpServletResponse;\r\nimport java.io.IOException;\r\nimport java.lang.reflect.InvocationTargetException;\r\nimport java.text.ParseException;\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.*;\r\n\r\n\r\n@WebServlet(\"/purchase/*\")\r\npublic class PurchaseServlet extends BaseServlet {\r\n\r\n    private purchase_requisition_service service = new purchase_requisition_service_impl();\r\n    private order_service o_service = new order_service_impl();\r\n    private item_service i_service = new item_service_impl();\r\n    private static Map<String, List<Item>> temp_items = new HashMap<>();\r\n    private static String order_id = \"\";\r\n\r\n    public void createOrUpdateItems(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\r\n        System.out.println(\"PurchaseServlet：进入 采购申请 后端\");\r\n        //1.获取数据（领用申请表基本信息 + 领用申请物品清单）\r\n        Purchase_Requisition purchase_requisition = new Purchase_Requisition();\r\n        ConvertUtils.register(new Converter() {\r\n            @Override\r\n            public Object convert(Class aClass, Object o) {\r\n                // 如果字符串为null，则返回null\r\n                if(o == null) return null;\r\n                // 如果字符串为空格，则返回null\r\n                String str = (String) o;\r\n                if(str.trim().equals(\"\")) return null;\r\n                // 将字符串转为Date类型\r\n                SimpleDateFormat formatter = new SimpleDateFormat(\"yyyy/MM/dd hh:mm:ss\");\r\n                try {\r\n                    return formatter.parse(o.toString());\r\n                } catch (ParseException e) {\r\n                    e.printStackTrace();\r\n                }\r\n                return new Date();\r\n            }\r\n        }, Date.class);\r\n\r\n        Map<String, String[]> map = request.getParameterMap(); //获取前端数据，考虑分两次传输 申请表信息和物品清单\r\n\r\n        for (Map.Entry<String, String[]> entry : map.entrySet()) {\r\n            System.out.println(\"key = \" + entry.getKey() + \", value = \" + Arrays.toString(entry.getValue()));\r\n        }\r\n        //2.封装对象\r\n\r\n        try {\r\n            BeanUtils.populate(purchase_requisition, map);\r\n        } catch (IllegalAccessException | InvocationTargetException e) {\r\n            e.printStackTrace();\r\n        }\r\n//        List<Item> items = new ArrayList<>();\r\n//        try {\r\n//            BeanUtils.populate(items, map);\r\n//        } catch (IllegalAccessException e) {\r\n//            e.printStackTrace();\r\n//        } catch (InvocationTargetException e) {\r\n//            e.printStackTrace();\r\n//        }\r\n\r\n        purchase_requisition.print();  // 调试，显示前端传回的数据\r\n\r\n        // TODO: 前端表格里的物品清单数据还没传进来\r\n        List<Object_Entry> object_entries = new ArrayList<>();\r\n        Object_Entry objectEntry = new Object_Entry();\r\n        System.out.println(\"++++++++++++++++++++++++++++++++++++++++++++\");\r\n        for (Item item : temp_items.get(purchase_requisition.getPurchase_order_id())) {\r\n            objectEntry.setObject_id(item.getObject_id());\r\n            objectEntry.setNum((int)(item.getQuantity()));\r\n            object_entries.add(objectEntry);\r\n            item.setQuantity(0);\r\n            System.out.println(item.getNotes());\r\n        }\r\n        System.out.println(\"++++++++++++++++++++++++++++++++++++++++++++\");\r\n\r\n        i_service.add(temp_items.get(purchase_requisition.getPurchase_order_id()));\r\n\r\n        template_order to = new template_order(purchase_requisition, object_entries);\r\n        service.createOrUpdate(to);\r\n        ResultInfo info = new ResultInfo();\r\n        // 4. 响应结果\r\n        info.setFlag(true);\r\n        // 将 info 对象序列化为 json\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        String json = mapper.writeValueAsString(info);\r\n        // 将 json 数据写回客户端\r\n        response.setContentType(\"application/json;charset=utf-8\");\r\n        response.getWriter().write(json);\r\n    }\r\n\r\n\r\n    // 更新清单\r\n    public void UpdateItemsList(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\r\n        Item item_changed = new Item();\r\n        Map<String, String[]> map = request.getParameterMap();\r\n        try {\r\n            BeanUtils.populate(item_changed, map);\r\n        } catch (IllegalAccessException | InvocationTargetException e) {\r\n            e.printStackTrace();\r\n        }\r\n        // 如果当前order_id没有关联的物品行，新建一个对应的缓存\r\n        temp_items.computeIfAbsent(order_id, k -> new ArrayList<Item>());\r\n\r\n        if (item_changed.getObject_id()!= null) {  // 不是新建的item\r\n            for (Item i : temp_items.get(order_id)) {  // 遍历已经缓存的关联该订单的Item\r\n                if (i.getObject_id().equals(item_changed.getObject_id())) {  // 如果修改过的Item已经缓存过了\r\n                    temp_items.get(order_id).remove(i);  // 从缓存中删除\r\n                    break;  // 结束遍历\r\n                }\r\n            }\r\n        } else {  // 新建的Item 补充id属性\r\n            item_changed.setObject_id(UuidUtil.getUuid());\r\n        }\r\n        temp_items.get(order_id).add(item_changed);  // 缓存 前端修改的item\r\n\r\n\r\n        ResultInfo info = new ResultInfo();\r\n        // 4. 响应结果\r\n        info.setFlag(true);\r\n        // 将 info 对象序列化为 json\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        String json = mapper.writeValueAsString(info);\r\n        // 将 json 数据写回客户端\r\n        response.setContentType(\"application/json;charset=utf-8\");\r\n        response.getWriter().write(json);\r\n    }\r\n\r\n    public void getOrderId(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException{\r\n        order_id = request.getParameter(\"order_id\");\r\n    }\r\n\r\n\r\n    public void deleteTable(HttpServletRequest request, HttpServletResponse response) throws\r\n            ServletException, IOException {\r\n        // 从前端获取 待删除申请表行的 tableId\r\n        String tableId = request.getParameter(\"tableId\");\r\n        // 调用service删除\r\n        service.deleteTable(tableId);\r\n        // TODO: 更新前端表格页面，这个好像不需要做，前端会自动删除（加个\"确认删除\"的弹窗）\r\n        //  只需要把tableId传给后端即可\r\n\r\n    }\r\n\r\n    public void initTable(HttpServletRequest request, HttpServletResponse response) throws\r\n            ServletException, IOException {\r\n        System.out.println(\"PurchaseServlet：进入 初始化表格 后端\");\r\n        String user_id = request.getParameter(\"user_id\");\r\n        System.out.println(\"PurchaseServlet user_id=\"+user_id);\r\n        String purchaseDataList = \"\";\r\n        if (user_id != null)\r\n            purchaseDataList = updatePurchaseData(user_id);\r\n\r\n        ResultInfo info = new ResultInfo();\r\n        // 4. 响应结果\r\n        info.setFlag(true);\r\n        info.setData(purchaseDataList);\r\n        // 将 info 对象序列化为 json\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        String json = mapper.writeValueAsString(info);\r\n        // 将 json 数据写回客户端\r\n        response.setContentType(\"application/json;charset=utf-8\");\r\n        response.getWriter().write(json);\r\n    }\r\n\r\n\r\n    public String updatePurchaseData(String user_id) throws IOException {\r\n        System.out.println(\"进入updatePurchaseDataList\");\r\n        List<Purchase_Requisition> pr_list = service.searchTableByUser(user_id);\r\n        for (Purchase_Requisition pr : pr_list) {\r\n            System.out.println(pr.getPurchase_requisition_id());\r\n        }\r\n        // 拼串\r\n        String json = \"\";\r\n        for (Purchase_Requisition pr : pr_list) {\r\n            try {\r\n                json += writeValueAsString(pr);\r\n            } catch (JsonProcessingException e) {\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n        json = json.replace(\"}\", \"},\");\r\n        json = json.replaceFirst(\".$\",\"\");  //去掉最后的逗号\r\n        json += \"]\";\r\n        StringBuffer buf = new StringBuffer();\r\n        buf.append(json).insert(0, \"[\");\r\n        json = buf.toString();  //拼串完成\r\n        System.out.println(json);\r\n\r\n        String filename = \"PurchaseData.txt\";\r\n        JsonUtil.writeJson(filename, json);  //写入Data.json文件\r\n        return json;\r\n    }\r\n\r\n\r\n    // 初始化 物品清单列表\r\n    public void initListTable(HttpServletRequest request, HttpServletResponse response) throws\r\n            ServletException, IOException {\r\n        System.out.println(\"PurchaseServlet：进入 初始化物品清单弹窗表格 后端\");\r\n        String order_id = request.getParameter(\"order_id\");\r\n        System.out.println(\"PurchaseServlet order_id=\"+order_id);\r\n        String purchaseDataList = \"\";\r\n        if (order_id != null)\r\n            purchaseDataList = updatePurchaseListData(order_id);\r\n\r\n\r\n        ResultInfo info = new ResultInfo();\r\n        // 4. 响应结果\r\n        info.setFlag(true);\r\n        info.setData(purchaseDataList);\r\n        // 将 info 对象序列化为 json\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        String json = mapper.writeValueAsString(info);\r\n        // 将 json 数据写回客户端\r\n        response.setContentType(\"application/json;charset=utf-8\");\r\n        response.getWriter().write(json);\r\n    }\r\n\r\n    public String updatePurchaseListData(String order_id) throws IOException {\r\n        System.out.println(\"===================\");\r\n        System.out.println(\"长度：\"+temp_items.keySet());\r\n        System.out.println(\"===================\");\r\n        System.out.println(\"更新 物品清单列表\"+order_id);\r\n\r\n        // 获取物品清单的 全部物品行\r\n        List<Object_Entry> oe_list = o_service.search(order_id);\r\n\r\n        // 根据 order_id 查找 物品信息\r\n        List<Item> items = new ArrayList<>();\r\n        for (Object_Entry oe : oe_list) {\r\n            System.out.println(\"物品id=\"+oe.getObject_id());\r\n            Item item = i_service.search(oe.getObject_id());  // 获取物品信息\r\n            item.setQuantity(oe.getQuantity());  // 修改数量（采购物品的数量在object_entry中）\r\n            item.print();  // 显示对象信息\r\n            items.add(item);  //添加进 物品信息表\r\n        }\r\n        List<Item> result = new ArrayList<>();\r\n        for (Item item : items) {\r\n            result.add(item);\r\n        }\r\n        if (temp_items.get(order_id) != null) {\r\n            for (Item item1 : temp_items.get(order_id)) {\r\n                for (Item i2 : items) {\r\n                    if (item1.getObject_id().equals(i2.getObject_id())) {\r\n                        result.remove(i2);\r\n                        result.add(item1);\r\n                        break;\r\n                    } else {\r\n                        result.add(item1);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        System.out.println(\"-------*************************----------\"+items.size());\r\n        for(Item i : result) {\r\n            i.print();\r\n        }\r\n        System.out.println(\"--------*************************---------\");\r\n\r\n\r\n        // 拼串\r\n        String json = \"\";\r\n        for (Item i : result) {\r\n            try {\r\n                json += writeValueAsString(i);\r\n            } catch (JsonProcessingException e) {\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n        json = json.replace(\"}\", \"},\");\r\n        json = json.replaceFirst(\".$\",\"\");  //去掉最后的逗号\r\n        json += \"]\";\r\n        StringBuffer buf = new StringBuffer();\r\n        buf.append(json).insert(0, \"[\");\r\n        json = buf.toString();  //拼串完成\r\n        System.out.println(\"物品信息json=\"+json);\r\n        String filename = \"PurchaseListData.txt\";\r\n        JsonUtil.writeJson(filename, json);  //写入Data.json文件\r\n        return json;\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/web/servlet/PurchaseServlet.java b/src/main/java/web/servlet/PurchaseServlet.java
--- a/src/main/java/web/servlet/PurchaseServlet.java	(revision 7b26828b867c9f6627cd5d7a1bb0990c16716691)
+++ b/src/main/java/web/servlet/PurchaseServlet.java	(date 1686227021460)
@@ -37,7 +37,8 @@
     private static Map<String, List<Item>> temp_items = new HashMap<>();
     private static String order_id = "";
 
-    public void createOrUpdateItems(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
+    public void createOrUpdateItems(HttpServletRequest request, HttpServletResponse response)
+            throws ServletException, IOException {
         System.out.println("PurchaseServlet：进入 采购申请 后端");
         //1.获取数据（领用申请表基本信息 + 领用申请物品清单）
         Purchase_Requisition purchase_requisition = new Purchase_Requisition();
@@ -80,25 +81,32 @@
 //        } catch (InvocationTargetException e) {
 //            e.printStackTrace();
 //        }
-
+        System.out.println("前端传回的数据 封装的采购申请对象");
         purchase_requisition.print();  // 调试，显示前端传回的数据
 
-        // TODO: 前端表格里的物品清单数据还没传进来
         List<Object_Entry> object_entries = new ArrayList<>();
         Object_Entry objectEntry = new Object_Entry();
         System.out.println("++++++++++++++++++++++++++++++++++++++++++++");
+        if(purchase_requisition != null) {
+            System.out.println("###91行：purchase_requisition != null");
+        }
+        System.out.println("开始保存order_entry");
         for (Item item : temp_items.get(purchase_requisition.getPurchase_order_id())) {
+            item.print();
             objectEntry.setObject_id(item.getObject_id());
-            objectEntry.setNum((int)(item.getQuantity()));
+            objectEntry.setNum((int)(item.getQuantity()));  // 把采购物品对应的数量
             object_entries.add(objectEntry);
             item.setQuantity(0);
             System.out.println(item.getNotes());
         }
+
         System.out.println("++++++++++++++++++++++++++++++++++++++++++++");
 
+        // 将缓存中的item信息 传给service，保存到数据库
         i_service.add(temp_items.get(purchase_requisition.getPurchase_order_id()));
 
         template_order to = new template_order(purchase_requisition, object_entries);
+
         service.createOrUpdate(to);
         ResultInfo info = new ResultInfo();
         // 4. 响应结果
@@ -114,6 +122,26 @@
 
     // 更新清单
     public void UpdateItemsList(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
+        // 注册 String 转 Date的BeanUtils转换器
+        ConvertUtils.register(new Converter() {
+            @Override
+            public Object convert(Class aClass, Object o) {
+                // 如果字符串为null，则返回null
+                if(o == null) return null;
+                // 如果字符串为空格，则返回null
+                String str = (String) o;
+                if(str.trim().equals("")) return null;
+                // 将字符串转为Date类型
+                SimpleDateFormat formatter = new SimpleDateFormat("yyyy/MM/dd hh:mm:ss");
+                try {
+                    return formatter.parse(o.toString());
+                } catch (ParseException e) {
+                    e.printStackTrace();
+                }
+                return new Date();
+            }
+        }, Date.class);
+
         Item item_changed = new Item();
         Map<String, String[]> map = request.getParameterMap();
         try {
@@ -137,8 +165,8 @@
         temp_items.get(order_id).add(item_changed);  // 缓存 前端修改的item
 
 
+        // 响应结果
         ResultInfo info = new ResultInfo();
-        // 4. 响应结果
         info.setFlag(true);
         // 将 info 对象序列化为 json
         ObjectMapper mapper = new ObjectMapper();
@@ -153,14 +181,13 @@
     }
 
 
-    public void deleteTable(HttpServletRequest request, HttpServletResponse response) throws
-            ServletException, IOException {
+    public void deleteTable(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
         // 从前端获取 待删除申请表行的 tableId
         String tableId = request.getParameter("tableId");
         // 调用service删除
         service.deleteTable(tableId);
         // TODO: 更新前端表格页面，这个好像不需要做，前端会自动删除（加个"确认删除"的弹窗）
-        //  只需要把tableId传给后端即可
+        // 只需要把tableId传给后端即可
 
     }
 
@@ -209,8 +236,8 @@
         json = buf.toString();  //拼串完成
         System.out.println(json);
 
-        String filename = "PurchaseData.txt";
-        JsonUtil.writeJson(filename, json);  //写入Data.json文件
+//        String filename = "PurchaseData.txt";
+//        JsonUtil.writeJson(filename, json);  //写入Data.json文件
         return json;
     }
 
@@ -218,14 +245,13 @@
     // 初始化 物品清单列表
     public void initListTable(HttpServletRequest request, HttpServletResponse response) throws
             ServletException, IOException {
-        System.out.println("PurchaseServlet：进入 初始化物品清单弹窗表格 后端");
+        System.out.println("PurchaseServlet：初始化物品清单弹窗");
         String order_id = request.getParameter("order_id");
-        System.out.println("PurchaseServlet order_id="+order_id);
+//        System.out.println("PurchaseServlet order_id="+order_id);
         String purchaseDataList = "";
         if (order_id != null)
             purchaseDataList = updatePurchaseListData(order_id);
 
-
         ResultInfo info = new ResultInfo();
         // 4. 响应结果
         info.setFlag(true);
@@ -252,14 +278,16 @@
         for (Object_Entry oe : oe_list) {
             System.out.println("物品id="+oe.getObject_id());
             Item item = i_service.search(oe.getObject_id());  // 获取物品信息
-            item.setQuantity(oe.getQuantity());  // 修改数量（采购物品的数量在object_entry中）
+            item.setQuantity(oe.getQuantity());  // 修改数量（采购物品的数量在object_entry类中）
             item.print();  // 显示对象信息
             items.add(item);  //添加进 物品信息表
         }
+        //拷贝副本
         List<Item> result = new ArrayList<>();
         for (Item item : items) {
             result.add(item);
         }
+
         if (temp_items.get(order_id) != null) {
             for (Item item1 : temp_items.get(order_id)) {
                 for (Item i2 : items) {
@@ -296,8 +324,8 @@
         buf.append(json).insert(0, "[");
         json = buf.toString();  //拼串完成
         System.out.println("物品信息json="+json);
-        String filename = "PurchaseListData.txt";
-        JsonUtil.writeJson(filename, json);  //写入Data.json文件
+//        String filename = "PurchaseListData.txt";
+//        JsonUtil.writeJson(filename, json);  //写入Data.json文件
         return json;
     }
 
Index: src/main/webapp/form_purchase.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"utf-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><meta name=\"renderer\" content=\"webkit\">\r\n\r\n    <title>基本表单</title>\r\n    <meta name=\"keywords\" >\r\n    <meta name=\"description\" >\r\n    <link href=\"css/bootstrap.min.css?v=3.4.0\" rel=\"stylesheet\">\r\n    <link href=\"font-awesome/css/font-awesome.css?v=4.3.0\" rel=\"stylesheet\">\r\n    <link href=\"css/plugins/iCheck/custom.css\" rel=\"stylesheet\">\r\n    <link href=\"css/animate.css\" rel=\"stylesheet\">\r\n    <link href=\"css/style.css?v=2.2.0\" rel=\"stylesheet\">\r\n</head>\r\n<body>\r\n<!--<button type=\"button\" id=\"batch-edit-btn\">批量编辑</button>-->\r\n<!--<button type=\"button\" id=\"batch-save-btn\">批量保存</button>-->\r\n<!--<table id=\"table\" class=\"display\" width=\"100%\"></table>-->\r\n<div id=\"wrapper\">\r\n    <!-- 侧边栏 -->\r\n    <div id=\"left_sidebar\"></div>\r\n\r\n    <div id=\"page-wrapper\" class=\"gray-bg dashbard-1\">\r\n        <!--头部-->\r\n        <div id=\"header\"></div>\r\n        <div class=\"row wrapper border-bottom white-bg page-heading\">\r\n            <div class=\"col-lg-10\">\r\n                <h2>采购申请</h2>\r\n            </div>\r\n            <div class=\"col-lg-2\"></div>\r\n        </div>\r\n        <div class=\"wrapper wrapper-content animated fadeInRight\">\r\n            <!--                所有表单元素  -->\r\n            <div class=\"row\">\r\n                <div class=\"col-lg-12\">\r\n                    <div class=\"ibox float-e-margins\">\r\n                        <div class=\"ibox-title\">\r\n                            <h5>采购申请表</h5>\r\n                            <div class=\"ibox-tools\">\r\n                                <a class=\"collapse-link\">\r\n                                    <i class=\"fa fa-chevron-up\"></i>\r\n                                </a>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"ibox-content\">\r\n                            <form method=\"get\" class=\"form-horizontal\">\r\n\r\n                                <div class=\"row\">\r\n                                    <div class=\"col-lg-12\">\r\n                                        <div class=\"ibox float-e-margins\">\r\n\r\n                                            <div class=\"ibox-content\">\r\n                                                <div class=\"\">\r\n                                                    <a onclick=\"fnClickAddRow();\" href=\"javascript:void(0);\" class=\"btn btn-primary \">新建采购申请</a>\r\n                                                    <button type=\"button\" id=\"batch-edit-btn\" class=\"btn btn-primary \">批量编辑</button>\r\n                                                    <button type=\"button\" id=\"batch-save-btn\" class=\"btn btn-primary \">批量保存</button>\r\n                                                </div>\r\n\r\n\r\n                                                <table id=\"table\" class=\"datatable table table-striped table-bordered table-hover\">\r\n\r\n                                                </table>\r\n\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </form>\r\n                        </div>\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- 数据表单弹窗 -->\r\n        <form method=\"post\" class=\"form-horizontal\" role=\"form\" id=\"updateGoodsForm\">\r\n            <div class=\"modal fade\" id=\"updateModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"updateModalLabel\" aria-hidden=\"true\">\r\n                <div class=\"modal-dialog\" style=\"width: 1400px\">\r\n                    <div class=\"modal-content\">\r\n                        <div class=\"modal-header\">\r\n                            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">\r\n                                ×\r\n                            </button>\r\n                            <h4 class=\"modal-title\" id=\"updateModalLabel\">\r\n                                物品清单\r\n                            </h4>\r\n                        </div>\r\n\r\n                        <div class=\"form-group\">\r\n                            <div class=\"row\">\r\n                                <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox float-e-margins\">\r\n                                        <div class=\"ibox-content\">\r\n\r\n                                            <div class=\"\">\r\n                                                <button onclick=\"listfnClickAddRow();\" href=\"javascript:void(0);\" class=\"list-top-btn btn btn-primary \">添加物品</button>\r\n                                                <button type=\"button\" id=\"list-batch-edit-btn\" class=\"list-top-btn btn btn-primary \">批量编辑</button>\r\n                                                <button type=\"button\" id=\"list-batch-save-btn\" class=\"list-top-btn btn btn-primary \">批量保存</button>\r\n                                            </div>\r\n\r\n                                            <table id=listTable width=\"100%\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n                                            </table>\r\n\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>  <!--   end modal-body  -->\r\n                </div><!-- /.modal-content -->\r\n            </div><!-- /.modal -->\r\n        </form>\r\n    </div>\r\n</div>\r\n\r\n\r\n\r\n\r\n<!-- Mainly scripts -->\r\n<script src=\"js/jquery-2.1.1.min.js\"></script>\r\n<script src=\"js/bootstrap.min.js?v=3.4.0\"></script>\r\n<script src=\"js/plugins/metisMenu/jquery.metisMenu.js\"></script>\r\n<script src=\"js/plugins/slimscroll/jquery.slimscroll.min.js\"></script>\r\n\r\n<!-- Custom and plugin javascript -->\r\n<script src=\"js/hplus.js?v=2.2.0\"></script>\r\n<script src=\"js/plugins/pace/pace.min.js\"></script>\r\n\r\n<!-- iCheck -->\r\n<script src=\"js/plugins/iCheck/icheck.min.js\"></script>\r\n\r\n<!--&lt;!&ndash;引入JavaScript&ndash;&gt;-->\r\n<script type=\"text/javascript\" language=\"javascript\" src=\"https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js\"></script>\r\n\r\n\r\n<!-- Data Tables -->\r\n<script src=\"js/plugins/dataTables/jquery.dataTables.js\"></script>\r\n<script src=\"js/plugins/dataTables/dataTables.bootstrap.js\"></script>\r\n\r\n<!--&lt;!&ndash;引入css&ndash;&gt;-->\r\n<!--<link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.datatables.net/1.10.15/css/jquery.dataTables.min.css\">-->\r\n\r\n<!--&lt;!&ndash;&lt;!&ndash;引入JavaScript&ndash;&gt;&ndash;&gt;-->\r\n<!--<script type=\"text/javascript\" language=\"javascript\" src=\"//code.jquery.com/jquery-1.12.4.js\"></script>-->\r\n<!--<script type=\"text/javascript\" language=\"javascript\" src=\"https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js\"></script>-->\r\n\r\n\r\n\r\n<!--初始化代码-->\r\n<!-- 导入header -->\r\n<script>\r\n    $(function () {\r\n        $.get(\"header.html\",function (data) {\r\n            $(\"#header\").html(data);\r\n        });\r\n    });\r\n</script>\r\n<script>\r\n    $(function () {\r\n        $.get(\"left_sidebar.html\",function (data) {\r\n            $(\"#left_sidebar\").html(data);\r\n        });\r\n    });\r\n</script>\r\n<script>\r\n    var temp_user_id;\r\n    var temp_data;\r\n\r\n    console.log(\"--flag-1-\");\r\n\r\n    $.ajax({\r\n        async: false,\r\n        type : \"post\",\r\n        url : \"user/findOne\",\r\n        success : function(user) {\r\n            console.log(\"--flag-findOne-\");\r\n            temp_user_id = user.user_id;\r\n            console.log(\"user.user_id\"+user.user_id);\r\n        }\r\n    });\r\n    // 初始化，获取首页表格数据\r\n    $.ajax({\r\n        async: false,\r\n        data: {user_id: temp_user_id},\r\n        type : \"post\",\r\n        url : \"purchase/initTable\",\r\n        success : function(data) {\r\n            console.log(\"--flag-inittable-\");\r\n            temp_data=data.data;\r\n        }\r\n    });\r\n\r\n    function json2Array(jsonData, list_or_not) {\r\n        var jsonsString = jsonData.slice(1, jsonData.length - 1);\r\n        var jsonStrings = jsonsString.split(\"},\");\r\n        var length = jsonStrings.length;\r\n        var jsons = [];\r\n        for (var i = 0; i !== length-1; ++i) {\r\n            jsonStrings[i] += '}';\r\n        }\r\n        var source = [[]];\r\n        for (var i = 0; i !== length; ++i) {\r\n            //console.log(\"$\"+jsonStrings[i]);\r\n            jsons[i] = eval('(' + jsonStrings[i] + ')');\r\n            var data = [];\r\n            for(var key in jsons[i]) {\r\n                if(i === 0) {\r\n                    source[0].push(key);\r\n                }\r\n                //console.log(\"i=\"+i+\"|key=\"+key+\"|json[i,key]=\"+jsons[i][key]);\r\n                if(!list_or_not || key !== \"object_id\" ) {\r\n                    data.push(jsons[i][key]);\r\n                } else {\r\n                    console.log(\"跳过在执行一次\")\r\n                }\r\n            }\r\n            source.push(data);\r\n        }\r\n        return source.slice(1); //删除第1行\r\n    }\r\n    //console.log(\"temp_data=\\n\"+temp_data);\r\n    temp_data = json2Array(temp_data, false)\r\n\r\n    const dataSets = [];  //初始化物品清单数据源\r\n    //console.log(\"temp_data1=\\n\"+temp_data);\r\n    $(document).ready(function() {\r\n        $(function(){\r\n            var table = $('#table').DataTable({\r\n                retrieve: true,\r\n                data:temp_data,\r\n                columns:[\r\n                    {\r\n                        'field': \"purchase_requisition_id\",\r\n                        'title': '采购申请表编号',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"purchase_order_id\",\r\n                        'title': '采购物品清单编号',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"requisition_user_id\",\r\n                        'title': '申请人',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"purpose\",\r\n                        'title': '采购用途',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"requisition_date\",\r\n                        'title': '申请提交日期',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"state\",\r\n                        'title': '申请当前状态',\r\n                        'defaultContent' : \"0\"\r\n                    }, {\r\n                        'field': \"approval_user_id\",\r\n                        'title': '审批人',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"approval_opinions\",\r\n                        'title': '审批意见',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"approval_date\",\r\n                        'title': '审批日期',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        field: \"operate\",\r\n                        sTitle: '操作',\r\n                        sDefaultContent : \"<button class='submit-btn btn btn-primary btn-xs' type='button' >提交</button>\"+\r\n                            \"<button class='edit-btn btn btn-primary btn-xs' type='button' style='margin-left: 10px'>编辑</button>\"  +\r\n                        \"<button class='list-btn btn btn-primary btn-xs' type='button' style='margin-left: 10px'>物品清单</button>\"+\r\n                            \"<button class='delete btn btn-default btn-xs' style='margin-left: 10px'>删除</button>\",\r\n                        sClass: 'text-center',\r\n                        \"data\" : null,\r\n                        // \"render\" : function(data, type,row) {\r\n                        //     var id = '\"' + row.id + '\"';\r\n                        //     var html = \"<a href='javascript:void(0);'  class='btn btn-primary btn-xs'  onclick='EditViewById()'></i>物品清单</a>\"\r\n                        //     return html;\r\n                        //     // formatter: actionFormatter\r\n                        // }\r\n                    }],\r\n                \"language\": {\r\n                    \"sProcessing\": \"处理中...\",\r\n                    \"sLengthMenu\": \"显示 _MENU_ 项结果\",\r\n                    \"sZeroRecords\": \"没有匹配结果\",\r\n                    \"sInfo\": \"显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项\",\r\n                    \"sInfoEmpty\": \"显示第 0 至 0 项结果，共 0 项\",\r\n                    \"sInfoFiltered\": \"(由 _MAX_ 项结果过滤)\",\r\n                    \"sInfoPostFix\": \"\",\r\n                    \"sSearch\": \"搜索:\",\r\n                    \"sUrl\": \"\",\r\n                    \"sEmptyTable\": \"表中数据为空\",\r\n                    \"sLoadingRecords\": \"载入中...\",\r\n                    \"sInfoThousands\": \",\",\r\n                    \"oPaginate\": {\r\n                        \"sFirst\": \"首页\",\r\n                        \"sPrevious\": \"上页\",\r\n                        \"sNext\": \"下页\",\r\n                        \"sLast\": \"末页\"\r\n                    },\r\n                    \"oAria\": {\r\n                        \"sSortAscending\": \": 以升序排列此列\",\r\n                        \"sSortDescending\": \": 以降序排列此列\"\r\n                    }\r\n                }\r\n            });\r\n\r\n            var temp_list_data;\r\n            var temp_order_id;  // 本条订单的order——id\r\n\r\n            // 点击 物品清单\r\n            $(\"table tbody\").on(\"click\",\".list-btn\",function (){\r\n                // TODO: 待办 - 进入物品清单弹窗，刷新表单\r\n                //$('#listTable').dataTable().api().draw();\r\n\r\n                var tds=$(this).parents(\"tr\").children();\r\n                temp_order_id = tds[1].innerText;\r\n                //console.log(\"temp_order_id\"+temp_order_id);\r\n                $.ajax({\r\n                    async: true,  // true 同步，false异步\r\n                    data: {order_id: temp_order_id},\r\n                    type: \"post\",\r\n                    url : \"purchase/initListTable\",\r\n                    success : function(data) {\r\n                        //console.log(\"--flag-initListTable-\");\r\n                        temp_list_data=data.data;\r\n                        temp_list_data = json2Array(temp_list_data, true)\r\n                    }\r\n                });\r\n\r\n                $('#updateModal').modal('show');  // 显示弹窗表格\r\n                // 更新表格数据\r\n                $('#listTable').dataTable().api().clear();\r\n                $('#listTable').dataTable().api().rows.add(temp_list_data);\r\n                $('#listTable').dataTable().api().draw();\r\n\r\n\r\n                var arr = tds[5].innerText;\r\n                console.log(arr);\r\n                if(arr==='已提交'||arr==='审核通过'){\r\n                    $('.list-edit-btn').attr('disabled',true);\r\n                    $('.list-delete').attr('disabled',true);\r\n                    $('.list-top-btn').attr('disabled',true);\r\n                }\r\n                if(arr==='未提交'||arr==='审核未通过'){\r\n                    $('.list-edit-btn').attr('disabled',false);\r\n                    $('.list-delete').attr('disabled',false);\r\n                    $('.list-top-btn').attr('disabled',false);\r\n                }\r\n\r\n                $('#updateModal').modal('show');\r\n            })\r\n\r\n            var listtable = $('#listTable').DataTable({\r\n                retrieve: true,\r\n                data:dataSets,\r\n                //ajax: \"json/PurchaseListData.txt\",\r\n                columns:[\r\n                    {\r\n                        'field': \"name\",\r\n                        'title': '物品名称',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"specification\",\r\n                        'title': '规格',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"quantity\",\r\n                        'title': '数量',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"unit\",\r\n                        'title': '包装单位',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"classification\",\r\n                        'title': '分类',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"price\",\r\n                        'title': '单价',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"expiration_time\",\r\n                        'title': '过期时间',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"upper_limit\",\r\n                        'title': '警戒上限',\r\n                        // width:90,\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"lower_limit\",\r\n                        'title': '警戒下限',\r\n                        // width:90,\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"notes\",\r\n                        'title': '备注',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        field: \"operate\",\r\n                        sTitle: '操作',\r\n                        sDefaultContent : \"<button class='list-edit-btn btn btn-primary btn-xs' type='button'>编辑</button>\" +\r\n                            \"<button class='list-delete btn btn-default btn-xs' style='margin-left: 10px'>删除</button>\",\r\n                        sClass: 'text-center',\r\n                        // width:100,\r\n                        \"data\" : null,\r\n                        // \"render\" : function(data, type,row) {\r\n                        //   var html = \"<a href='javascript:void(0);'  class='edit-btn btn btn-primary btn-xs' type='button'>修改</a>\"\r\n                        //   html += \"<a href='javascript:void(0);'  class='delete btn btn-default btn-xs'>删除</a>\"\r\n                        //   return html;\r\n                        //   // formatter: actionFormatter\r\n                        // }\r\n                    }],\r\n                \"language\": {\r\n                    \"sProcessing\": \"处理中...\",\r\n                    \"sLengthMenu\": \"显示 _MENU_ 项结果\",\r\n                    \"sZeroRecords\": \"没有匹配结果\",\r\n                    \"sInfo\": \"显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项\",\r\n                    \"sInfoEmpty\": \"显示第 0 至 0 项结果，共 0 项\",\r\n                    \"sInfoFiltered\": \"(由 _MAX_ 项结果过滤)\",\r\n                    \"sInfoPostFix\": \"\",\r\n                    \"sSearch\": \"搜索:\",\r\n                    \"sUrl\": \"\",\r\n                    \"sEmptyTable\": \"表中数据为空\",\r\n                    \"sLoadingRecords\": \"载入中...\",\r\n                    \"sInfoThousands\": \",\",\r\n                    \"oPaginate\": {\r\n                        \"sFirst\": \"首页\",\r\n                        \"sPrevious\": \"上页\",\r\n                        \"sNext\": \"下页\",\r\n                        \"sLast\": \"末页\"\r\n                    },\r\n                    \"oAria\": {\r\n                        \"sSortAscending\": \": 以升序排列此列\",\r\n                        \"sSortDescending\": \": 以降序排列此列\"\r\n                    }\r\n                }\r\n            });\r\n\r\n\r\n            // 点击 提交 按钮\r\n            $(\"table tbody\").on(\"click\",\".submit-btn\",function (){\r\n                var tds=$(this).parents(\"tr\").children();\r\n                var arr = tds[5].innerText;\r\n                console.log(arr);\r\n                if(arr==='未提交'||arr==='审核未通过'){\r\n                    // 提交的代码\r\n                    if(confirm('确认提交申请？')){  //确认提交\r\n                        // 拼后端BeanUtils所需的map串\r\n\r\n                        // 时间格式纠正\r\n                        Date.prototype.toLocaleString = function() {\r\n                            function addZero(num) {\r\n                                return num < 10 ? \"0\" + num : num;\r\n                            }\r\n                            // 按自定义拼接格式返回\r\n                            return this.getFullYear() + \"/\" + addZero(this.getMonth() + 1) + \"/\" + addZero(this.getDate()) + \" \" +\r\n                                addZero((this.getHours()+24-8)%24) + \":\" + addZero(this.getMinutes()) + \":\" + addZero(this.getSeconds());\r\n                        };\r\n                        var requisition_dateTime = \"\", approval_date = \"\";\r\n                        if (tds[4].innerText !== \"\")\r\n                            requisition_dateTime = (new Date(eval(tds[4].innerText))).toLocaleString();\r\n                        if (tds[8].innerText !== \"\")\r\n                            approval_date = (new Date(eval(tds[8].innerText))).toLocaleString();\r\n\r\n                        // 状态改回数值\r\n                        var shenqing_state = '';\r\n                        if(arr==='未提交'){\r\n                            shenqing_state = '0';\r\n                        }else if(arr==='已提交'){\r\n                            shenqing_state = '1';\r\n                        }else if(arr==='审核通过'){\r\n                            shenqing_state = '2';\r\n                        }else if(arr==='审核未通过'){\r\n                            shenqing_state = '3';\r\n                        }\r\n\r\n                        var front_end_data = \"\";\r\n                        if (tds[0].innerText !== \"\") front_end_data += \"purchase_requisition_id=\"+tds[0].innerText+\"&\";\r\n                        if (tds[1].innerText !== \"\") front_end_data += \"purchase_order_id=\"+tds[1].innerText+\"&\";\r\n                        if (tds[3].innerText !== \"\") front_end_data += \"purpose=\"+tds[3].innerText+\"&\";\r\n                        if (tds[4].innerText !== \"\") front_end_data += \"requisition_date=\"+requisition_dateTime+\"&\";\r\n                        if (tds[5].innerText !== \"\") front_end_data += \"&state=\"+shenqing_state+\"&\";\r\n                        if (tds[6].innerText !== \"\") front_end_data += \"&approval_user_id=\"+tds[6].innerText+\"&\";\r\n                        if (tds[7].innerText !== \"\") front_end_data += \"&approval_opinions=\"+tds[7].innerText+\"&\";\r\n                        if (tds[8].innerText !== \"\") front_end_data += \"&approval_date=\"+approval_date+\"&\";\r\n                        // front_end_data = front_end_data.substring(0, front_end_data.length-1);  //删除最后一个字符\r\n\r\n                        $.get(\"user/findOne\", {}, function (data) {\r\n                            // 获取当前登陆的用户id\r\n                            front_end_data += \"requisition_user_id=\"+data.user_id;\r\n                            console.log(\"front_end_data=\"+front_end_data);\r\n                            // 把前端数据传给后端\r\n                            $.post(\"purchase/createOrUpdateItems\", front_end_data, function (data) {\r\n                                console.log(\"在接受后端数据之后\");\r\n                                if (data.flag) {\r\n                                    alert(\"提交成功\");\r\n                                    tds[5].innerText = '已提交';\r\n                                    // 禁用按钮：应该放入点击确认\r\n                                    $(this).attr('disabled',true);\r\n                                    tds.find('.edit-btn').attr('disabled',true);\r\n                                } else {\r\n                                    alert(\"提交失败\");\r\n                                }\r\n                            })\r\n                        });  // end of $.get(\"user/findOne\"...\r\n                    } // end of confirm(确认提交申请？)\r\n                    else {} //点击取消，无事发生\r\n                }\r\n            })\r\n\r\n            // 申请表修改\r\n            $(\"#table tbody\").on(\"click\",\".edit-btn\",function(){\r\n                var tds=$(this).parents(\"tr\").children();\r\n                $.each(tds, function(i,val){\r\n                    var jqob=$(val);\r\n                    if(i<=2||i>3 ){return true;}//跳过第1项 序号,按钮\r\n                    var txt=jqob.text();\r\n                    var put=$(\"<input type='text' style='width: 80px'>\");\r\n                    put.val(txt);\r\n                    jqob.html(put);\r\n                });\r\n                $(this).html(\"保存\");\r\n                $(this).toggleClass(\"edit-btn\");\r\n                $(this).toggleClass(\"save-btn\");\r\n            });\r\n\r\n            // 申请表修改保存\r\n            $(\"#table tbody\").on(\"click\",\".save-btn\",function(){\r\n                var row=table.row($(this).parents(\"tr\"));\r\n                var tds=$(this).parents(\"tr\").children();\r\n                $.each(tds, function(i,val){\r\n                    var jqob=$(val);\r\n                    //把input变为字符串\r\n                    //console.log(!jqob.has('button').length);\r\n                    if(!jqob.has('button').length){\r\n                        var txt=jqob.children(\"input\").val();\r\n                        //console.log(jqob.children(\"input\"));\r\n                        jqob.html(txt);\r\n                        table.cell(jqob).data(txt);//修改DataTables对象的数据\r\n                    }\r\n                });\r\n                $(this).html(\"编辑\");\r\n                $(this).toggleClass(\"edit-btn\");\r\n                $(this).toggleClass(\"save-btn\");\r\n            });\r\n\r\n            // 物品清单修改\r\n            $(\"#listTable tbody\").on(\"click\",\".list-edit-btn\",function(){\r\n                var tds=$(this).parents(\"tr\").children();\r\n                $.each(tds, function(i,val){\r\n                    var jqob=$(val);\r\n                    if(jqob.has('button').length ){return true;}//跳过第1项 序号,按钮\r\n                    var txt=jqob.text();\r\n                    var put=$(\"<input type='text' style='width: 80px'>\");\r\n                    put.val(txt);\r\n                    jqob.html(put);\r\n                });\r\n                $(this).html(\"保存\");\r\n                $(this).toggleClass(\"list-edit-btn\");\r\n                $(this).toggleClass(\"list-save-btn\");\r\n            });\r\n\r\n            //  物品清单修改保存\r\n            $(\"#listTable tbody\").on(\"click\",\".list-save-btn\",function(){\r\n                var row=listtable.row($(this).parents(\"tr\"));\r\n                var tds=$(this).parents(\"tr\").children();\r\n                $.each(tds, function(i,val){\r\n                    console.log(\"|\"+tds[i].innerText+\"|\");\r\n                    var jqob=$(val);\r\n                    //把input变为字符串\r\n                    if(!jqob.has('button').length){\r\n                        var txt=jqob.children(\"input\").val();\r\n                        jqob.html(txt);\r\n                        listtable.cell(jqob).data(txt);//修改DataTables对象的数据\r\n                    }\r\n                });\r\n\r\n                var front_end_data = \"\";\r\n                if (tds[0].innerText !== \"\") front_end_data += \"name=\"+tds[0].innerText+\"&\";\r\n                if (tds[1].innerText !== \"\") front_end_data += \"specification=\"+tds[1].innerText+\"&\";\r\n                if (tds[2].innerText !== \"\") front_end_data += \"quantity=\"+tds[2].innerText+\"&\";\r\n                if (tds[3].innerText !== \"\") front_end_data += \"unit=\"+tds[3].innerText+\"&\";\r\n                if (tds[4].innerText !== \"\") front_end_data += \"classification=\"+tds[4].innerText+\"&\";\r\n                if (tds[5].innerText !== \"\") front_end_data += \"price=\"+tds[5].innerText+\"&\";\r\n                if (tds[6].innerText !== \"\") front_end_data += \"expiration_time=\"+tds[6].innerText+\"&\";\r\n                if (tds[7].innerText !== \"\") front_end_data += \"lower_limit=\"+tds[7].innerText+\"&\";\r\n                if (tds[8].innerText !== \"\") front_end_data += \"upper_limit=\"+tds[8].innerText+\"&\";\r\n                if (tds[9].innerText !== \"\") front_end_data += \"notes=\"+tds[9].innerText+\"&\";\r\n                //front_end_data = front_end_data.substring(0, front_end_data.length-1);  //删除最后一个字符\r\n                console.log(\"front_end_data\"+front_end_data)\r\n                $.get(\"user/findOne\", {}, function (data) {\r\n                    // 获取当前登陆的用户id\r\n                    front_end_data += \"requisition_user_id=\"+data.user_id;\r\n                    console.log(\"front_end_data=\"+front_end_data);\r\n                    // 把前端数据传给后端\r\n                    $.post(\"purchase/getOrderId\", {order_id: temp_order_id}, function () {\r\n                        $.post(\"purchase/UpdateItemsList\", front_end_data, function (data) {\r\n                            console.log(\"在接受后端数据之后\");\r\n                            if (data.flag) {\r\n                                alert(\"提交成功\");\r\n                                // 禁用按钮：应该放入点击确认\r\n                                $(this).attr('disabled',true);\r\n                                tds.find('.edit-btn').attr('disabled',true);\r\n                            } else {\r\n                                alert(\"提交失败\");\r\n                            }\r\n                        });\r\n                    });\r\n\r\n                });  // end of $.get(\"user/findOne\"...\r\n\r\n                $(this).html(\"编辑\");\r\n                $(this).toggleClass(\"list-edit-btn\");\r\n                $(this).toggleClass(\"list-save-btn\");\r\n            });\r\n\r\n            //批量点击编辑按钮\r\n            $(\"#batch-edit-btn\").click(function(){\r\n                $(\".edit-btn\").click();\r\n            });\r\n            $(\"#batch-save-btn\").click(function(){\r\n                $(\".save-btn\").click();\r\n            });\r\n\r\n            //物品清单批量点击编辑按钮\r\n            $(\"#list-batch-edit-btn\").click(function(){\r\n                $(\".list-edit-btn\").click();\r\n            });\r\n            $(\"#list-batch-save-btn\").click(function(){\r\n                $(\".list-save-btn\").click();\r\n            });\r\n\r\n            // 申请单点击删除按钮，触发删除行脚本\r\n            $(document).on(\"click\",'.delete',function(){\r\n                $('#table').dataTable().fnDeleteRow($(this).closest('tr')[0]);\r\n            });\r\n            // 物品清单点击删除按钮，触发删除行脚本\r\n            $(document).on(\"click\",'.list-delete',function(){\r\n                $('#listTable').dataTable().fnDeleteRow($(this).closest('tr')[0]);\r\n            });\r\n\r\n\r\n            // 根据 申请当前状态的数值，设置前端表格的文字，以及对应行按钮是否可用\r\n            $(\"#table tbody tr\").each(function () {\r\n                var a = $(this).children();//获取每一行\r\n                var arr = a[5].innerText;//取得第六列的值\r\n                if(arr==='0'){\r\n                    a[5].innerText = '未提交';\r\n                }else if(arr==='1'){\r\n                    a[5].innerText = '已提交';\r\n                    a.find('.submit-btn').attr('disabled',true);\r\n                    a.find('.edit-btn').attr('disabled',true);\r\n                }else if(arr==='2'){\r\n                    a[5].innerText = '审核通过';\r\n                    a.find('.submit-btn').attr('disabled',true);\r\n                    a.find('.edit-btn').attr('disabled',true);\r\n                }else if(arr==='3'){\r\n                    a[5].innerText = '审核未通过';\r\n                }\r\n            })\r\n        });\r\n\r\n    } );\r\n\r\n\r\n\r\n</script>\r\n\r\n<script>\r\n    function fnClickAddRow() {\r\n        $('#table').dataTable().fnAddData([\r\n            \"\", \"\", \"\", \"\",\r\n            \"\", \"未提交\", \"\", \"\", \"\",\r\n            \"\", \"\"]);}\r\n    function listfnClickAddRow() {\r\n        $('#listTable').dataTable().fnAddData([\r\n            \"\", \"\", \"\", \"\",\r\n            \"\", \"\", \"\", \"\", \"\",\r\n            \"\", \"\"]);}\r\n</script>\r\n\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/form_purchase.html b/src/main/webapp/form_purchase.html
--- a/src/main/webapp/form_purchase.html	(revision 7b26828b867c9f6627cd5d7a1bb0990c16716691)
+++ b/src/main/webapp/form_purchase.html	(date 1686231619847)
@@ -4,7 +4,7 @@
     <meta charset="utf-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="renderer" content="webkit">
 
-    <title>基本表单</title>
+    <title>采购申请表</title>
     <meta name="keywords" >
     <meta name="description" >
     <link href="css/bootstrap.min.css?v=3.4.0" rel="stylesheet">
@@ -12,6 +12,17 @@
     <link href="css/plugins/iCheck/custom.css" rel="stylesheet">
     <link href="css/animate.css" rel="stylesheet">
     <link href="css/style.css?v=2.2.0" rel="stylesheet">
+<!--    TODO: laz -->
+    <style>
+
+        .table td{
+            word-break: break-all;
+        }
+
+        .table th{
+            word-break: break-all;
+        }
+    </style>
 </head>
 <body>
 <!--<button type="button" id="batch-edit-btn">批量编辑</button>-->
@@ -222,52 +233,63 @@
         return source.slice(1); //删除第1行
     }
     //console.log("temp_data=\n"+temp_data);
-    temp_data = json2Array(temp_data, false)
+    temp_data = json2Array(temp_data, false)  // 主表格数据
 
-    const dataSets = [];  //初始化物品清单数据源
+    const dataSets = [];  // 弹窗表格的 物品清单数据
     //console.log("temp_data1=\n"+temp_data);
     $(document).ready(function() {
         $(function(){
             var table = $('#table').DataTable({
                 retrieve: true,
+                autoWidth:true,
+                // TODO LAZ 所以textcenter
                 data:temp_data,
                 columns:[
                     {
                         'field': "purchase_requisition_id",
                         'title': '采购申请表编号',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     }, {
                         'field': "purchase_order_id",
                         'title': '采购物品清单编号',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     }, {
                         'field': "requisition_user_id",
                         'title': '申请人',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     }, {
                         'field': "purpose",
                         'title': '采购用途',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     }, {
                         'field': "requisition_date",
                         'title': '申请提交日期',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     }, {
                         'field': "state",
                         'title': '申请当前状态',
-                        'defaultContent' : "0"
+                        'defaultContent' : "0",
+                        sClass: 'text-center'
                     }, {
                         'field': "approval_user_id",
                         'title': '审批人',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     }, {
                         'field': "approval_opinions",
                         'title': '审批意见',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     }, {
                         'field': "approval_date",
                         'title': '审批日期',
-                        'defaultContent' : ""
+                        'defaultContent' : "",
+                        sClass: 'text-center'
                     }, {
                         field: "operate",
                         sTitle: '操作',
@@ -313,16 +335,16 @@
             var temp_list_data;
             var temp_order_id;  // 本条订单的order——id
 
-            // 点击 物品清单
+            // 点击 物品清单 按钮
             $("table tbody").on("click",".list-btn",function (){
                 // TODO: 待办 - 进入物品清单弹窗，刷新表单
                 //$('#listTable').dataTable().api().draw();
 
                 var tds=$(this).parents("tr").children();
                 temp_order_id = tds[1].innerText;
-                //console.log("temp_order_id"+temp_order_id);
+                // 向后端请求物品清单数据
                 $.ajax({
-                    async: true,  // true 同步，false异步
+                    async: false,  // true 同步，false异步
                     data: {order_id: temp_order_id},
                     type: "post",
                     url : "purchase/initListTable",
@@ -333,13 +355,7 @@
                     }
                 });
 
-                $('#updateModal').modal('show');  // 显示弹窗表格
-                // 更新表格数据
-                $('#listTable').dataTable().api().clear();
-                $('#listTable').dataTable().api().rows.add(temp_list_data);
-                $('#listTable').dataTable().api().draw();
-
-
+                // 更改"状态"字段 和 按钮状态
                 var arr = tds[5].innerText;
                 console.log(arr);
                 if(arr==='已提交'||arr==='审核通过'){
@@ -353,11 +369,37 @@
                     $('.list-top-btn').attr('disabled',false);
                 }
 
+                // 更新表格数据
+                $('#listTable').dataTable().api().clear();
+                $('#listTable').dataTable().api().rows.add(temp_list_data);
+                $('#listTable').dataTable().api().draw();
+
                 $('#updateModal').modal('show');
+
+                $.ajax({
+                    async: false,  // true 同步，false异步
+                    data: {order_id: temp_order_id},
+                    type: "post",
+                    url : "purchase/initListTable",
+                    success : function(data) {
+                        //console.log("--flag-initListTable-");
+                        temp_list_data=data.data;
+                        temp_list_data = json2Array(temp_list_data, true)
+                    }
+                })
+                // 更新表格数据
+                $('#listTable').dataTable().api().clear();
+                $('#listTable').dataTable().api().rows.add(temp_list_data);
+                $('#listTable').dataTable().api().draw();
+
+
+
+
             })
 
             var listtable = $('#listTable').DataTable({
                 retrieve: true,
+
                 data:dataSets,
                 //ajax: "json/PurchaseListData.txt",
                 columns:[
@@ -497,10 +539,10 @@
                         if (tds[1].innerText !== "") front_end_data += "purchase_order_id="+tds[1].innerText+"&";
                         if (tds[3].innerText !== "") front_end_data += "purpose="+tds[3].innerText+"&";
                         if (tds[4].innerText !== "") front_end_data += "requisition_date="+requisition_dateTime+"&";
-                        if (tds[5].innerText !== "") front_end_data += "&state="+shenqing_state+"&";
-                        if (tds[6].innerText !== "") front_end_data += "&approval_user_id="+tds[6].innerText+"&";
-                        if (tds[7].innerText !== "") front_end_data += "&approval_opinions="+tds[7].innerText+"&";
-                        if (tds[8].innerText !== "") front_end_data += "&approval_date="+approval_date+"&";
+                        if (tds[5].innerText !== "") front_end_data += "state="+shenqing_state+"&";
+                        if (tds[6].innerText !== "") front_end_data += "approval_user_id="+tds[6].innerText+"&";
+                        if (tds[7].innerText !== "") front_end_data += "approval_opinions="+tds[7].innerText+"&";
+                        if (tds[8].innerText !== "") front_end_data += "approval_date="+approval_date+"&";
                         // front_end_data = front_end_data.substring(0, front_end_data.length-1);  //删除最后一个字符
 
                         $.get("user/findOne", {}, function (data) {
@@ -561,7 +603,7 @@
                 $(this).toggleClass("edit-btn");
                 $(this).toggleClass("save-btn");
             });
-
+0
             // 物品清单修改
             $("#listTable tbody").on("click",".list-edit-btn",function(){
                 var tds=$(this).parents("tr").children();
@@ -607,7 +649,7 @@
                 //front_end_data = front_end_data.substring(0, front_end_data.length-1);  //删除最后一个字符
                 console.log("front_end_data"+front_end_data)
                 $.get("user/findOne", {}, function (data) {
-                    // 获取当前登陆的用户id
+                    // 获取当前登陆的用户id，写入前端待发送的数据
                     front_end_data += "requisition_user_id="+data.user_id;
                     console.log("front_end_data="+front_end_data);
                     // 把前端数据传给后端
@@ -619,6 +661,27 @@
                                 // 禁用按钮：应该放入点击确认
                                 $(this).attr('disabled',true);
                                 tds.find('.edit-btn').attr('disabled',true);
+
+                                // --------更新一次表单窗格-----------
+                                temp_order_id = tds[1].innerText;
+                                $.ajax({
+                                    async: true,  // true 同步，false异步
+                                    data: {order_id: temp_order_id},
+                                    type: "post",
+                                    url : "purchase/initListTable",
+                                    success : function(data) {
+                                        console.log("--物品清单行修改保存后，更新一次窗口数据--");
+                                        temp_list_data=data.data;
+                                        temp_list_data = json2Array(temp_list_data, true)
+                                    }
+                                });
+                                $('#updateModal').modal('show');  // 显示弹窗表格
+                                // 更新表格数据
+                                $('#listTable').dataTable().api().clear();
+                                $('#listTable').dataTable().api().rows.add(temp_list_data);
+                                $('#listTable').dataTable().api().draw();
+                                //----------------------------------------
+
                             } else {
                                 alert("提交失败");
                             }
Index: src/main/java/web/servlet/GetOrBorrowServlet.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package web.servlet;\r\n\r\nimport com.fasterxml.jackson.databind.ObjectMapper;\r\nimport domain.*;\r\nimport org.apache.commons.beanutils.BeanUtils;\r\nimport service.get_or_borrow_service;\r\nimport service.impl.get_or_borrow_service_impl;\r\nimport service.impl.order_service_impl;\r\nimport service.order_service;\r\n\r\nimport javax.servlet.ServletException;\r\nimport javax.servlet.annotation.WebServlet;\r\nimport javax.servlet.http.HttpServletRequest;\r\nimport javax.servlet.http.HttpServletResponse;\r\nimport java.io.IOException;\r\nimport java.lang.reflect.InvocationTargetException;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\nimport java.util.Map;\r\n\r\n\r\n@WebServlet(\"/getorborrow/*\")\r\npublic class GetOrBorrowServlet extends BaseServlet {\r\n    private static final int SUBMITTED = 1;\r\n\r\n    private final get_or_borrow_service service = new get_or_borrow_service_impl();\r\n    private final order_service orderService = new order_service_impl();\r\n\r\n    /**\r\n     * 领用物品\r\n     */\r\n    public void createOrUpdateItems(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\r\n        System.out.println(\"GetOrBorrowServlet：进入 领用物品 的后端\");\r\n        //1.获取数据（领用申请表基本信息 + 领用申请物品清单）\r\n        Map<String, String[]> map = request.getParameterMap(); //获取前端数据，考虑分两次传输 申请表信息和物品清单\r\n\r\n        //2.封装对象\r\n//        get_or_borrow_Requisition get_or_borrow_requisition = new get_or_borrow_Requisition();\r\n        // 前端传回申请表和物品列表的集合\r\n        template_order templateOrder = new template_order();\r\n        try {\r\n            BeanUtils.populate(templateOrder, map);\r\n        } catch (IllegalAccessException | InvocationTargetException e) {\r\n            e.printStackTrace();\r\n        }\r\n//        List<Object_Entry> object_entries = new ArrayList<>();\r\n//        template_order to = new template_order(get_or_borrow_requisition, object_entries);\r\n\r\n\r\n        service.createOrUpdate(templateOrder);\r\n        ResultInfo info = new ResultInfo();\r\n        // 4. 响应结果\r\n        info.setFlag(true);\r\n        // 将 info 对象序列化为 json\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        String json = mapper.writeValueAsString(info);\r\n        // 将 json 数据写回客户端\r\n        response.setContentType(\"application/json;charset=utf-8\");\r\n        response.getWriter().write(json);\r\n    }\r\n\r\n    /**\r\n     * 查询一个申请单的物品列表\r\n     * @param request\r\n     * @param response\r\n     * @throws ServletException\r\n     * @throws IOException\r\n     */\r\n    public void searchOneOrderList(HttpServletRequest request, HttpServletResponse response)throws ServletException, IOException {\r\n        // TODO : 前端获取某一行订单ID：order_id\r\n        String orderId = request.getParameter(\"order_id\");\r\n        List<Object_Entry> objectEntries = orderService.search(orderId);\r\n        ResultInfo info = new ResultInfo();\r\n        // 4. 响应结果\r\n        info.setData(objectEntries);\r\n        // 将 info 对象序列化为 json\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        String json = mapper.writeValueAsString(info);\r\n        // 将 json 数据写回客户端\r\n        response.setContentType(\"application/json;charset=utf-8\");\r\n        response.getWriter().write(json);\r\n    }\r\n\r\n    /**\r\n     * 用户查询自己的所有申请单\r\n     * @param request\r\n     * @param response\r\n     * @throws ServletException\r\n     * @throws IOException\r\n     */\r\n    public void searchAllByUser(HttpServletRequest request, HttpServletResponse response)throws ServletException, IOException {\r\n        // TODO : 前端获取用户id ： user_id\r\n        String userId = request.getParameter(\"user_id\");\r\n        List<get_or_borrow_Requisition> getOrBorrowRequisitionList = service.searchTableByUser(userId);\r\n        ResultInfo info = new ResultInfo();\r\n        // 4. 响应结果\r\n        info.setData(getOrBorrowRequisitionList);\r\n        // 将 info 对象序列化为 json\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        String json = mapper.writeValueAsString(info);\r\n        // 将 json 数据写回客户端\r\n        response.setContentType(\"application/json;charset=utf-8\");\r\n        response.getWriter().write(json);\r\n    }\r\n\r\n    /**\r\n     * 审批人查询所有需要审批的申请单\r\n     * @param request\r\n     * @param response\r\n     * @throws ServletException\r\n     * @throws IOException\r\n     */\r\n    public void searchAllByApprovalPerson(HttpServletRequest request, HttpServletResponse response)throws ServletException, IOException {\r\n        List<get_or_borrow_Requisition> getOrBorrowRequisitionList = service.searchTableByState(SUBMITTED);\r\n        ResultInfo info = new ResultInfo();\r\n        // 4. 响应结果\r\n        info.setData(getOrBorrowRequisitionList);\r\n        // 将 info 对象序列化为 json\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        String json = mapper.writeValueAsString(info);\r\n        // 将 json 数据写回客户端\r\n        response.setContentType(\"application/json;charset=utf-8\");\r\n        response.getWriter().write(json);\r\n    }\r\n    /**\r\n     * 删除功能\r\n     * @param request\r\n     * @param response\r\n     * @throws ServletException\r\n     * @throws IOException\r\n     */\r\n    public void deleteTable(HttpServletRequest request, HttpServletResponse response) throws\r\n            ServletException, IOException {\r\n        // TODO : 前端获取申请表ID：table_id\r\n        String tableId = request.getParameter(\"table_id\");\r\n        boolean flag = service.deleteTable(tableId);\r\n        ResultInfo info = new ResultInfo();\r\n        // 4. 响应结果\r\n        info.setFlag(flag);\r\n        // 将 info 对象序列化为 json\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        String json = mapper.writeValueAsString(info);\r\n        // 将 json 数据写回客户端\r\n        response.setContentType(\"application/json;charset=utf-8\");\r\n        response.getWriter().write(json);\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/web/servlet/GetOrBorrowServlet.java b/src/main/java/web/servlet/GetOrBorrowServlet.java
--- a/src/main/java/web/servlet/GetOrBorrowServlet.java	(revision 7b26828b867c9f6627cd5d7a1bb0990c16716691)
+++ b/src/main/java/web/servlet/GetOrBorrowServlet.java	(date 1686236332224)
@@ -1,12 +1,18 @@
 package web.servlet;
 
+import com.fasterxml.jackson.core.JsonProcessingException;
 import com.fasterxml.jackson.databind.ObjectMapper;
 import domain.*;
 import org.apache.commons.beanutils.BeanUtils;
+import org.apache.commons.beanutils.ConvertUtils;
+import org.apache.commons.beanutils.Converter;
 import service.get_or_borrow_service;
 import service.impl.get_or_borrow_service_impl;
+import service.impl.item_service_impl;
 import service.impl.order_service_impl;
+import service.item_service;
 import service.order_service;
+import util.UuidUtil;
 
 import javax.servlet.ServletException;
 import javax.servlet.annotation.WebServlet;
@@ -14,15 +20,18 @@
 import javax.servlet.http.HttpServletResponse;
 import java.io.IOException;
 import java.lang.reflect.InvocationTargetException;
-import java.util.ArrayList;
-import java.util.List;
-import java.util.Map;
+import java.text.ParseException;
+import java.text.SimpleDateFormat;
+import java.util.*;
 
 
 @WebServlet("/getorborrow/*")
 public class GetOrBorrowServlet extends BaseServlet {
     private static final int SUBMITTED = 1;
-
+    private static String order_id = "";
+    private static Map<String, List<Item>> temp_items = new HashMap<>();
+    private order_service o_service = new order_service_impl();
+    private item_service i_service = new item_service_impl();
     private final get_or_borrow_service service = new get_or_borrow_service_impl();
     private final order_service orderService = new order_service_impl();
 
@@ -145,4 +154,200 @@
         response.getWriter().write(json);
     }
 
+    public void getOrderId(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException{
+        order_id = request.getParameter("order_id");
+    }
+
+    // 初始化 物品清单列表
+    public void initListTable(HttpServletRequest request, HttpServletResponse response) throws
+            ServletException, IOException {
+        System.out.println("PurchaseServlet：初始化物品清单弹窗");
+        String order_id = request.getParameter("order_id");
+//        System.out.println("PurchaseServlet order_id="+order_id);
+        String purchaseDataList = "";
+        if (order_id != null)
+            purchaseDataList = updatePurchaseListData(order_id);
+
+        ResultInfo info = new ResultInfo();
+        // 4. 响应结果
+        info.setFlag(true);
+        info.setData(purchaseDataList);
+        // 将 info 对象序列化为 json
+        ObjectMapper mapper = new ObjectMapper();
+        String json = mapper.writeValueAsString(info);
+        // 将 json 数据写回客户端
+        response.setContentType("application/json;charset=utf-8");
+        response.getWriter().write(json);
+    }
+
+    public String updatePurchaseListData(String order_id) throws IOException {
+        System.out.println("===================");
+        System.out.println("长度："+temp_items.keySet());
+        System.out.println("===================");
+        System.out.println("更新 物品清单列表"+order_id);
+
+        // 获取物品清单的 全部物品行
+        List<Object_Entry> oe_list = o_service.search(order_id);
+
+        // 根据 order_id 查找 物品信息
+        List<Item> items = new ArrayList<>();
+        for (Object_Entry oe : oe_list) {
+            System.out.println("物品id="+oe.getObject_id());
+            Item item = i_service.search(oe.getObject_id());  // 获取物品信息
+            item.setQuantity(oe.getQuantity());  // 修改数量（采购物品的数量在object_entry类中）
+            item.print();  // 显示对象信息
+            items.add(item);  //添加进 物品信息表
+        }
+        //拷贝副本
+        List<Item> result = new ArrayList<>();
+        for (Item item : items) {
+            result.add(item);
+        }
+
+        if (temp_items.get(order_id) != null) {
+            for (Item item1 : temp_items.get(order_id)) {
+                for (Item i2 : items) {
+                    if (item1.getObject_id().equals(i2.getObject_id())) {
+                        result.remove(i2);
+                        result.add(item1);
+                        break;
+                    } else {
+                        result.add(item1);
+                    }
+                }
+            }
+        }
+        System.out.println("-------*************************----------"+items.size());
+        for(Item i : result) {
+            i.print();
+        }
+        System.out.println("--------*************************---------");
+
+
+        // 拼串
+        String json = "";
+        for (Item i : result) {
+            try {
+                json += writeValueAsString(i);
+            } catch (JsonProcessingException e) {
+                e.printStackTrace();
+            }
+        }
+        json = json.replace("}", "},");
+        json = json.replaceFirst(".$","");  //去掉最后的逗号
+        json += "]";
+        StringBuffer buf = new StringBuffer();
+        buf.append(json).insert(0, "[");
+        json = buf.toString();  //拼串完成
+        System.out.println("物品信息json="+json);
+//        String filename = "PurchaseListData.txt";
+//        JsonUtil.writeJson(filename, json);  //写入Data.json文件
+        return json;
+    }
+
+    // 更新清单
+    public void UpdateItemsList(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
+        // 注册 String 转 Date的BeanUtils转换器
+        ConvertUtils.register(new Converter() {
+            @Override
+            public Object convert(Class aClass, Object o) {
+                // 如果字符串为null，则返回null
+                if(o == null) return null;
+                // 如果字符串为空格，则返回null
+                String str = (String) o;
+                if(str.trim().equals("")) return null;
+                // 将字符串转为Date类型
+                SimpleDateFormat formatter = new SimpleDateFormat("yyyy/MM/dd hh:mm:ss");
+                try {
+                    return formatter.parse(o.toString());
+                } catch (ParseException e) {
+                    e.printStackTrace();
+                }
+                return new Date();
+            }
+        }, Date.class);
+
+        Item item_changed = new Item();
+        Map<String, String[]> map = request.getParameterMap();
+        try {
+            BeanUtils.populate(item_changed, map);
+        } catch (IllegalAccessException | InvocationTargetException e) {
+            e.printStackTrace();
+        }
+        // 如果当前order_id没有关联的物品行，新建一个对应的缓存
+        temp_items.computeIfAbsent(order_id, k -> new ArrayList<Item>());
+
+        if (item_changed.getObject_id()!= null) {  // 不是新建的item
+            for (Item i : temp_items.get(order_id)) {  // 遍历已经缓存的关联该订单的Item
+                if (i.getObject_id().equals(item_changed.getObject_id())) {  // 如果修改过的Item已经缓存过了
+                    temp_items.get(order_id).remove(i);  // 从缓存中删除
+                    break;  // 结束遍历
+                }
+            }
+        } else {  // 新建的Item 补充id属性
+            item_changed.setObject_id(UuidUtil.getUuid());
+        }
+        temp_items.get(order_id).add(item_changed);  // 缓存 前端修改的item
+
+
+        // 响应结果
+        ResultInfo info = new ResultInfo();
+        info.setFlag(true);
+        // 将 info 对象序列化为 json
+        ObjectMapper mapper = new ObjectMapper();
+        String json = mapper.writeValueAsString(info);
+        // 将 json 数据写回客户端
+        response.setContentType("application/json;charset=utf-8");
+        response.getWriter().write(json);
+    }
+
+    public void initTable(HttpServletRequest request, HttpServletResponse response) throws
+            ServletException, IOException {
+        System.out.println("PurchaseServlet：进入 初始化表格 后端");
+        String user_id = request.getParameter("user_id");
+        System.out.println("PurchaseServlet user_id="+user_id);
+        String purchaseDataList = "";
+        if (user_id != null)
+            purchaseDataList = updatePurchaseData(user_id);
+
+        ResultInfo info = new ResultInfo();
+        // 4. 响应结果
+        info.setFlag(true);
+        info.setData(purchaseDataList);
+        // 将 info 对象序列化为 json
+        ObjectMapper mapper = new ObjectMapper();
+        String json = mapper.writeValueAsString(info);
+        // 将 json 数据写回客户端
+        response.setContentType("application/json;charset=utf-8");
+        response.getWriter().write(json);
+    }
+
+    public String updatePurchaseData(String user_id) throws IOException {
+        System.out.println("进入updatePurchaseDataList");
+        List<get_or_borrow_Requisition> pr_list = service.searchTableByUser(user_id);
+        for (get_or_borrow_Requisition pr : pr_list) {
+            System.out.println(pr.getGet_or_borrow_order_id());
+        }
+        // 拼串
+        String json = "";
+        for (get_or_borrow_Requisition pr : pr_list) {
+            try {
+                json += writeValueAsString(pr);
+            } catch (JsonProcessingException e) {
+                e.printStackTrace();
+            }
+        }
+        json = json.replace("}", "},");
+        json = json.replaceFirst(".$","");  //去掉最后的逗号
+        json += "]";
+        StringBuffer buf = new StringBuffer();
+        buf.append(json).insert(0, "[");
+        json = buf.toString();  //拼串完成
+        System.out.println(json);
+
+//        String filename = "PurchaseData.txt";
+//        JsonUtil.writeJson(filename, json);  //写入Data.json文件
+        return json;
+    }
+
 }
Index: src/main/java/domain/get_or_borrow_Requisition.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package domain;\r\n\r\nimport java.io.Serializable;\r\nimport java.util.Date;\r\n\r\n/**\r\n *领用/借用申请实体类\r\n */\r\npublic class get_or_borrow_Requisition implements Serializable {\r\n    private String get_or_borrow_requisition_id;//领用/借用申请表id(PK)\r\n    private String get_or_borrow_order_id;//领用/借用申请物品清单id\r\n    private String applicant_user_id;//申领人(FK)\r\n    private String approval_user_id;//审批人(FK)\r\n    private String purpose;//领用用途\r\n    private Date requisition_date;//申请提交时间\r\n    private Date borrow_date;//借用/领用日期\r\n    private Date return_date;//归还日期\r\n    private int state;//申请表的状态（未提交、待审批、审批通过、审批未通过）\r\n    private int type;//类型（借用/领用）\r\n    private String approval_opinions;//审批意见\r\n    private Date approval_date;//审批的时间\r\n\r\n    /**\r\n     *无参构造方法\r\n     */\r\n    public get_or_borrow_Requisition() {}\r\n\r\n    /**\r\n     * 有参构方法\r\n     * @param get_or_borrow_requisition_id\r\n     * @param get_or_borrow_order_id\r\n     * @param applicant_user_id\r\n     * @param approval_user_id\r\n     * @param purpose\r\n     * @param state\r\n     * @param type\r\n     * @param borrow_date\r\n     * @param return_date\r\n     * @param requisition_date\r\n     * @param approval_opinions\r\n     * @param approval_date\r\n     */\r\n    public get_or_borrow_Requisition(String get_or_borrow_requisition_id, String get_or_borrow_order_id, String applicant_user_id, String approval_user_id, String purpose, Date requisition_date, Date borrow_date, Date return_date, int state, int type, String approval_opinions, Date approval_date) {\r\n        this.get_or_borrow_requisition_id = get_or_borrow_requisition_id;\r\n        this.get_or_borrow_order_id = get_or_borrow_order_id;\r\n        this.applicant_user_id = applicant_user_id;\r\n        this.approval_user_id = approval_user_id;\r\n        this.purpose = purpose;\r\n        this.requisition_date = requisition_date;\r\n        this.borrow_date = borrow_date;\r\n        this.return_date = return_date;\r\n        this.state = state;\r\n        this.type = type;\r\n        this.approval_opinions = approval_opinions;\r\n        this.approval_date = approval_date;\r\n    }\r\n\r\n    public String getGet_or_borrow_requisition_id() {\r\n        return get_or_borrow_requisition_id;\r\n    }\r\n\r\n    public void setGet_or_borrow_requisition_id(String get_or_borrow_requisition_id) {\r\n        this.get_or_borrow_requisition_id = get_or_borrow_requisition_id;\r\n    }\r\n\r\n    public String getGet_or_borrow_order_id() {\r\n        return get_or_borrow_order_id;\r\n    }\r\n\r\n    public void setGet_or_borrow_order_id(String get_or_borrow_order_id) {\r\n        this.get_or_borrow_order_id = get_or_borrow_order_id;\r\n    }\r\n\r\n    public String getApplicant_user_id() {\r\n        return applicant_user_id;\r\n    }\r\n\r\n    public void setApplicant_user_id(String applicant_user_id) {\r\n        this.applicant_user_id = applicant_user_id;\r\n    }\r\n\r\n    public String getApproval_user_id() {\r\n        return approval_user_id;\r\n    }\r\n\r\n    public void setApproval_user_id(String approval_user_id) {\r\n        this.approval_user_id = approval_user_id;\r\n    }\r\n\r\n    public String getPurpose() {\r\n        return purpose;\r\n    }\r\n\r\n    public void setPurpose(String purpose) {\r\n        this.purpose = purpose;\r\n    }\r\n\r\n    public Date getRequisition_date() {\r\n        return requisition_date;\r\n    }\r\n\r\n    public void setRequisition_date(Date requisition_date) {\r\n        this.requisition_date = requisition_date;\r\n    }\r\n\r\n    public Date getBorrow_date() {\r\n        return borrow_date;\r\n    }\r\n\r\n    public void setBorrow_date(Date borrow_date) {\r\n        this.borrow_date = borrow_date;\r\n    }\r\n\r\n    public Date getReturn_date() {\r\n        return return_date;\r\n    }\r\n\r\n    public void setReturn_date(Date return_date) {\r\n        this.return_date = return_date;\r\n    }\r\n\r\n    public int getState() {\r\n        return state;\r\n    }\r\n\r\n    public void setState(int state) {\r\n        this.state = state;\r\n    }\r\n\r\n    public int getType() {\r\n        return type;\r\n    }\r\n\r\n    public void setType(int type) {\r\n        this.type = type;\r\n    }\r\n\r\n    public String getApproval_opinions() {\r\n        return approval_opinions;\r\n    }\r\n\r\n    public void setApproval_opinions(String approval_opinions) {\r\n        this.approval_opinions = approval_opinions;\r\n    }\r\n\r\n    public Date getApproval_date() {\r\n        return approval_date;\r\n    }\r\n\r\n    public void setApproval_date(Date approval_date) {\r\n        this.approval_date = approval_date;\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/domain/get_or_borrow_Requisition.java b/src/main/java/domain/get_or_borrow_Requisition.java
--- a/src/main/java/domain/get_or_borrow_Requisition.java	(revision 7b26828b867c9f6627cd5d7a1bb0990c16716691)
+++ b/src/main/java/domain/get_or_borrow_Requisition.java	(date 1686231619839)
@@ -9,14 +9,14 @@
 public class get_or_borrow_Requisition implements Serializable {
     private String get_or_borrow_requisition_id;//领用/借用申请表id(PK)
     private String get_or_borrow_order_id;//领用/借用申请物品清单id
+    private int type;//类型（借用/领用）
     private String applicant_user_id;//申领人(FK)
-    private String approval_user_id;//审批人(FK)
     private String purpose;//领用用途
-    private Date requisition_date;//申请提交时间
     private Date borrow_date;//借用/领用日期
     private Date return_date;//归还日期
+    private Date requisition_date;//申请提交时间
     private int state;//申请表的状态（未提交、待审批、审批通过、审批未通过）
-    private int type;//类型（借用/领用）
+    private String approval_user_id;//审批人(FK)
     private String approval_opinions;//审批意见
     private Date approval_date;//审批的时间
 
Index: src/main/webapp/json/PurchaseListData.txt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>[{\r\n\t\"object_id\":\"de519b148ea349c7a2dd23c4c9815a8b\",\r\n\t\"name\":\"啊啊啊\",\r\n\t\"specification\":null,\r\n\t\"quantity\":0.0,\r\n\t\"unit\":null,\r\n\t\"classification\":null,\r\n\t\"price\":0.0,\r\n\t\"expiration_time\":null,\r\n\t\"lower_limit\":null,\r\n\t\"upper_limit\":null,\r\n\t\"notes\":\"啊啊啊啊啊啊啊啊啊\"\r\n}]
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/json/PurchaseListData.txt b/src/main/webapp/json/PurchaseListData.txt
--- a/src/main/webapp/json/PurchaseListData.txt	(revision 7b26828b867c9f6627cd5d7a1bb0990c16716691)
+++ b/src/main/webapp/json/PurchaseListData.txt	(date 1686225147502)
@@ -1,13 +1,26 @@
 [{
-	"object_id":"de519b148ea349c7a2dd23c4c9815a8b",
-	"name":"啊啊啊",
-	"specification":null,
-	"quantity":0.0,
-	"unit":null,
+	"object_id":"a7d99e8bc46c44b0896279e3c783a2d7",
+	"name":"好东西",
+	"specification":"100ml",
+	"quantity":1.0,
+	"unit":"瓶",
 	"classification":null,
-	"price":0.0,
+	"price":100.0,
 	"expiration_time":null,
-	"lower_limit":null,
-	"upper_limit":null,
-	"notes":"啊啊啊啊啊啊啊啊啊"
+	"lower_limit":100.0,
+	"upper_limit":10.0,
+	"notes":"可能是好东西"
+},
+{
+	"object_id":"b23bfb1a76b24b668a9e5c99f5a4926f",
+	"name":"坏东西",
+	"specification":"10g",
+	"quantity":3.0,
+	"unit":"块",
+	"classification":"化学试剂",
+	"price":178.0,
+	"expiration_time":null,
+	"lower_limit":30.0,
+	"upper_limit":2.0,
+	"notes":"可能是坏东西"
 }]
\ No newline at end of file
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"ArtifactsWorkspaceSettings\">\r\n    <artifacts-to-build>\r\n      <artifact name=\"travel:war\" />\r\n    </artifacts-to-build>\r\n  </component>\r\n  <component name=\"AutoImportSettings\">\r\n    <option name=\"autoReloadType\" value=\"SELECTIVE\" />\r\n  </component>\r\n  <component name=\"ChangeListManager\">\r\n    <list default=\"true\" id=\"4a6ee96f-f4a8-4e70-87f3-f76f4265a3ec\" name=\"Default Changelist\" comment=\"更新item的dao和service\">\r\n      <change beforePath=\"$PROJECT_DIR$/.idea/workspace.xml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/.idea/workspace.xml\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/src/main/java/dao/impl/get_or_borrow_dao_impl.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/main/java/dao/impl/get_or_borrow_dao_impl.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/src/main/java/dao/impl/object_entry_dao_impl.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/main/java/dao/impl/object_entry_dao_impl.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/src/main/java/dao/impl/purchase_requisition_dao_impl.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/main/java/dao/impl/purchase_requisition_dao_impl.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/src/main/java/dao/impl/waste_requisition_dao_impl.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/main/java/dao/impl/waste_requisition_dao_impl.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/src/main/java/service/impl/item_service_impl.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/main/java/service/impl/item_service_impl.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/src/main/java/service/impl/purchase_requisition_service_impl.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/main/java/service/impl/purchase_requisition_service_impl.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/src/main/java/web/servlet/PurchaseServlet.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/main/java/web/servlet/PurchaseServlet.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/src/main/webapp/form_purchase.html\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/main/webapp/form_purchase.html\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/src/main/webapp/json/PurchaseData.txt\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/main/webapp/json/PurchaseData.txt\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/src/main/webapp/json/PurchaseListData.txt\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/main/webapp/json/PurchaseListData.txt\" afterDir=\"false\" />\r\n    </list>\r\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\r\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\r\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\r\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\r\n  </component>\r\n  <component name=\"FileTemplateManagerImpl\">\r\n    <option name=\"RECENT_TEMPLATES\">\r\n      <list>\r\n        <option value=\"Class\" />\r\n        <option value=\"Interface\" />\r\n      </list>\r\n    </option>\r\n  </component>\r\n  <component name=\"Git.Settings\">\r\n    <option name=\"RECENT_BRANCH_BY_REPOSITORY\">\r\n      <map>\r\n        <entry key=\"$PROJECT_DIR$\" value=\"master\" />\r\n      </map>\r\n    </option>\r\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\r\n  </component>\r\n  <component name=\"GitSEFilterConfiguration\">\r\n    <file-type-list>\r\n      <filtered-out-file-type name=\"LOCAL_BRANCH\" />\r\n      <filtered-out-file-type name=\"REMOTE_BRANCH\" />\r\n      <filtered-out-file-type name=\"TAG\" />\r\n      <filtered-out-file-type name=\"COMMIT_BY_MESSAGE\" />\r\n    </file-type-list>\r\n  </component>\r\n  <component name=\"LogFilters\">\r\n    <option name=\"FILTER_ERRORS\" value=\"false\" />\r\n    <option name=\"FILTER_WARNINGS\" value=\"false\" />\r\n    <option name=\"FILTER_INFO\" value=\"true\" />\r\n    <option name=\"FILTER_DEBUG\" value=\"true\" />\r\n    <option name=\"CUSTOM_FILTER\" />\r\n  </component>\r\n  <component name=\"MarkdownSettingsMigration\">\r\n    <option name=\"stateVersion\" value=\"1\" />\r\n  </component>\r\n  <component name=\"ProjectId\" id=\"2Avt6bIjEb9LPH0DVMOFNxUmr9z\" />\r\n  <component name=\"ProjectLevelVcsManager\" settingsEditedManually=\"true\">\r\n    <ConfirmationsSetting value=\"2\" id=\"Add\" />\r\n  </component>\r\n  <component name=\"ProjectViewState\">\r\n    <option name=\"showLibraryContents\" value=\"true\" />\r\n  </component>\r\n  <component name=\"PropertiesComponent\">\r\n    <property name=\"ASKED_ADD_EXTERNAL_FILES\" value=\"true\" />\r\n    <property name=\"RunOnceActivity.OpenProjectViewOnStart\" value=\"true\" />\r\n    <property name=\"RunOnceActivity.ShowReadmeOnStart\" value=\"true\" />\r\n    <property name=\"SHARE_PROJECT_CONFIGURATION_FILES\" value=\"true\" />\r\n    <property name=\"WebServerToolWindowFactoryState\" value=\"false\" />\r\n    <property name=\"aspect.path.notification.shown\" value=\"true\" />\r\n    <property name=\"last_opened_file_path\" value=\"$PROJECT_DIR$\" />\r\n    <property name=\"node.js.detected.package.eslint\" value=\"true\" />\r\n    <property name=\"node.js.path.for.package.eslint\" value=\"project\" />\r\n    <property name=\"node.js.path.for.package.tslint\" value=\"project\" />\r\n    <property name=\"node.js.selected.package.eslint\" value=\"(autodetect)\" />\r\n    <property name=\"node.js.selected.package.tslint\" value=\"(autodetect)\" />\r\n    <property name=\"nodejs_package_manager_path\" value=\"npm\" />\r\n    <property name=\"project.structure.last.edited\" value=\"Modules\" />\r\n    <property name=\"project.structure.proportion\" value=\"0.17\" />\r\n    <property name=\"project.structure.side.proportion\" value=\"0.26412776\" />\r\n    <property name=\"settings.editor.selected.configurable\" value=\"MavenSettings\" />\r\n  </component>\r\n  <component name=\"RecentsManager\">\r\n    <key name=\"CopyFile.RECENT_KEYS\">\r\n      <recent name=\"D:\\develop\\Java\\ChemicalLabItemMS\\src\\main\\webapp\" />\r\n      <recent name=\"D:\\develop\\Java\\ChemicalLabItemMS\\src\\main\\webapp\\front-end-res-lib\" />\r\n      <recent name=\"D:\\develop\\Java\\ChemicalLabItemMS\\src\\main\\java\\service\\temp_service\" />\r\n    </key>\r\n    <key name=\"MoveFile.RECENT_KEYS\">\r\n      <recent name=\"D:\\develop\\Java\\ChemicalLabItemMS\\src\\main\\webapp\\html_temp\" />\r\n    </key>\r\n    <key name=\"MoveClassesOrPackagesDialog.RECENTS_KEY\">\r\n      <recent name=\"\" />\r\n    </key>\r\n    <key name=\"CopyClassDialog.RECENTS_KEY\">\r\n      <recent name=\"web\" />\r\n    </key>\r\n  </component>\r\n  <component name=\"RunManager\" selected=\"Maven.ChemicalLabItemMS\">\r\n    <configuration default=\"true\" type=\"ArquillianJUnit\" factoryName=\"\" nameIsGenerated=\"true\">\r\n      <option name=\"arquillianRunConfiguration\">\r\n        <value>\r\n          <option name=\"containerStateName\" value=\"\" />\r\n        </value>\r\n      </option>\r\n      <option name=\"TEST_OBJECT\" value=\"class\" />\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration name=\"ChemicalLabItemMS\" type=\"MavenRunConfiguration\" factoryName=\"Maven\">\r\n      <MavenSettings>\r\n        <option name=\"myGeneralSettings\" />\r\n        <option name=\"myRunnerSettings\" />\r\n        <option name=\"myRunnerParameters\">\r\n          <MavenRunnerParameters>\r\n            <option name=\"profiles\">\r\n              <set />\r\n            </option>\r\n            <option name=\"goals\">\r\n              <list>\r\n                <option value=\"tomcat7:run\" />\r\n              </list>\r\n            </option>\r\n            <option name=\"pomFileName\" />\r\n            <option name=\"profilesMap\">\r\n              <map />\r\n            </option>\r\n            <option name=\"resolveToWorkspace\" value=\"false\" />\r\n            <option name=\"workingDirPath\" value=\"$PROJECT_DIR$\" />\r\n          </MavenRunnerParameters>\r\n        </option>\r\n      </MavenSettings>\r\n      <method v=\"2\" />\r\n    </configuration>\r\n    <configuration name=\"Tomcat 8.5.24\" type=\"#com.intellij.j2ee.web.tomcat.TomcatRunConfigurationFactory\" factoryName=\"Local\" APPLICATION_SERVER_NAME=\"Tomcat 8.5.24\" ALTERNATIVE_JRE_ENABLED=\"false\" nameIsGenerated=\"true\">\r\n      <option name=\"UPDATING_POLICY\" value=\"restart-server\" />\r\n      <deployment>\r\n        <artifact name=\"travel:war\">\r\n          <settings>\r\n            <option name=\"CONTEXT_PATH\" value=\"/travel_war\" />\r\n          </settings>\r\n        </artifact>\r\n        <artifact name=\"ChemicalLabItemMS:war\">\r\n          <settings>\r\n            <option name=\"CONTEXT_PATH\" value=\"/ChemicalLabItemMS_war\" />\r\n          </settings>\r\n        </artifact>\r\n      </deployment>\r\n      <server-settings>\r\n        <option name=\"BASE_DIRECTORY_NAME\" value=\"0049ada1-20ae-4acc-ba0a-1e64ffc4502d\" />\r\n      </server-settings>\r\n      <predefined_log_file enabled=\"true\" id=\"Tomcat\" />\r\n      <predefined_log_file enabled=\"true\" id=\"Tomcat Catalina\" />\r\n      <predefined_log_file id=\"Tomcat Manager\" />\r\n      <predefined_log_file id=\"Tomcat Host Manager\" />\r\n      <predefined_log_file id=\"Tomcat Localhost Access\" />\r\n      <RunnerSettings RunnerId=\"Debug\">\r\n        <option name=\"DEBUG_PORT\" value=\"1237\" />\r\n      </RunnerSettings>\r\n      <ConfigurationWrapper VM_VAR=\"JAVA_OPTS\" RunnerId=\"Cover\">\r\n        <option name=\"USE_ENV_VARIABLES\" value=\"true\" />\r\n        <STARTUP>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </STARTUP>\r\n        <SHUTDOWN>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </SHUTDOWN>\r\n      </ConfigurationWrapper>\r\n      <ConfigurationWrapper VM_VAR=\"JAVA_OPTS\" RunnerId=\"Debug\">\r\n        <option name=\"USE_ENV_VARIABLES\" value=\"true\" />\r\n        <STARTUP>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </STARTUP>\r\n        <SHUTDOWN>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </SHUTDOWN>\r\n      </ConfigurationWrapper>\r\n      <ConfigurationWrapper VM_VAR=\"JAVA_OPTS\" RunnerId=\"Profile\">\r\n        <option name=\"USE_ENV_VARIABLES\" value=\"true\" />\r\n        <STARTUP>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </STARTUP>\r\n        <SHUTDOWN>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </SHUTDOWN>\r\n      </ConfigurationWrapper>\r\n      <ConfigurationWrapper VM_VAR=\"JAVA_OPTS\" RunnerId=\"Run\">\r\n        <option name=\"USE_ENV_VARIABLES\" value=\"true\" />\r\n        <STARTUP>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </STARTUP>\r\n        <SHUTDOWN>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </SHUTDOWN>\r\n      </ConfigurationWrapper>\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n        <option name=\"BuildArtifacts\" enabled=\"true\">\r\n          <artifact name=\"ChemicalLabItemMS:war\" />\r\n        </option>\r\n      </method>\r\n    </configuration>\r\n    <list>\r\n      <item itemvalue=\"Maven.ChemicalLabItemMS\" />\r\n      <item itemvalue=\"Tomcat Server.Tomcat 8.5.24\" />\r\n    </list>\r\n  </component>\r\n  <component name=\"SpellCheckerSettings\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" DefaultDictionary=\"application-level\" UseSingleDictionary=\"true\" transferred=\"true\" />\r\n  <component name=\"SvnConfiguration\">\r\n    <configuration />\r\n  </component>\r\n  <component name=\"TaskManager\">\r\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\r\n      <changelist id=\"4a6ee96f-f4a8-4e70-87f3-f76f4265a3ec\" name=\"Default Changelist\" comment=\"\" />\r\n      <created>1655901715645</created>\r\n      <option name=\"number\" value=\"Default\" />\r\n      <option name=\"presentableId\" value=\"Default\" />\r\n      <updated>1655901715645</updated>\r\n      <workItem from=\"1655901717854\" duration=\"450000\" />\r\n      <workItem from=\"1685427151825\" duration=\"1535000\" />\r\n      <workItem from=\"1685428706026\" duration=\"124000\" />\r\n      <workItem from=\"1685428833294\" duration=\"826000\" />\r\n      <workItem from=\"1685520782760\" duration=\"706000\" />\r\n      <workItem from=\"1685537381059\" duration=\"1334000\" />\r\n      <workItem from=\"1685540296469\" duration=\"811000\" />\r\n      <workItem from=\"1685599640376\" duration=\"132000\" />\r\n      <workItem from=\"1685599807762\" duration=\"1261000\" />\r\n      <workItem from=\"1685603422754\" duration=\"49000\" />\r\n      <workItem from=\"1685603474267\" duration=\"10000\" />\r\n      <workItem from=\"1685603485940\" duration=\"6000\" />\r\n      <workItem from=\"1685603502462\" duration=\"2399000\" />\r\n      <workItem from=\"1685674025238\" duration=\"1608000\" />\r\n      <workItem from=\"1685771307743\" duration=\"402000\" />\r\n      <workItem from=\"1685771714405\" duration=\"5544000\" />\r\n      <workItem from=\"1685777299983\" duration=\"306000\" />\r\n      <workItem from=\"1685897456684\" duration=\"1052000\" />\r\n      <workItem from=\"1685924081606\" duration=\"921000\" />\r\n      <workItem from=\"1685965736717\" duration=\"8365000\" />\r\n      <workItem from=\"1686020823650\" duration=\"2271000\" />\r\n      <workItem from=\"1686097290341\" duration=\"1965000\" />\r\n      <workItem from=\"1686103535919\" duration=\"1125000\" />\r\n      <workItem from=\"1686122288404\" duration=\"2228000\" />\r\n      <workItem from=\"1686124548099\" duration=\"13105000\" />\r\n      <workItem from=\"1686186044285\" duration=\"1925000\" />\r\n    </task>\r\n    <task id=\"LOCAL-00001\" summary=\"添加GoodsService及其实现，实体类Date-&gt;String\">\r\n      <created>1655902015448</created>\r\n      <option name=\"number\" value=\"00001\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00001\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1655902015448</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00002\" summary=\"更新了实体类的注释\">\r\n      <created>1685776134712</created>\r\n      <option name=\"number\" value=\"00002\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00002\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1685776134712</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00003\" summary=\"更新了实体类的注释\">\r\n      <created>1685777451475</created>\r\n      <option name=\"number\" value=\"00003\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00003\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1685777451475</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00004\" summary=\"更新了领用&amp;借用申请表的校验\">\r\n      <created>1685955280415</created>\r\n      <option name=\"number\" value=\"00004\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00004\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1685955280415</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00005\" summary=\"更新采购、领用dao层功能\">\r\n      <created>1686015910191</created>\r\n      <option name=\"number\" value=\"00005\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00005\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1686015910191</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00006\" summary=\"更新采购入库功能\">\r\n      <created>1686040539807</created>\r\n      <option name=\"number\" value=\"00006\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00006\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1686040539807</updated>\r\n    </task>\r\n    <option name=\"localTasksCounter\" value=\"7\" />\r\n    <servers />\r\n  </component>\r\n  <component name=\"TypeScriptGeneratedFilesManager\">\r\n    <option name=\"version\" value=\"3\" />\r\n  </component>\r\n  <component name=\"Vcs.Log.Tabs.Properties\">\r\n    <option name=\"TAB_STATES\">\r\n      <map>\r\n        <entry key=\"MAIN\">\r\n          <value>\r\n            <State />\r\n          </value>\r\n        </entry>\r\n      </map>\r\n    </option>\r\n    <option name=\"oldMeFiltersMigrated\" value=\"true\" />\r\n  </component>\r\n  <component name=\"VcsManagerConfiguration\">\r\n    <option name=\"ADD_EXTERNAL_FILES_SILENTLY\" value=\"true\" />\r\n    <MESSAGE value=\"添加GoodsService及其实现，实体类Date-&gt;String\" />\r\n    <MESSAGE value=\"更新了实体类的注释\" />\r\n    <MESSAGE value=\"更新了领用&amp;借用申请表的校验\" />\r\n    <MESSAGE value=\"更新采购、领用dao层功能\" />\r\n    <MESSAGE value=\"更新废弃物后端\" />\r\n    <MESSAGE value=\"更新 借用入库 功能\" />\r\n    <MESSAGE value=\"完善了前端申请表、入库表的页面，实现采购申请的数据部分插入\" />\r\n    <option name=\"LAST_COMMIT_MESSAGE\" value=\"完善了前端申请表、入库表的页面，实现采购申请的数据部分插入\" />\r\n  </component>\r\n  <component name=\"XSLT-Support.FileAssociations.UIState\">\r\n    <expand />\r\n    <select />\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	(revision 7b26828b867c9f6627cd5d7a1bb0990c16716691)
+++ b/.idea/workspace.xml	(date 1686236773714)
@@ -9,16 +9,14 @@
     <option name="autoReloadType" value="SELECTIVE" />
   </component>
   <component name="ChangeListManager">
-    <list default="true" id="4a6ee96f-f4a8-4e70-87f3-f76f4265a3ec" name="Default Changelist" comment="更新item的dao和service">
+    <list default="true" id="4a6ee96f-f4a8-4e70-87f3-f76f4265a3ec" name="Default Changelist" comment="采购清单ok">
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/src/main/java/dao/impl/get_or_borrow_dao_impl.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/dao/impl/get_or_borrow_dao_impl.java" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/src/main/java/dao/impl/object_entry_dao_impl.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/dao/impl/object_entry_dao_impl.java" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/src/main/java/dao/impl/purchase_requisition_dao_impl.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/dao/impl/purchase_requisition_dao_impl.java" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/src/main/java/dao/impl/waste_requisition_dao_impl.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/dao/impl/waste_requisition_dao_impl.java" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/src/main/java/service/impl/item_service_impl.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/service/impl/item_service_impl.java" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/src/main/java/service/impl/purchase_requisition_service_impl.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/service/impl/purchase_requisition_service_impl.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/java/domain/get_or_borrow_Requisition.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/domain/get_or_borrow_Requisition.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/java/service/impl/get_or_borrow_service_impl.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/service/impl/get_or_borrow_service_impl.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/java/web/servlet/GetOrBorrowServlet.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/web/servlet/GetOrBorrowServlet.java" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/src/main/java/web/servlet/PurchaseServlet.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/web/servlet/PurchaseServlet.java" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/src/main/webapp/form_purchase.html" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/webapp/form_purchase.html" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/webapp/form_use_or_borrow.html" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/webapp/form_use_or_borrow.html" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/src/main/webapp/json/PurchaseData.txt" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/webapp/json/PurchaseData.txt" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/src/main/webapp/json/PurchaseListData.txt" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/webapp/json/PurchaseListData.txt" afterDir="false" />
     </list>
@@ -317,7 +315,14 @@
       <option name="project" value="LOCAL" />
       <updated>1686040539807</updated>
     </task>
-    <option name="localTasksCounter" value="7" />
+    <task id="LOCAL-00007" summary="采购清单ok">
+      <created>1686217696437</created>
+      <option name="number" value="00007" />
+      <option name="presentableId" value="LOCAL-00007" />
+      <option name="project" value="LOCAL" />
+      <updated>1686217696437</updated>
+    </task>
+    <option name="localTasksCounter" value="8" />
     <servers />
   </component>
   <component name="TypeScriptGeneratedFilesManager">
@@ -344,7 +349,8 @@
     <MESSAGE value="更新废弃物后端" />
     <MESSAGE value="更新 借用入库 功能" />
     <MESSAGE value="完善了前端申请表、入库表的页面，实现采购申请的数据部分插入" />
-    <option name="LAST_COMMIT_MESSAGE" value="完善了前端申请表、入库表的页面，实现采购申请的数据部分插入" />
+    <MESSAGE value="采购清单ok" />
+    <option name="LAST_COMMIT_MESSAGE" value="采购清单ok" />
   </component>
   <component name="XSLT-Support.FileAssociations.UIState">
     <expand />
Index: src/main/webapp/json/PurchaseData.txt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>[{\r\n\t\"purchase_requisition_id\":\"0cd5b2266a304efca4bec0ef22e9769a\",\r\n\t\"purchase_order_id\":\"c5f25227bab24b3da35eb71fdf3ebc0e\",\r\n\t\"requisition_user_id\":\"0001\",\r\n\t\"purpose\":\"搞99台设备\",\r\n\t\"requisition_date\":1686237339000,\r\n\t\"state\":0,\r\n\t\"approval_user_id\":\"0005\",\r\n\t\"approval_opinions\":\"设备好搞，朕允了\",\r\n\t\"approval_date\":null\r\n},\r\n{\r\n\t\"purchase_requisition_id\":\"195ecd93bb1849b4b885195b5b9b6518\",\r\n\t\"purchase_order_id\":\"047025b7b1dd4261a28748d48be18cff\",\r\n\t\"requisition_user_id\":\"0001\",\r\n\t\"purpose\":\"搞1台设备\",\r\n\t\"requisition_date\":1686184662000,\r\n\t\"state\":0,\r\n\t\"approval_user_id\":\"0005\",\r\n\t\"approval_opinions\":\"设备好搞，朕允了\",\r\n\t\"approval_date\":null\r\n},\r\n{\r\n\t\"purchase_requisition_id\":\"474266a2b5ed451bb9713ded8e866419\",\r\n\t\"purchase_order_id\":\"5310cb92e614409d8ad2caadd091fd3d\",\r\n\t\"requisition_user_id\":\"0001\",\r\n\t\"purpose\":\"搞一只猫猫\",\r\n\t\"requisition_date\":1686238299000,\r\n\t\"state\":0,\r\n\t\"approval_user_id\":null,\r\n\t\"approval_opinions\":null,\r\n\t\"approval_date\":null\r\n},\r\n{\r\n\t\"purchase_requisition_id\":\"c7852649d2c248c5b272430cb5b485ec\",\r\n\t\"purchase_order_id\":\"b47fedd1218042b1b0013dbedcff94d5\",\r\n\t\"requisition_user_id\":\"0001\",\r\n\t\"purpose\":null,\r\n\t\"requisition_date\":1686239445000,\r\n\t\"state\":0,\r\n\t\"approval_user_id\":null,\r\n\t\"approval_opinions\":null,\r\n\t\"approval_date\":null\r\n},\r\n{\r\n\t\"purchase_requisition_id\":\"PR-0000001\",\r\n\t\"purchase_order_id\":\"PRO-0000001\",\r\n\t\"requisition_user_id\":\"0001\",\r\n\t\"purpose\":\"搞100台设备\",\r\n\t\"requisition_date\":1686187735000,\r\n\t\"state\":0,\r\n\t\"approval_user_id\":\"0005\",\r\n\t\"approval_opinions\":\"设备好搞，朕允了\",\r\n\t\"approval_date\":1686187735000\r\n},\r\n{\r\n\t\"purchase_requisition_id\":\"PR-0000002\",\r\n\t\"purchase_order_id\":\"PRO-0000002\",\r\n\t\"requisition_user_id\":\"0001\",\r\n\t\"purpose\":\"搞2台设备\",\r\n\t\"requisition_date\":null,\r\n\t\"state\":0,\r\n\t\"approval_user_id\":\"0005\",\r\n\t\"approval_opinions\":\"设备好搞，朕允了\",\r\n\t\"approval_date\":null\r\n},\r\n{\r\n\t\"purchase_requisition_id\":\"PR-0000003\",\r\n\t\"purchase_order_id\":\"PRO-0000003\",\r\n\t\"requisition_user_id\":\"0001\",\r\n\t\"purpose\":\"搞3台设备\",\r\n\t\"requisition_date\":1684404672000,\r\n\t\"state\":0,\r\n\t\"approval_user_id\":\"0005\",\r\n\t\"approval_opinions\":\"设备好搞，朕允了\",\r\n\t\"approval_date\":null\r\n},\r\n{\r\n\t\"purchase_requisition_id\":\"PR-0000004\",\r\n\t\"purchase_order_id\":\"PRO-0000004\",\r\n\t\"requisition_user_id\":\"0001\",\r\n\t\"purpose\":\"搞4台设备\",\r\n\t\"requisition_date\":1684480334000,\r\n\t\"state\":0,\r\n\t\"approval_user_id\":\"0005\",\r\n\t\"approval_opinions\":\"设备好搞，朕允了\",\r\n\t\"approval_date\":1684570394000\r\n},\r\n{\r\n\t\"purchase_requisition_id\":\"PR-0000005\",\r\n\t\"purchase_order_id\":\"PRO-0000005\",\r\n\t\"requisition_user_id\":\"0001\",\r\n\t\"purpose\":\"搞5台设备\",\r\n\t\"requisition_date\":1685599566000,\r\n\t\"state\":0,\r\n\t\"approval_user_id\":\"0005\",\r\n\t\"approval_opinions\":\"设备好搞，朕允了\",\r\n\t\"approval_date\":1685617871000\r\n}]
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/json/PurchaseData.txt b/src/main/webapp/json/PurchaseData.txt
--- a/src/main/webapp/json/PurchaseData.txt	(revision 7b26828b867c9f6627cd5d7a1bb0990c16716691)
+++ b/src/main/webapp/json/PurchaseData.txt	(date 1686224532666)
@@ -1,57 +1,13 @@
 [{
-	"purchase_requisition_id":"0cd5b2266a304efca4bec0ef22e9769a",
-	"purchase_order_id":"c5f25227bab24b3da35eb71fdf3ebc0e",
-	"requisition_user_id":"0001",
-	"purpose":"搞99台设备",
-	"requisition_date":1686237339000,
-	"state":0,
-	"approval_user_id":"0005",
-	"approval_opinions":"设备好搞，朕允了",
-	"approval_date":null
-},
-{
-	"purchase_requisition_id":"195ecd93bb1849b4b885195b5b9b6518",
-	"purchase_order_id":"047025b7b1dd4261a28748d48be18cff",
-	"requisition_user_id":"0001",
-	"purpose":"搞1台设备",
-	"requisition_date":1686184662000,
-	"state":0,
-	"approval_user_id":"0005",
-	"approval_opinions":"设备好搞，朕允了",
-	"approval_date":null
-},
-{
-	"purchase_requisition_id":"474266a2b5ed451bb9713ded8e866419",
-	"purchase_order_id":"5310cb92e614409d8ad2caadd091fd3d",
-	"requisition_user_id":"0001",
-	"purpose":"搞一只猫猫",
-	"requisition_date":1686238299000,
-	"state":0,
-	"approval_user_id":null,
-	"approval_opinions":null,
-	"approval_date":null
-},
-{
-	"purchase_requisition_id":"c7852649d2c248c5b272430cb5b485ec",
-	"purchase_order_id":"b47fedd1218042b1b0013dbedcff94d5",
-	"requisition_user_id":"0001",
-	"purpose":null,
-	"requisition_date":1686239445000,
-	"state":0,
-	"approval_user_id":null,
-	"approval_opinions":null,
-	"approval_date":null
-},
-{
 	"purchase_requisition_id":"PR-0000001",
 	"purchase_order_id":"PRO-0000001",
 	"requisition_user_id":"0001",
-	"purpose":"搞100台设备",
-	"requisition_date":1686187735000,
+	"purpose":"搞10台设备",
+	"requisition_date":1686216535000,
 	"state":0,
 	"approval_user_id":"0005",
 	"approval_opinions":"设备好搞，朕允了",
-	"approval_date":1686187735000
+	"approval_date":1686216535000
 },
 {
 	"purchase_requisition_id":"PR-0000002",
