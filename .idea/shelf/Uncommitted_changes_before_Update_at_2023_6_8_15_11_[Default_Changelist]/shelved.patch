Index: src/main/java/web/servlet/PurchaseServlet.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package web.servlet;\r\n\r\nimport com.fasterxml.jackson.core.JsonProcessingException;\r\nimport com.fasterxml.jackson.databind.ObjectMapper;\r\nimport domain.*;\r\nimport org.apache.commons.beanutils.BeanUtils;\r\nimport service.impl.item_service_impl;\r\nimport service.impl.order_service_impl;\r\nimport service.impl.purchase_requisition_service_impl;\r\nimport service.item_service;\r\nimport service.order_service;\r\nimport service.purchase_requisition_service;\r\nimport util.JsonUtil;\r\nimport web.servlet.BaseServlet;\r\n\r\nimport javax.servlet.ServletException;\r\nimport javax.servlet.annotation.WebServlet;\r\nimport javax.servlet.http.HttpServletRequest;\r\nimport javax.servlet.http.HttpServletResponse;\r\nimport java.io.IOException;\r\nimport java.lang.reflect.InvocationTargetException;\r\nimport java.util.ArrayList;\r\nimport java.util.Arrays;\r\nimport java.util.List;\r\nimport java.util.Map;\r\n\r\n\r\n@WebServlet(\"/purchase/*\")\r\npublic class PurchaseServlet extends BaseServlet {\r\n\r\n    private purchase_requisition_service service = new purchase_requisition_service_impl();\r\n    private order_service o_service = new order_service_impl();\r\n    private item_service i_service = new item_service_impl();\r\n\r\n    public void createOrUpdateItems(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\r\n        System.out.println(\"PurchaseServlet：进入 采购申请 后端\");\r\n        //1.获取数据（领用申请表基本信息 + 领用申请物品清单）\r\n        Map<String, String[]> map = request.getParameterMap(); //获取前端数据，考虑分两次传输 申请表信息和物品清单\r\n        for (Map.Entry<String, String[]> entry : map.entrySet()) {\r\n            System.out.println(\"key = \" + entry.getKey() + \", value = \" + Arrays.toString(entry.getValue()));\r\n        }\r\n        //2.封装对象\r\n        Purchase_Requisition purchase_requisition = new Purchase_Requisition();\r\n        try {\r\n            BeanUtils.populate(purchase_requisition, map);\r\n        } catch (IllegalAccessException | InvocationTargetException e) {\r\n            e.printStackTrace();\r\n        }\r\n\r\n        purchase_requisition.print();  // 调试，显示前端传回的数据\r\n\r\n        // TODO: 前端表格里的物品清单数据还没传进来\r\n        List<Object_Entry> object_entries = new ArrayList<>();\r\n        template_order to = new template_order(purchase_requisition, object_entries);\r\n        service.createOrUpdate(to);\r\n        ResultInfo info = new ResultInfo();\r\n        // 4. 响应结果\r\n        info.setFlag(true);\r\n        // 将 info 对象序列化为 json\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        String json = mapper.writeValueAsString(info);\r\n        // 将 json 数据写回客户端\r\n        response.setContentType(\"application/json;charset=utf-8\");\r\n        response.getWriter().write(json);\r\n    }\r\n\r\n\r\n    public void deleteTable(HttpServletRequest request, HttpServletResponse response) throws\r\n            ServletException, IOException {\r\n        // 从前端获取 待删除申请表行的 tableId\r\n        String tableId = request.getParameter(\"tableId\");\r\n        // 调用service删除\r\n        service.deleteTable(tableId);\r\n        // TODO: 更新前端表格页面，这个好像不需要做，前端会自动删除（加个\"确认删除\"的弹窗）\r\n        //  只需要把tableId传给后端即可\r\n\r\n    }\r\n\r\n    public void initTable(HttpServletRequest request, HttpServletResponse response) throws\r\n            ServletException, IOException {\r\n        System.out.println(\"PurchaseServlet：进入 初始化表格 后端\");\r\n        String user_id = request.getParameter(\"user_id\");\r\n        System.out.println(\"PurchaseServlet user_id=\"+user_id);\r\n        String purchaseDataList = \"\";\r\n        if (user_id != null)\r\n            purchaseDataList = updatePurchaseData(user_id);\r\n\r\n        ResultInfo info = new ResultInfo();\r\n        // 4. 响应结果\r\n        info.setFlag(true);\r\n        info.setData(purchaseDataList);\r\n        // 将 info 对象序列化为 json\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        String json = mapper.writeValueAsString(info);\r\n        // 将 json 数据写回客户端\r\n        response.setContentType(\"application/json;charset=utf-8\");\r\n        response.getWriter().write(json);\r\n    }\r\n\r\n\r\n    public String updatePurchaseData(String user_id) throws IOException {\r\n        System.out.println(\"进入updatePurchaseDataList\");\r\n        List<Purchase_Requisition> pr_list = service.searchTableByUser(user_id);\r\n        for (Purchase_Requisition pr : pr_list) {\r\n            System.out.println(pr.getPurchase_requisition_id());\r\n        }\r\n        // 拼串\r\n        String json = \"\";\r\n        for (Purchase_Requisition pr : pr_list) {\r\n            try {\r\n                json += writeValueAsString(pr);\r\n            } catch (JsonProcessingException e) {\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n        json = json.replace(\"}\", \"},\");\r\n        json = json.replaceFirst(\".$\",\"\");  //去掉最后的逗号\r\n        json += \"]\";\r\n        StringBuffer buf = new StringBuffer();\r\n        buf.append(json).insert(0, \"[\");\r\n        json = buf.toString();  //拼串完成\r\n        System.out.println(json);\r\n\r\n        String filename = \"PurchaseData.txt\";\r\n        JsonUtil.writeJson(filename, json);  //写入Data.json文件\r\n        return json;\r\n    }\r\n\r\n\r\n    // 初始化 物品清单列表\r\n    public void initListTable(HttpServletRequest request, HttpServletResponse response) throws\r\n            ServletException, IOException {\r\n        System.out.println(\"PurchaseServlet：进入 初始化物品清单弹窗表格 后端\");\r\n        String order_id = request.getParameter(\"order_id\");\r\n        System.out.println(\"PurchaseServlet order_id=\"+order_id);\r\n        String purchaseDataList = \"\";\r\n        if (order_id != null)\r\n            purchaseDataList = updatePurchaseListData(order_id);\r\n\r\n\r\n        ResultInfo info = new ResultInfo();\r\n        // 4. 响应结果\r\n        info.setFlag(true);\r\n        info.setData(purchaseDataList);\r\n        // 将 info 对象序列化为 json\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        String json = mapper.writeValueAsString(info);\r\n        // 将 json 数据写回客户端\r\n        response.setContentType(\"application/json;charset=utf-8\");\r\n        response.getWriter().write(json);\r\n    }\r\n\r\n    public String updatePurchaseListData(String order_id) throws IOException {\r\n        System.out.println(\"更新 物品清单列表\"+order_id);\r\n\r\n        // 获取物品清单的 全部物品行\r\n        List<Object_Entry> oe_list = o_service.search(order_id);\r\n\r\n        // 根据 order_id 查找 物品信息\r\n        List<Item> items = new ArrayList<>();\r\n        for (Object_Entry oe : oe_list) {\r\n            System.out.println(\"物品id=\"+oe.getObject_id());\r\n            Item item = i_service.search(oe.getObject_id());  // 获取物品信息\r\n            item.setQuantity(oe.getQuantity());  // 修改数量（采购物品的数量在object_entry中）\r\n            item.print();  // 显示对象信息\r\n            items.add(item);  //添加进 物品信息表\r\n        }\r\n\r\n        // 拼串\r\n        String json = \"\";\r\n        for (Item i : items) {\r\n            try {\r\n                json += writeValueAsString(i);\r\n            } catch (JsonProcessingException e) {\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n        json = json.replace(\"}\", \"},\");\r\n        json = json.replaceFirst(\".$\",\"\");  //去掉最后的逗号\r\n        json += \"]\";\r\n        StringBuffer buf = new StringBuffer();\r\n        buf.append(json).insert(0, \"[\");\r\n        json = buf.toString();  //拼串完成\r\n        System.out.println(\"物品信息json=\"+json);\r\n        String filename = \"PurchaseListData.txt\";\r\n        JsonUtil.writeJson(filename, json);  //写入Data.json文件\r\n        return json;\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/web/servlet/PurchaseServlet.java b/src/main/java/web/servlet/PurchaseServlet.java
--- a/src/main/java/web/servlet/PurchaseServlet.java	(revision a610f63d315be699b1ca789b976862a9aec61980)
+++ b/src/main/java/web/servlet/PurchaseServlet.java	(date 1686208305832)
@@ -4,6 +4,9 @@
 import com.fasterxml.jackson.databind.ObjectMapper;
 import domain.*;
 import org.apache.commons.beanutils.BeanUtils;
+import org.apache.commons.beanutils.ConvertUtils;
+import org.apache.commons.beanutils.Converter;
+import org.apache.commons.beanutils.converters.DateConverter;
 import service.impl.item_service_impl;
 import service.impl.order_service_impl;
 import service.impl.purchase_requisition_service_impl;
@@ -19,10 +22,9 @@
 import javax.servlet.http.HttpServletResponse;
 import java.io.IOException;
 import java.lang.reflect.InvocationTargetException;
-import java.util.ArrayList;
-import java.util.Arrays;
-import java.util.List;
-import java.util.Map;
+import java.text.ParseException;
+import java.text.SimpleDateFormat;
+import java.util.*;
 
 
 @WebServlet("/purchase/*")
@@ -35,7 +37,32 @@
     public void createOrUpdateItems(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
         System.out.println("PurchaseServlet：进入 采购申请 后端");
         //1.获取数据（领用申请表基本信息 + 领用申请物品清单）
+        User user = new User();
+        ConvertUtils.register(new Converter() {
+            @Override
+            public Object convert(Class aClass, Object o) {
+                // 如果字符串为null，则返回null
+                if(o == null) return null;
+                // 如果字符串为空格，则返回null
+                String str = (String) o;
+                if(str.trim().equals("")) return null;
+                // 将字符串转为Date类型
+                SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
+                try {
+                    return formatter.parse(o.toString());
+                } catch (ParseException e) {
+                    e.printStackTrace();
+                }
+                return new Date();
+            }
+        }, Date.class);
+
+        Map<String, String[]> parameterMap = request.getParameterMap();
+        // 省略了异常处理代码
+        BeanUtils.populate(user,parameterMap);
+
         Map<String, String[]> map = request.getParameterMap(); //获取前端数据，考虑分两次传输 申请表信息和物品清单
+
         for (Map.Entry<String, String[]> entry : map.entrySet()) {
             System.out.println("key = " + entry.getKey() + ", value = " + Arrays.toString(entry.getValue()));
         }
Index: src/main/webapp/form_purchase.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"utf-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><meta name=\"renderer\" content=\"webkit\">\r\n\r\n    <title>基本表单</title>\r\n    <meta name=\"keywords\" >\r\n    <meta name=\"description\" >\r\n    <link href=\"css/bootstrap.min.css?v=3.4.0\" rel=\"stylesheet\">\r\n    <link href=\"font-awesome/css/font-awesome.css?v=4.3.0\" rel=\"stylesheet\">\r\n    <link href=\"css/plugins/iCheck/custom.css\" rel=\"stylesheet\">\r\n    <link href=\"css/animate.css\" rel=\"stylesheet\">\r\n    <link href=\"css/style.css?v=2.2.0\" rel=\"stylesheet\">\r\n</head>\r\n<body>\r\n<!--<button type=\"button\" id=\"batch-edit-btn\">批量编辑</button>-->\r\n<!--<button type=\"button\" id=\"batch-save-btn\">批量保存</button>-->\r\n<!--<table id=\"table\" class=\"display\" width=\"100%\"></table>-->\r\n<div id=\"wrapper\">\r\n    <!-- 侧边栏 -->\r\n    <div id=\"left_sidebar\"></div>\r\n\r\n    <div id=\"page-wrapper\" class=\"gray-bg dashbard-1\">\r\n        <!--头部-->\r\n        <div id=\"header\"></div>\r\n        <div class=\"row wrapper border-bottom white-bg page-heading\">\r\n            <div class=\"col-lg-10\">\r\n                <h2>采购申请</h2>\r\n            </div>\r\n            <div class=\"col-lg-2\"></div>\r\n        </div>\r\n        <div class=\"wrapper wrapper-content animated fadeInRight\">\r\n            <!--                所有表单元素  -->\r\n            <div class=\"row\">\r\n                <div class=\"col-lg-12\">\r\n                    <div class=\"ibox float-e-margins\">\r\n                        <div class=\"ibox-title\">\r\n                            <h5>采购申请表</h5>\r\n                            <div class=\"ibox-tools\">\r\n                                <a class=\"collapse-link\">\r\n                                    <i class=\"fa fa-chevron-up\"></i>\r\n                                </a>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"ibox-content\">\r\n                            <form method=\"get\" class=\"form-horizontal\">\r\n\r\n                                <div class=\"row\">\r\n                                    <div class=\"col-lg-12\">\r\n                                        <div class=\"ibox float-e-margins\">\r\n\r\n                                            <div class=\"ibox-content\">\r\n                                                <div class=\"\">\r\n                                                    <a onclick=\"fnClickAddRow();\" href=\"javascript:void(0);\" class=\"btn btn-primary \">新建采购申请</a>\r\n                                                    <button type=\"button\" id=\"batch-edit-btn\" class=\"btn btn-primary \">批量编辑</button>\r\n                                                    <button type=\"button\" id=\"batch-save-btn\" class=\"btn btn-primary \">批量保存</button>\r\n                                                </div>\r\n\r\n\r\n                                                <table id=\"table\" class=\"datatable table table-striped table-bordered table-hover\">\r\n\r\n                                                </table>\r\n\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </form>\r\n                        </div>\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- 数据表单弹窗 -->\r\n        <form method=\"post\" class=\"form-horizontal\" role=\"form\" id=\"updateGoodsForm\">\r\n            <div class=\"modal fade\" id=\"updateModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"updateModalLabel\" aria-hidden=\"true\">\r\n                <div class=\"modal-dialog\" style=\"width: 1400px\">\r\n                    <div class=\"modal-content\">\r\n                        <div class=\"modal-header\">\r\n                            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">\r\n                                ×\r\n                            </button>\r\n                            <h4 class=\"modal-title\" id=\"updateModalLabel\">\r\n                                物品清单\r\n                            </h4>\r\n                        </div>\r\n\r\n                        <div class=\"form-group\">\r\n                            <div class=\"row\">\r\n                                <div class=\"col-lg-12\">\r\n                                    <div class=\"ibox float-e-margins\">\r\n                                        <div class=\"ibox-content\">\r\n\r\n                                            <div class=\"\">\r\n                                                <button onclick=\"listfnClickAddRow();\" href=\"javascript:void(0);\" class=\"list-top-btn btn btn-primary \">添加物品</button>\r\n                                                <button type=\"button\" id=\"list-batch-edit-btn\" class=\"list-top-btn btn btn-primary \">批量编辑</button>\r\n                                                <button type=\"button\" id=\"list-batch-save-btn\" class=\"list-top-btn btn btn-primary \">批量保存</button>\r\n                                            </div>\r\n\r\n                                            <table id=listTable width=\"100%\" class=\"table table-striped table-bordered table-hover dataTables-example\">\r\n\r\n                                            </table>\r\n\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>  <!--   end modal-body  -->\r\n                </div><!-- /.modal-content -->\r\n            </div><!-- /.modal -->\r\n        </form>\r\n    </div>\r\n</div>\r\n\r\n\r\n\r\n\r\n<!-- Mainly scripts -->\r\n<script src=\"js/jquery-2.1.1.min.js\"></script>\r\n<script src=\"js/bootstrap.min.js?v=3.4.0\"></script>\r\n<script src=\"js/plugins/metisMenu/jquery.metisMenu.js\"></script>\r\n<script src=\"js/plugins/slimscroll/jquery.slimscroll.min.js\"></script>\r\n\r\n<!-- Custom and plugin javascript -->\r\n<script src=\"js/hplus.js?v=2.2.0\"></script>\r\n<script src=\"js/plugins/pace/pace.min.js\"></script>\r\n\r\n<!-- iCheck -->\r\n<script src=\"js/plugins/iCheck/icheck.min.js\"></script>\r\n\r\n<!--&lt;!&ndash;引入JavaScript&ndash;&gt;-->\r\n<script type=\"text/javascript\" language=\"javascript\" src=\"https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js\"></script>\r\n\r\n\r\n<!-- Data Tables -->\r\n<script src=\"js/plugins/dataTables/jquery.dataTables.js\"></script>\r\n<script src=\"js/plugins/dataTables/dataTables.bootstrap.js\"></script>\r\n\r\n<!--&lt;!&ndash;引入css&ndash;&gt;-->\r\n<!--<link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.datatables.net/1.10.15/css/jquery.dataTables.min.css\">-->\r\n\r\n<!--&lt;!&ndash;&lt;!&ndash;引入JavaScript&ndash;&gt;&ndash;&gt;-->\r\n<!--<script type=\"text/javascript\" language=\"javascript\" src=\"//code.jquery.com/jquery-1.12.4.js\"></script>-->\r\n<!--<script type=\"text/javascript\" language=\"javascript\" src=\"https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js\"></script>-->\r\n\r\n\r\n\r\n<!--初始化代码-->\r\n<!-- 导入header -->\r\n<script>\r\n    $(function () {\r\n        $.get(\"header.html\",function (data) {\r\n            $(\"#header\").html(data);\r\n        });\r\n    });\r\n</script>\r\n<script>\r\n    $(function () {\r\n        $.get(\"left_sidebar.html\",function (data) {\r\n            $(\"#left_sidebar\").html(data);\r\n        });\r\n    });\r\n</script>\r\n<script>\r\n    var temp_user_id;\r\n    var temp_data;\r\n\r\n    console.log(\"--flag-1-\");\r\n\r\n    $.ajax({\r\n        async: false,\r\n        type : \"post\",\r\n        url : \"user/findOne\",\r\n        success : function(user) {\r\n            console.log(\"--flag-findOne-\");\r\n            temp_user_id = user.user_id;\r\n            console.log(\"user.user_id\"+user.user_id);\r\n        }\r\n    });\r\n    // 初始化，获取首页表格数据\r\n    $.ajax({\r\n        async: false,\r\n        data: {user_id: temp_user_id},\r\n        type : \"post\",\r\n        url : \"purchase/initTable\",\r\n        success : function(data) {\r\n            console.log(\"--flag-inittable-\");\r\n            temp_data=data.data;\r\n        }\r\n    });\r\n\r\n    function json2Array(jsonData, list_or_not) {\r\n        var jsonsString = jsonData.slice(1, jsonData.length - 1);\r\n        var jsonStrings = jsonsString.split(\"},\");\r\n        var length = jsonStrings.length;\r\n        var jsons = [];\r\n        for (var i = 0; i !== length-1; ++i) {\r\n            jsonStrings[i] += '}';\r\n        }\r\n        var source = [[]];\r\n        for (var i = 0; i !== length; ++i) {\r\n            //console.log(\"$\"+jsonStrings[i]);\r\n            jsons[i] = eval('(' + jsonStrings[i] + ')');\r\n            var data = [];\r\n            for(var key in jsons[i]) {\r\n                if(i === 0) {\r\n                    source[0].push(key);\r\n                }\r\n                console.log(\"i=\"+i+\"|key=\"+key+\"|json[i,key]=\"+jsons[i][key]);\r\n                if(!list_or_not || key !== \"object_id\" ) {\r\n                    data.push(jsons[i][key]);\r\n                } else {\r\n                    console.log(\"跳过在执行一次\")\r\n                }\r\n            }\r\n            source.push(data);\r\n        }\r\n        return source.slice(1); //删除第1行\r\n    }\r\n    //console.log(\"temp_data=\\n\"+temp_data);\r\n    temp_data = json2Array(temp_data, false)\r\n\r\n    const dataSets = [];  //初始化物品清单数据源\r\n    //console.log(\"temp_data1=\\n\"+temp_data);\r\n    $(document).ready(function() {\r\n        $(function(){\r\n            var table = $('#table').DataTable({\r\n                retrieve: true,\r\n                data:temp_data,\r\n                columns:[\r\n                    {\r\n                        'field': \"purchase_requisition_id\",\r\n                        'title': '采购申请表编号',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"purchase_order_id\",\r\n                        'title': '采购物品清单编号',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"requisition_user_id\",\r\n                        'title': '申请人',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"purpose\",\r\n                        'title': '采购用途',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"requisition_date\",\r\n                        'title': '申请提交日期',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"state\",\r\n                        'title': '申请当前状态',\r\n                        'defaultContent' : \"0\"\r\n                    }, {\r\n                        'field': \"approval_user_id\",\r\n                        'title': '审批人',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"approval_opinions\",\r\n                        'title': '审批意见',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        'field': \"approval_date\",\r\n                        'title': '审批日期',\r\n                        'defaultContent' : \"\"\r\n                    }, {\r\n                        field: \"operate\",\r\n                        sTitle: '操作',\r\n                        sDefaultContent : \"<button class='submit-btn btn btn-primary btn-xs' type='button' >提交</button>\"+\r\n                            \"<button class='edit-btn btn btn-primary btn-xs' type='button' style='margin-left: 10px'>编辑</button>\"  +\r\n                        \"<button class='list-btn btn btn-primary btn-xs' type='button' style='margin-left: 10px'>物品清单</button>\"+\r\n                            \"<button class='delete btn btn-default btn-xs' style='margin-left: 10px'>删除</button>\",\r\n                        sClass: 'text-center',\r\n                        \"data\" : null,\r\n                        // \"render\" : function(data, type,row) {\r\n                        //     var id = '\"' + row.id + '\"';\r\n                        //     var html = \"<a href='javascript:void(0);'  class='btn btn-primary btn-xs'  onclick='EditViewById()'></i>物品清单</a>\"\r\n                        //     return html;\r\n                        //     // formatter: actionFormatter\r\n                        // }\r\n                    }],\r\n                \"language\": {\r\n                    \"sProcessing\": \"处理中...\",\r\n                    \"sLengthMenu\": \"显示 _MENU_ 项结果\",\r\n                    \"sZeroRecords\": \"没有匹配结果\",\r\n                    \"sInfo\": \"显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项\",\r\n                    \"sInfoEmpty\": \"显示第 0 至 0 项结果，共 0 项\",\r\n                    \"sInfoFiltered\": \"(由 _MAX_ 项结果过滤)\",\r\n                    \"sInfoPostFix\": \"\",\r\n                    \"sSearch\": \"搜索:\",\r\n                    \"sUrl\": \"\",\r\n                    \"sEmptyTable\": \"表中数据为空\",\r\n                    \"sLoadingRecords\": \"载入中...\",\r\n                    \"sInfoThousands\": \",\",\r\n                    \"oPaginate\": {\r\n                        \"sFirst\": \"首页\",\r\n                        \"sPrevious\": \"上页\",\r\n                        \"sNext\": \"下页\",\r\n                        \"sLast\": \"末页\"\r\n                    },\r\n                    \"oAria\": {\r\n                        \"sSortAscending\": \": 以升序排列此列\",\r\n                        \"sSortDescending\": \": 以降序排列此列\"\r\n                    }\r\n                }\r\n            });\r\n\r\n            var temp_list_data;\r\n\r\n            // 点击 物品清单\r\n            $(\"table tbody\").on(\"click\",\".list-btn\",function (){\r\n                // TODO: 待办 - 进入物品清单弹窗，刷新表单\r\n                //$('#listTable').dataTable().api().draw();\r\n\r\n                var tds=$(this).parents(\"tr\").children();\r\n                var temp_order_id = tds[1].innerText;\r\n                //console.log(\"temp_order_id\"+temp_order_id);\r\n                $.ajax({\r\n                    async: false,\r\n                    data: {order_id: temp_order_id},\r\n                    type: \"post\",\r\n                    url : \"purchase/initListTable\",\r\n                    success : function(data) {\r\n                        //console.log(\"--flag-initListTable-\");\r\n                        temp_list_data=data.data;\r\n                    }\r\n                });\r\n                temp_list_data = json2Array(temp_list_data, true)\r\n\r\n                // console.log(\"物品清单数据样例=\\n\"+dataSets);\r\n                // console.log(\"物品清单数据=\\n\"+temp_list_data);\r\n                // var len, i;\r\n                // for(i=0, len=temp_list_data.length; i<len; i++) {\r\n                //     dataSets.push(temp_list_data[i]);\r\n                // }\r\n                // console.log(dataSets);\r\n                // 更新表格数据\r\n                $('#listTable').dataTable().api().clear();\r\n                $('#listTable').dataTable().api().rows.add(temp_list_data);\r\n                $('#listTable').dataTable().api().draw();\r\n\r\n                var arr = tds[5].innerText;\r\n                console.log(arr);\r\n                if(arr==='已提交'||arr==='审核通过'){\r\n                    $('.list-edit-btn').attr('disabled',true);\r\n                    $('.list-delete').attr('disabled',true);\r\n                    $('.list-top-btn').attr('disabled',true);\r\n                }\r\n                if(arr==='未提交'||arr==='审核未通过'){\r\n                    $('.list-edit-btn').attr('disabled',false);\r\n                    $('.list-delete').attr('disabled',false);\r\n                    $('.list-top-btn').attr('disabled',false);\r\n                }\r\n\r\n                $('#updateModal').modal('show');\r\n            })\r\n\r\n            var listtable = $('#listTable').DataTable({\r\n                retrieve: true,\r\n                data:dataSets,\r\n                //ajax: \"json/PurchaseListData.txt\",\r\n                columns:[\r\n                    {\r\n                        'field': \"name\",\r\n                        'title': '物品名称',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"specification\",\r\n                        'title': '规格',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"quantity\",\r\n                        'title': '数量',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"unit\",\r\n                        'title': '包装单位',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"classification\",\r\n                        'title': '分类',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"price\",\r\n                        'title': '单价',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"expiration_time\",\r\n                        'title': '过期时间',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"upper_limit\",\r\n                        'title': '警戒上限',\r\n                        // width:90,\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"lower_limit\",\r\n                        'title': '警戒下限',\r\n                        // width:90,\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        'field': \"notes\",\r\n                        'title': '备注',\r\n                        'defaultContent' : \"\",\r\n                        'sClass': 'text-center'\r\n                    }, {\r\n                        field: \"operate\",\r\n                        sTitle: '操作',\r\n                        sDefaultContent : \"<button class='list-edit-btn btn btn-primary btn-xs' type='button'>编辑</button>\" +\r\n                            \"<button class='list-delete btn btn-default btn-xs' style='margin-left: 10px'>删除</button>\",\r\n                        sClass: 'text-center',\r\n                        // width:100,\r\n                        \"data\" : null,\r\n                        // \"render\" : function(data, type,row) {\r\n                        //   var html = \"<a href='javascript:void(0);'  class='edit-btn btn btn-primary btn-xs' type='button'>修改</a>\"\r\n                        //   html += \"<a href='javascript:void(0);'  class='delete btn btn-default btn-xs'>删除</a>\"\r\n                        //   return html;\r\n                        //   // formatter: actionFormatter\r\n                        // }\r\n                    }],\r\n                \"language\": {\r\n                    \"sProcessing\": \"处理中...\",\r\n                    \"sLengthMenu\": \"显示 _MENU_ 项结果\",\r\n                    \"sZeroRecords\": \"没有匹配结果\",\r\n                    \"sInfo\": \"显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项\",\r\n                    \"sInfoEmpty\": \"显示第 0 至 0 项结果，共 0 项\",\r\n                    \"sInfoFiltered\": \"(由 _MAX_ 项结果过滤)\",\r\n                    \"sInfoPostFix\": \"\",\r\n                    \"sSearch\": \"搜索:\",\r\n                    \"sUrl\": \"\",\r\n                    \"sEmptyTable\": \"表中数据为空\",\r\n                    \"sLoadingRecords\": \"载入中...\",\r\n                    \"sInfoThousands\": \",\",\r\n                    \"oPaginate\": {\r\n                        \"sFirst\": \"首页\",\r\n                        \"sPrevious\": \"上页\",\r\n                        \"sNext\": \"下页\",\r\n                        \"sLast\": \"末页\"\r\n                    },\r\n                    \"oAria\": {\r\n                        \"sSortAscending\": \": 以升序排列此列\",\r\n                        \"sSortDescending\": \": 以降序排列此列\"\r\n                    }\r\n                }\r\n            });\r\n\r\n\r\n\r\n            // 点击 提交 按钮\r\n            $(\"table tbody\").on(\"click\",\".submit-btn\",function (){\r\n                var tds=$(this).parents(\"tr\").children();\r\n                var arr = tds[5].innerText;\r\n                console.log(arr);\r\n                if(arr==='未提交'||arr==='审核未通过'){\r\n                    // 提交的代码\r\n                    if(confirm('确认提交申请？')){  //确认提交\r\n                        // 拼后端BeanUtils所需的map串\r\n                        var front_end_data = \"\";\r\n                        if (tds[0].innerText !== \"\") front_end_data += \"purchase_requisition_id=\"+tds[0].innerText+\"&\";\r\n                        if (tds[1].innerText !== \"\") front_end_data += \"purchase_order_id=\"+tds[1].innerText+\"&\";\r\n                        if (tds[3].innerText !== \"\") front_end_data += \"purpose=\"+tds[3].innerText+\"&\";\r\n                        if (tds[4].innerText !== \"\") front_end_data += \"requisition_date=\"+tds[4].innerText+\"&\";\r\n                        if (tds[5].innerText !== \"\") front_end_data += \"&state=\"+tds[5].innerText+\"&\";\r\n                        if (tds[6].innerText !== \"\") front_end_data += \"&approval_user_id=\"+tds[6].innerText+\"&\";\r\n                        if (tds[7].innerText !== \"\") front_end_data += \"&approval_opinions=\"+tds[7].innerText+\"&\";\r\n                        if (tds[8].innerText !== \"\") front_end_data += \"&approval_date=\"+tds[8].innerText+\"&\";\r\n                        // front_end_data = front_end_data.substring(0, front_end_data.length-1);  //删除最后一个字符\r\n\r\n                        $.get(\"user/findOne\", {}, function (data) {\r\n                            // 获取当前登陆的用户id\r\n                            front_end_data += \"requisition_user_id=\"+data.user_id;\r\n                            console.log(\"front_end_data=\"+front_end_data);\r\n                            // 把前端数据传给后端\r\n                            $.post(\"purchase/createOrUpdateItems\", front_end_data, function (data) {\r\n                                console.log(\"在接受后端数据之后\");\r\n                                if (data.flag) {\r\n                                    alert(\"提交成功\");\r\n                                    tds[5].innerText = '已提交';\r\n                                    // 禁用按钮：应该放入点击确认\r\n                                    $(this).attr('disabled',true);\r\n                                    tds.find('.edit-btn').attr('disabled',true);\r\n                                } else {\r\n                                    alert(\"提交失败\");\r\n                                }\r\n                            })\r\n                        });  // end of $.get(\"user/findOne\"...\r\n                    } // end of confirm(确认提交申请？)\r\n                    else {} //点击取消，无事发生\r\n                }\r\n            })\r\n\r\n            // 申请表修改\r\n            $(\"#table tbody\").on(\"click\",\".edit-btn\",function(){\r\n                var tds=$(this).parents(\"tr\").children();\r\n                $.each(tds, function(i,val){\r\n                    var jqob=$(val);\r\n                    if(i<=2||i>3 ){return true;}//跳过第1项 序号,按钮\r\n                    var txt=jqob.text();\r\n                    var put=$(\"<input type='text' style='width: 80px'>\");\r\n                    put.val(txt);\r\n                    jqob.html(put);\r\n                });\r\n                $(this).html(\"保存\");\r\n                $(this).toggleClass(\"edit-btn\");\r\n                $(this).toggleClass(\"save-btn\");\r\n            });\r\n\r\n            // 申请表修改保存\r\n            $(\"#table tbody\").on(\"click\",\".save-btn\",function(){\r\n                var row=table.row($(this).parents(\"tr\"));\r\n                var tds=$(this).parents(\"tr\").children();\r\n                $.each(tds, function(i,val){\r\n                    var jqob=$(val);\r\n                    //把input变为字符串\r\n                    //console.log(!jqob.has('button').length);\r\n                    if(!jqob.has('button').length){\r\n                        var txt=jqob.children(\"input\").val();\r\n                        //console.log(jqob.children(\"input\"));\r\n                        jqob.html(txt);\r\n                        table.cell(jqob).data(txt);//修改DataTables对象的数据\r\n                    }\r\n                });\r\n                $(this).html(\"编辑\");\r\n                $(this).toggleClass(\"edit-btn\");\r\n                $(this).toggleClass(\"save-btn\");\r\n            });\r\n\r\n            // 物品清单修改\r\n            $(\"#listTable tbody\").on(\"click\",\".list-edit-btn\",function(){\r\n                var tds=$(this).parents(\"tr\").children();\r\n                $.each(tds, function(i,val){\r\n                    var jqob=$(val);\r\n                    if(jqob.has('button').length ){return true;}//跳过第1项 序号,按钮\r\n                    var txt=jqob.text();\r\n                    var put=$(\"<input type='text' style='width: 80px'>\");\r\n                    put.val(txt);\r\n                    jqob.html(put);\r\n                });\r\n                $(this).html(\"保存\");\r\n                $(this).toggleClass(\"list-edit-btn\");\r\n                $(this).toggleClass(\"list-save-btn\");\r\n            });\r\n\r\n            //  物品清单修改保存\r\n            $(\"#listTable tbody\").on(\"click\",\".list-save-btn\",function(){\r\n                var row=listtable.row($(this).parents(\"tr\"));\r\n                var tds=$(this).parents(\"tr\").children();\r\n                $.each(tds, function(i,val){\r\n                    console.log(\"|\"+tds[i].innerText+\"|\");\r\n                    var jqob=$(val);\r\n                    //把input变为字符串\r\n                    if(!jqob.has('button').length){\r\n                        var txt=jqob.children(\"input\").val();\r\n                        jqob.html(txt);\r\n                        listtable.cell(jqob).data(txt);//修改DataTables对象的数据\r\n                    }\r\n                });\r\n\r\n                var front_end_data = \"\";\r\n                if (tds[0].innerText !== \"\") front_end_data += \"name=\"+tds[0].innerText+\"&\";\r\n                if (tds[1].innerText !== \"\") front_end_data += \"specification=\"+tds[1].innerText+\"&\";\r\n                if (tds[2].innerText !== \"\") front_end_data += \"quantity=\"+tds[2].innerText+\"&\";\r\n                if (tds[3].innerText !== \"\") front_end_data += \"unit=\"+tds[3].innerText+\"&\";\r\n                if (tds[4].innerText !== \"\") front_end_data += \"classification=\"+tds[4].innerText+\"&\";\r\n                if (tds[5].innerText !== \"\") front_end_data += \"price=\"+tds[5].innerText+\"&\";\r\n                if (tds[6].innerText !== \"\") front_end_data += \"expiration_time=\"+tds[6].innerText+\"&\";\r\n                if (tds[7].innerText !== \"\") front_end_data += \"lower_limit=\"+tds[7].innerText+\"&\";\r\n                if (tds[8].innerText !== \"\") front_end_data += \"upper_limit=\"+tds[8].innerText+\"&\";\r\n                if (tds[9].innerText !== \"\") front_end_data += \"notes=\"+tds[9].innerText+\"&\";\r\n                front_end_data = front_end_data.substring(0, front_end_data.length-1);  //删除最后一个字符\r\n\r\n                $.get(\"user/findOne\", {}, function (data) {\r\n                    // 获取当前登陆的用户id\r\n                    front_end_data += \"requisition_user_id=\"+data.user_id;\r\n                    console.log(\"front_end_data=\"+front_end_data);\r\n                    // 把前端数据传给后端\r\n                    $.post(\"purchase/createOrUpdateItems\", front_end_data, function (data) {\r\n                        console.log(\"在接受后端数据之后\");\r\n                        if (data.flag) {\r\n                            alert(\"提交成功\");\r\n                            tds[5].innerText = '已提交';\r\n                            // 禁用按钮：应该放入点击确认\r\n                            $(this).attr('disabled',true);\r\n                            tds.find('.edit-btn').attr('disabled',true);\r\n                        } else {\r\n                            alert(\"提交失败\");\r\n                        }\r\n                    })\r\n                });  // end of $.get(\"user/findOne\"...\r\n\r\n                $(this).html(\"编辑\");\r\n                $(this).toggleClass(\"list-edit-btn\");\r\n                $(this).toggleClass(\"list-save-btn\");\r\n            });\r\n\r\n            //批量点击编辑按钮\r\n            $(\"#batch-edit-btn\").click(function(){\r\n                $(\".edit-btn\").click();\r\n            });\r\n            $(\"#batch-save-btn\").click(function(){\r\n                $(\".save-btn\").click();\r\n            });\r\n\r\n            //物品清单批量点击编辑按钮\r\n            $(\"#list-batch-edit-btn\").click(function(){\r\n                $(\".list-edit-btn\").click();\r\n            });\r\n            $(\"#list-batch-save-btn\").click(function(){\r\n                $(\".list-save-btn\").click();\r\n            });\r\n\r\n            // 申请单点击删除按钮，触发删除行脚本\r\n            $(document).on(\"click\",'.delete',function(){\r\n                $('#table').dataTable().fnDeleteRow($(this).closest('tr')[0]);\r\n            });\r\n            // 物品清单点击删除按钮，触发删除行脚本\r\n            $(document).on(\"click\",'.list-delete',function(){\r\n                $('#listTable').dataTable().fnDeleteRow($(this).closest('tr')[0]);\r\n            });\r\n\r\n\r\n            // 根据 申请当前状态的数值，设置前端表格的文字，以及对应行按钮是否可用\r\n            $(\"#table tbody tr\").each(function () {\r\n                var a = $(this).children();//获取每一行\r\n                var arr = a[5].innerText;//取得第六列的值\r\n                if(arr==='0'){\r\n                    a[5].innerText = '未提交';\r\n                }else if(arr==='1'){\r\n                    a[5].innerText = '已提交';\r\n                    a.find('.submit-btn').attr('disabled',true);\r\n                    a.find('.edit-btn').attr('disabled',true);\r\n                }else if(arr==='2'){\r\n                    a[5].innerText = '审核通过';\r\n                    a.find('.submit-btn').attr('disabled',true);\r\n                    a.find('.edit-btn').attr('disabled',true);\r\n                }else if(arr==='3'){\r\n                    a[5].innerText = '审核未通过';\r\n                }\r\n            })\r\n        });\r\n\r\n    } );\r\n\r\n\r\n\r\n</script>\r\n\r\n<script>\r\n    function fnClickAddRow() {\r\n        $('#table').dataTable().fnAddData([\r\n            \"\", \"\", \"\", \"\",\r\n            \"\", \"未提交\", \"\", \"\", \"\",\r\n            \"\", \"\"]);}\r\n    function listfnClickAddRow() {\r\n        $('#listTable').dataTable().fnAddData([\r\n            \"\", \"\", \"\", \"\",\r\n            \"\", \"\", \"\", \"\", \"\",\r\n            \"\", \"\"]);}\r\n</script>\r\n\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/form_purchase.html b/src/main/webapp/form_purchase.html
--- a/src/main/webapp/form_purchase.html	(revision a610f63d315be699b1ca789b976862a9aec61980)
+++ b/src/main/webapp/form_purchase.html	(date 1686207642607)
@@ -469,15 +469,43 @@
                     // 提交的代码
                     if(confirm('确认提交申请？')){  //确认提交
                         // 拼后端BeanUtils所需的map串
+
+                        // 时间格式纠正
+                        Date.prototype.toLocaleString = function() {
+                            function addZero(num) {
+                                return num < 10 ? "0" + num : num;
+                            }
+                            // 按自定义拼接格式返回
+                            return this.getFullYear() + "/" + addZero(this.getMonth() + 1) + "/" + addZero(this.getDate()) + " " +
+                                addZero((this.getHours()+24-8)%24) + ":" + addZero(this.getMinutes()) + ":" + addZero(this.getSeconds());
+                        };
+                        var requisition_dateTime = "", approval_date = "";
+                        if (tds[4].innerText !== "")
+                            requisition_dateTime = (new Date(eval(tds[4].innerText))).toLocaleString();
+                        if (tds[8].innerText !== "")
+                            approval_date = (new Date(eval(tds[8].innerText))).toLocaleString();
+
+                        // 状态改回数值
+                        var shenqing_state = '';
+                        if(arr==='未提交'){
+                            shenqing_state = '0';
+                        }else if(arr==='已提交'){
+                            shenqing_state = '1';
+                        }else if(arr==='审核通过'){
+                            shenqing_state = '2';
+                        }else if(arr==='审核未通过'){
+                            shenqing_state = '3';
+                        }
+
                         var front_end_data = "";
                         if (tds[0].innerText !== "") front_end_data += "purchase_requisition_id="+tds[0].innerText+"&";
                         if (tds[1].innerText !== "") front_end_data += "purchase_order_id="+tds[1].innerText+"&";
                         if (tds[3].innerText !== "") front_end_data += "purpose="+tds[3].innerText+"&";
-                        if (tds[4].innerText !== "") front_end_data += "requisition_date="+tds[4].innerText+"&";
-                        if (tds[5].innerText !== "") front_end_data += "&state="+tds[5].innerText+"&";
+                        if (tds[4].innerText !== "") front_end_data += "requisition_date="+requisition_dateTime+"&";
+                        if (tds[5].innerText !== "") front_end_data += "&state="+shenqing_state+"&";
                         if (tds[6].innerText !== "") front_end_data += "&approval_user_id="+tds[6].innerText+"&";
                         if (tds[7].innerText !== "") front_end_data += "&approval_opinions="+tds[7].innerText+"&";
-                        if (tds[8].innerText !== "") front_end_data += "&approval_date="+tds[8].innerText+"&";
+                        if (tds[8].innerText !== "") front_end_data += "&approval_date="+approval_date+"&";
                         // front_end_data = front_end_data.substring(0, front_end_data.length-1);  //删除最后一个字符
 
                         $.get("user/findOne", {}, function (data) {
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"ArtifactsWorkspaceSettings\">\r\n    <artifacts-to-build>\r\n      <artifact name=\"travel:war\" />\r\n    </artifacts-to-build>\r\n  </component>\r\n  <component name=\"AutoImportSettings\">\r\n    <option name=\"autoReloadType\" value=\"SELECTIVE\" />\r\n  </component>\r\n  <component name=\"ChangeListManager\">\r\n    <list default=\"true\" id=\"4a6ee96f-f4a8-4e70-87f3-f76f4265a3ec\" name=\"Default Changelist\" comment=\"修正了DateTime时区的问题，前端可以获取当前用户登录信息\">\r\n      <change afterPath=\"$PROJECT_DIR$/src/main/java/dao/ex_dao.java\" afterDir=\"false\" />\r\n      <change afterPath=\"$PROJECT_DIR$/src/main/java/dao/impl/ex_dao_impl.java\" afterDir=\"false\" />\r\n      <change afterPath=\"$PROJECT_DIR$/src/main/java/service/ex_service.java\" afterDir=\"false\" />\r\n      <change afterPath=\"$PROJECT_DIR$/src/main/java/service/impl/ex_service_impl.java\" afterDir=\"false\" />\r\n      <change afterPath=\"$PROJECT_DIR$/src/main/java/web/servlet/ExServlet.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/.idea/workspace.xml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/.idea/workspace.xml\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/ChemicalLabItemMS.iml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/ChemicalLabItemMS.iml\" afterDir=\"false\" />\r\n    </list>\r\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\r\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\r\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\r\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\r\n  </component>\r\n  <component name=\"FileTemplateManagerImpl\">\r\n    <option name=\"RECENT_TEMPLATES\">\r\n      <list>\r\n        <option value=\"Interface\" />\r\n        <option value=\"Class\" />\r\n      </list>\r\n    </option>\r\n  </component>\r\n  <component name=\"Git.Settings\">\r\n    <option name=\"RECENT_BRANCH_BY_REPOSITORY\">\r\n      <map>\r\n        <entry key=\"$PROJECT_DIR$\" value=\"master\" />\r\n      </map>\r\n    </option>\r\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\r\n  </component>\r\n  <component name=\"GitSEFilterConfiguration\">\r\n    <file-type-list>\r\n      <filtered-out-file-type name=\"LOCAL_BRANCH\" />\r\n      <filtered-out-file-type name=\"REMOTE_BRANCH\" />\r\n      <filtered-out-file-type name=\"TAG\" />\r\n      <filtered-out-file-type name=\"COMMIT_BY_MESSAGE\" />\r\n    </file-type-list>\r\n  </component>\r\n  <component name=\"LogFilters\">\r\n    <option name=\"FILTER_ERRORS\" value=\"false\" />\r\n    <option name=\"FILTER_WARNINGS\" value=\"false\" />\r\n    <option name=\"FILTER_INFO\" value=\"true\" />\r\n    <option name=\"FILTER_DEBUG\" value=\"true\" />\r\n    <option name=\"CUSTOM_FILTER\" />\r\n  </component>\r\n  <component name=\"MarkdownSettingsMigration\">\r\n    <option name=\"stateVersion\" value=\"1\" />\r\n  </component>\r\n  <component name=\"ProjectId\" id=\"2Avt6bIjEb9LPH0DVMOFNxUmr9z\" />\r\n  <component name=\"ProjectLevelVcsManager\" settingsEditedManually=\"true\">\r\n    <ConfirmationsSetting value=\"2\" id=\"Add\" />\r\n  </component>\r\n  <component name=\"ProjectViewState\">\r\n    <option name=\"showLibraryContents\" value=\"true\" />\r\n  </component>\r\n  <component name=\"PropertiesComponent\">\r\n    <property name=\"ASKED_ADD_EXTERNAL_FILES\" value=\"true\" />\r\n    <property name=\"RunOnceActivity.OpenProjectViewOnStart\" value=\"true\" />\r\n    <property name=\"RunOnceActivity.ShowReadmeOnStart\" value=\"true\" />\r\n    <property name=\"SHARE_PROJECT_CONFIGURATION_FILES\" value=\"true\" />\r\n    <property name=\"WebServerToolWindowFactoryState\" value=\"false\" />\r\n    <property name=\"aspect.path.notification.shown\" value=\"true\" />\r\n    <property name=\"last_opened_file_path\" value=\"$PROJECT_DIR$\" />\r\n    <property name=\"node.js.detected.package.eslint\" value=\"true\" />\r\n    <property name=\"node.js.path.for.package.eslint\" value=\"project\" />\r\n    <property name=\"node.js.path.for.package.tslint\" value=\"project\" />\r\n    <property name=\"node.js.selected.package.eslint\" value=\"(autodetect)\" />\r\n    <property name=\"node.js.selected.package.tslint\" value=\"(autodetect)\" />\r\n    <property name=\"nodejs_package_manager_path\" value=\"npm\" />\r\n    <property name=\"project.structure.last.edited\" value=\"Modules\" />\r\n    <property name=\"project.structure.proportion\" value=\"0.17\" />\r\n    <property name=\"project.structure.side.proportion\" value=\"0.26412776\" />\r\n    <property name=\"settings.editor.selected.configurable\" value=\"MavenSettings\" />\r\n  </component>\r\n  <component name=\"RecentsManager\">\r\n    <key name=\"CopyFile.RECENT_KEYS\">\r\n      <recent name=\"D:\\develop\\Java\\ChemicalLabItemMS\\src\\main\\webapp\" />\r\n      <recent name=\"D:\\develop\\Java\\ChemicalLabItemMS\\src\\main\\webapp\\front-end-res-lib\" />\r\n      <recent name=\"D:\\develop\\Java\\ChemicalLabItemMS\\src\\main\\java\\service\\temp_service\" />\r\n    </key>\r\n    <key name=\"MoveFile.RECENT_KEYS\">\r\n      <recent name=\"D:\\develop\\Java\\ChemicalLabItemMS\\src\\main\\webapp\\html_temp\" />\r\n    </key>\r\n    <key name=\"MoveClassesOrPackagesDialog.RECENTS_KEY\">\r\n      <recent name=\"\" />\r\n    </key>\r\n    <key name=\"CopyClassDialog.RECENTS_KEY\">\r\n      <recent name=\"web\" />\r\n    </key>\r\n  </component>\r\n  <component name=\"RunManager\" selected=\"Maven.ChemicalLabItemMS\">\r\n    <configuration name=\"ChemicalLabItemMS\" type=\"MavenRunConfiguration\" factoryName=\"Maven\">\r\n      <MavenSettings>\r\n        <option name=\"myGeneralSettings\" />\r\n        <option name=\"myRunnerSettings\" />\r\n        <option name=\"myRunnerParameters\">\r\n          <MavenRunnerParameters>\r\n            <option name=\"profiles\">\r\n              <set />\r\n            </option>\r\n            <option name=\"goals\">\r\n              <list>\r\n                <option value=\"tomcat7:run\" />\r\n              </list>\r\n            </option>\r\n            <option name=\"pomFileName\" />\r\n            <option name=\"profilesMap\">\r\n              <map />\r\n            </option>\r\n            <option name=\"resolveToWorkspace\" value=\"false\" />\r\n            <option name=\"workingDirPath\" value=\"$PROJECT_DIR$\" />\r\n          </MavenRunnerParameters>\r\n        </option>\r\n      </MavenSettings>\r\n      <method v=\"2\" />\r\n    </configuration>\r\n    <configuration name=\"Tomcat 8.5.24\" type=\"#com.intellij.j2ee.web.tomcat.TomcatRunConfigurationFactory\" factoryName=\"Local\" APPLICATION_SERVER_NAME=\"Tomcat 8.5.24\" ALTERNATIVE_JRE_ENABLED=\"false\" nameIsGenerated=\"true\">\r\n      <option name=\"UPDATING_POLICY\" value=\"restart-server\" />\r\n      <deployment>\r\n        <artifact name=\"travel:war\">\r\n          <settings>\r\n            <option name=\"CONTEXT_PATH\" value=\"/travel_war\" />\r\n          </settings>\r\n        </artifact>\r\n        <artifact name=\"ChemicalLabItemMS:war\">\r\n          <settings>\r\n            <option name=\"CONTEXT_PATH\" value=\"/ChemicalLabItemMS_war\" />\r\n          </settings>\r\n        </artifact>\r\n      </deployment>\r\n      <server-settings>\r\n        <option name=\"BASE_DIRECTORY_NAME\" value=\"0049ada1-20ae-4acc-ba0a-1e64ffc4502d\" />\r\n      </server-settings>\r\n      <predefined_log_file enabled=\"true\" id=\"Tomcat\" />\r\n      <predefined_log_file enabled=\"true\" id=\"Tomcat Catalina\" />\r\n      <predefined_log_file id=\"Tomcat Manager\" />\r\n      <predefined_log_file id=\"Tomcat Host Manager\" />\r\n      <predefined_log_file id=\"Tomcat Localhost Access\" />\r\n      <RunnerSettings RunnerId=\"Debug\">\r\n        <option name=\"DEBUG_PORT\" value=\"1237\" />\r\n      </RunnerSettings>\r\n      <ConfigurationWrapper VM_VAR=\"JAVA_OPTS\" RunnerId=\"Cover\">\r\n        <option name=\"USE_ENV_VARIABLES\" value=\"true\" />\r\n        <STARTUP>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </STARTUP>\r\n        <SHUTDOWN>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </SHUTDOWN>\r\n      </ConfigurationWrapper>\r\n      <ConfigurationWrapper VM_VAR=\"JAVA_OPTS\" RunnerId=\"Debug\">\r\n        <option name=\"USE_ENV_VARIABLES\" value=\"true\" />\r\n        <STARTUP>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </STARTUP>\r\n        <SHUTDOWN>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </SHUTDOWN>\r\n      </ConfigurationWrapper>\r\n      <ConfigurationWrapper VM_VAR=\"JAVA_OPTS\" RunnerId=\"Profile\">\r\n        <option name=\"USE_ENV_VARIABLES\" value=\"true\" />\r\n        <STARTUP>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </STARTUP>\r\n        <SHUTDOWN>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </SHUTDOWN>\r\n      </ConfigurationWrapper>\r\n      <ConfigurationWrapper VM_VAR=\"JAVA_OPTS\" RunnerId=\"Run\">\r\n        <option name=\"USE_ENV_VARIABLES\" value=\"true\" />\r\n        <STARTUP>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </STARTUP>\r\n        <SHUTDOWN>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </SHUTDOWN>\r\n      </ConfigurationWrapper>\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n        <option name=\"BuildArtifacts\" enabled=\"true\">\r\n          <artifact name=\"ChemicalLabItemMS:war\" />\r\n        </option>\r\n      </method>\r\n    </configuration>\r\n    <list>\r\n      <item itemvalue=\"Maven.ChemicalLabItemMS\" />\r\n      <item itemvalue=\"Tomcat Server.Tomcat 8.5.24\" />\r\n    </list>\r\n  </component>\r\n  <component name=\"SpellCheckerSettings\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" DefaultDictionary=\"application-level\" UseSingleDictionary=\"true\" transferred=\"true\" />\r\n  <component name=\"SvnConfiguration\">\r\n    <configuration />\r\n  </component>\r\n  <component name=\"TaskManager\">\r\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\r\n      <changelist id=\"4a6ee96f-f4a8-4e70-87f3-f76f4265a3ec\" name=\"Default Changelist\" comment=\"\" />\r\n      <created>1655901715645</created>\r\n      <option name=\"number\" value=\"Default\" />\r\n      <option name=\"presentableId\" value=\"Default\" />\r\n      <updated>1655901715645</updated>\r\n      <workItem from=\"1655901717854\" duration=\"450000\" />\r\n      <workItem from=\"1685427151825\" duration=\"1535000\" />\r\n      <workItem from=\"1685428706026\" duration=\"124000\" />\r\n      <workItem from=\"1685428833294\" duration=\"826000\" />\r\n      <workItem from=\"1685520782760\" duration=\"706000\" />\r\n      <workItem from=\"1685537381059\" duration=\"1334000\" />\r\n      <workItem from=\"1685540296469\" duration=\"811000\" />\r\n      <workItem from=\"1685599640376\" duration=\"132000\" />\r\n      <workItem from=\"1685599807762\" duration=\"1261000\" />\r\n      <workItem from=\"1685603422754\" duration=\"49000\" />\r\n      <workItem from=\"1685603474267\" duration=\"10000\" />\r\n      <workItem from=\"1685603485940\" duration=\"6000\" />\r\n      <workItem from=\"1685603502462\" duration=\"2399000\" />\r\n      <workItem from=\"1685674025238\" duration=\"1608000\" />\r\n      <workItem from=\"1685771307743\" duration=\"402000\" />\r\n      <workItem from=\"1685771714405\" duration=\"5544000\" />\r\n      <workItem from=\"1685777299983\" duration=\"306000\" />\r\n      <workItem from=\"1685897456684\" duration=\"1052000\" />\r\n      <workItem from=\"1685924081606\" duration=\"921000\" />\r\n      <workItem from=\"1685965736717\" duration=\"8365000\" />\r\n      <workItem from=\"1686020823650\" duration=\"2271000\" />\r\n      <workItem from=\"1686097290341\" duration=\"1965000\" />\r\n      <workItem from=\"1686103535919\" duration=\"1125000\" />\r\n      <workItem from=\"1686122288404\" duration=\"2228000\" />\r\n      <workItem from=\"1686124548099\" duration=\"13105000\" />\r\n      <workItem from=\"1686186044285\" duration=\"1925000\" />\r\n    </task>\r\n    <task id=\"LOCAL-00001\" summary=\"添加GoodsService及其实现，实体类Date-&gt;String\">\r\n      <created>1655902015448</created>\r\n      <option name=\"number\" value=\"00001\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00001\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1655902015448</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00002\" summary=\"更新了实体类的注释\">\r\n      <created>1685776134712</created>\r\n      <option name=\"number\" value=\"00002\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00002\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1685776134712</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00003\" summary=\"更新了实体类的注释\">\r\n      <created>1685777451475</created>\r\n      <option name=\"number\" value=\"00003\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00003\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1685777451475</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00004\" summary=\"更新了领用&amp;借用申请表的校验\">\r\n      <created>1685955280415</created>\r\n      <option name=\"number\" value=\"00004\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00004\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1685955280415</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00005\" summary=\"更新采购、领用dao层功能\">\r\n      <created>1686015910191</created>\r\n      <option name=\"number\" value=\"00005\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00005\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1686015910191</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00006\" summary=\"更新采购入库功能\">\r\n      <created>1686040539807</created>\r\n      <option name=\"number\" value=\"00006\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00006\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1686040539807</updated>\r\n    </task>\r\n    <option name=\"localTasksCounter\" value=\"7\" />\r\n    <servers />\r\n  </component>\r\n  <component name=\"TypeScriptGeneratedFilesManager\">\r\n    <option name=\"version\" value=\"3\" />\r\n  </component>\r\n  <component name=\"Vcs.Log.Tabs.Properties\">\r\n    <option name=\"TAB_STATES\">\r\n      <map>\r\n        <entry key=\"MAIN\">\r\n          <value>\r\n            <State />\r\n          </value>\r\n        </entry>\r\n      </map>\r\n    </option>\r\n    <option name=\"oldMeFiltersMigrated\" value=\"true\" />\r\n  </component>\r\n  <component name=\"VcsManagerConfiguration\">\r\n    <option name=\"ADD_EXTERNAL_FILES_SILENTLY\" value=\"true\" />\r\n    <MESSAGE value=\"添加GoodsService及其实现，实体类Date-&gt;String\" />\r\n    <MESSAGE value=\"更新了实体类的注释\" />\r\n    <MESSAGE value=\"更新了领用&amp;借用申请表的校验\" />\r\n    <MESSAGE value=\"更新采购、领用dao层功能\" />\r\n    <MESSAGE value=\"更新废弃物后端\" />\r\n    <MESSAGE value=\"更新 借用入库 功能\" />\r\n    <MESSAGE value=\"完善了前端申请表、入库表的页面，实现采购申请的数据部分插入\" />\r\n    <option name=\"LAST_COMMIT_MESSAGE\" value=\"完善了前端申请表、入库表的页面，实现采购申请的数据部分插入\" />\r\n  </component>\r\n  <component name=\"XSLT-Support.FileAssociations.UIState\">\r\n    <expand />\r\n    <select />\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	(revision a610f63d315be699b1ca789b976862a9aec61980)
+++ b/.idea/workspace.xml	(date 1686208067354)
@@ -9,14 +9,12 @@
     <option name="autoReloadType" value="SELECTIVE" />
   </component>
   <component name="ChangeListManager">
-    <list default="true" id="4a6ee96f-f4a8-4e70-87f3-f76f4265a3ec" name="Default Changelist" comment="修正了DateTime时区的问题，前端可以获取当前用户登录信息">
-      <change afterPath="$PROJECT_DIR$/src/main/java/dao/ex_dao.java" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/src/main/java/dao/impl/ex_dao_impl.java" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/src/main/java/service/ex_service.java" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/src/main/java/service/impl/ex_service_impl.java" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/src/main/java/web/servlet/ExServlet.java" afterDir="false" />
+    <list default="true" id="4a6ee96f-f4a8-4e70-87f3-f76f4265a3ec" name="Default Changelist" comment="更新item的dao和service">
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/ChemicalLabItemMS.iml" beforeDir="false" afterPath="$PROJECT_DIR$/ChemicalLabItemMS.iml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/java/web/servlet/PurchaseServlet.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/web/servlet/PurchaseServlet.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/webapp/form_purchase.html" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/webapp/form_purchase.html" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/webapp/json/PurchaseData.txt" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/webapp/json/PurchaseData.txt" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/webapp/json/PurchaseListData.txt" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/webapp/json/PurchaseListData.txt" afterDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
     <option name="HIGHLIGHT_CONFLICTS" value="true" />
@@ -100,6 +98,17 @@
     </key>
   </component>
   <component name="RunManager" selected="Maven.ChemicalLabItemMS">
+    <configuration default="true" type="ArquillianJUnit" factoryName="" nameIsGenerated="true">
+      <option name="arquillianRunConfiguration">
+        <value>
+          <option name="containerStateName" value="" />
+        </value>
+      </option>
+      <option name="TEST_OBJECT" value="class" />
+      <method v="2">
+        <option name="Make" enabled="true" />
+      </method>
+    </configuration>
     <configuration name="ChemicalLabItemMS" type="MavenRunConfiguration" factoryName="Maven">
       <MavenSettings>
         <option name="myGeneralSettings" />
@@ -302,7 +311,14 @@
       <option name="project" value="LOCAL" />
       <updated>1686040539807</updated>
     </task>
-    <option name="localTasksCounter" value="7" />
+    <task id="LOCAL-00007" summary="更新item的dao和service">
+      <created>1686206117480</created>
+      <option name="number" value="00007" />
+      <option name="presentableId" value="LOCAL-00007" />
+      <option name="project" value="LOCAL" />
+      <updated>1686206117480</updated>
+    </task>
+    <option name="localTasksCounter" value="8" />
     <servers />
   </component>
   <component name="TypeScriptGeneratedFilesManager">
@@ -329,7 +345,8 @@
     <MESSAGE value="更新废弃物后端" />
     <MESSAGE value="更新 借用入库 功能" />
     <MESSAGE value="完善了前端申请表、入库表的页面，实现采购申请的数据部分插入" />
-    <option name="LAST_COMMIT_MESSAGE" value="完善了前端申请表、入库表的页面，实现采购申请的数据部分插入" />
+    <MESSAGE value="更新item的dao和service" />
+    <option name="LAST_COMMIT_MESSAGE" value="更新item的dao和service" />
   </component>
   <component name="XSLT-Support.FileAssociations.UIState">
     <expand />
